<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - PostgreSQL 13devel - src/bin/psql/tab-complete.c</title>
  <link rel="stylesheet" type="text/css" href="../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../index.html">top level</a> - <a href="index.html">src/bin/psql</a> - tab-complete.c<span style="font-size: 80%;"> (source / <a href="tab-complete.c.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">PostgreSQL 13devel</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">1646</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2019-11-27 09:34:56</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">26</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*</a>
<span class="lineNum">       2 </span>            :  * psql - the PostgreSQL interactive terminal
<span class="lineNum">       3 </span>            :  *
<span class="lineNum">       4 </span>            :  * Copyright (c) 2000-2019, PostgreSQL Global Development Group
<span class="lineNum">       5 </span>            :  *
<span class="lineNum">       6 </span>            :  * src/bin/psql/tab-complete.c
<span class="lineNum">       7 </span>            :  */
<span class="lineNum">       8 </span>            : 
<span class="lineNum">       9 </span>            : /*----------------------------------------------------------------------
<span class="lineNum">      10 </span>            :  * This file implements a somewhat more sophisticated readline &quot;TAB
<span class="lineNum">      11 </span>            :  * completion&quot; in psql. It is not intended to be AI, to replace
<span class="lineNum">      12 </span>            :  * learning SQL, or to relieve you from thinking about what you're
<span class="lineNum">      13 </span>            :  * doing. Also it does not always give you all the syntactically legal
<span class="lineNum">      14 </span>            :  * completions, only those that are the most common or the ones that
<span class="lineNum">      15 </span>            :  * the programmer felt most like implementing.
<span class="lineNum">      16 </span>            :  *
<span class="lineNum">      17 </span>            :  * CAVEAT: Tab completion causes queries to be sent to the backend.
<span class="lineNum">      18 </span>            :  * The number of tuples returned gets limited, in most default
<span class="lineNum">      19 </span>            :  * installations to 1000, but if you still don't like this prospect,
<span class="lineNum">      20 </span>            :  * you can turn off tab completion in your ~/.inputrc (or else
<span class="lineNum">      21 </span>            :  * ${INPUTRC}) file so:
<span class="lineNum">      22 </span>            :  *
<span class="lineNum">      23 </span>            :  *   $if psql
<span class="lineNum">      24 </span>            :  *   set disable-completion on
<span class="lineNum">      25 </span>            :  *   $endif
<span class="lineNum">      26 </span>            :  *
<span class="lineNum">      27 </span>            :  * See `man 3 readline' or `info readline' for the full details.
<span class="lineNum">      28 </span>            :  *
<span class="lineNum">      29 </span>            :  * BUGS:
<span class="lineNum">      30 </span>            :  * - Quotes, parentheses, and other funny characters are not handled
<span class="lineNum">      31 </span>            :  *   all that gracefully.
<span class="lineNum">      32 </span>            :  *----------------------------------------------------------------------
<span class="lineNum">      33 </span>            :  */
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : #include &quot;postgres_fe.h&quot;
<span class="lineNum">      36 </span>            : #include &quot;tab-complete.h&quot;
<span class="lineNum">      37 </span>            : #include &quot;input.h&quot;
<span class="lineNum">      38 </span>            : 
<span class="lineNum">      39 </span>            : /* If we don't have this, we might as well forget about the whole thing: */
<span class="lineNum">      40 </span>            : #ifdef USE_READLINE
<span class="lineNum">      41 </span>            : 
<span class="lineNum">      42 </span>            : #include &lt;ctype.h&gt;
<span class="lineNum">      43 </span>            : 
<span class="lineNum">      44 </span>            : #include &quot;catalog/pg_am_d.h&quot;
<span class="lineNum">      45 </span>            : #include &quot;catalog/pg_class_d.h&quot;
<span class="lineNum">      46 </span>            : 
<span class="lineNum">      47 </span>            : #include &quot;libpq-fe.h&quot;
<span class="lineNum">      48 </span>            : #include &quot;pqexpbuffer.h&quot;
<span class="lineNum">      49 </span>            : #include &quot;common.h&quot;
<span class="lineNum">      50 </span>            : #include &quot;settings.h&quot;
<span class="lineNum">      51 </span>            : #include &quot;stringutils.h&quot;
<span class="lineNum">      52 </span>            : 
<span class="lineNum">      53 </span>            : #ifdef HAVE_RL_FILENAME_COMPLETION_FUNCTION
<span class="lineNum">      54 </span>            : #define filename_completion_function rl_filename_completion_function
<span class="lineNum">      55 </span>            : #else
<span class="lineNum">      56 </span>            : /* missing in some header files */
<span class="lineNum">      57 </span>            : extern char *filename_completion_function();
<span class="lineNum">      58 </span>            : #endif
<span class="lineNum">      59 </span>            : 
<span class="lineNum">      60 </span>            : #ifdef HAVE_RL_COMPLETION_MATCHES
<span class="lineNum">      61 </span>            : #define completion_matches rl_completion_matches
<span class="lineNum">      62 </span>            : #endif
<span class="lineNum">      63 </span>            : 
<span class="lineNum">      64 </span>            : /* word break characters */
<span class="lineNum">      65 </span>            : #define WORD_BREAKS     &quot;\t\n@$&gt;&lt;=;|&amp;{() &quot;
<span class="lineNum">      66 </span>            : 
<span class="lineNum">      67 </span>            : /*
<span class="lineNum">      68 </span>            :  * Since readline doesn't let us pass any state through to the tab completion
<span class="lineNum">      69 </span>            :  * callback, we have to use this global variable to let get_previous_words()
<span class="lineNum">      70 </span>            :  * get at the previous lines of the current command.  Ick.
<span class="lineNum">      71 </span>            :  */
<span class="lineNum">      72 </span>            : PQExpBuffer tab_completion_query_buf = NULL;
<span class="lineNum">      73 </span>            : 
<span class="lineNum">      74 </span>            : /*
<span class="lineNum">      75 </span>            :  * In some situations, the query to find out what names are available to
<span class="lineNum">      76 </span>            :  * complete with must vary depending on server version.  We handle this by
<span class="lineNum">      77 </span>            :  * storing a list of queries, each tagged with the minimum server version
<span class="lineNum">      78 </span>            :  * it will work for.  Each list must be stored in descending server version
<span class="lineNum">      79 </span>            :  * order, so that the first satisfactory query is the one to use.
<span class="lineNum">      80 </span>            :  *
<span class="lineNum">      81 </span>            :  * When the query string is otherwise constant, an array of VersionedQuery
<span class="lineNum">      82 </span>            :  * suffices.  Terminate the array with an entry having min_server_version = 0.
<span class="lineNum">      83 </span>            :  * That entry's query string can be a query that works in all supported older
<span class="lineNum">      84 </span>            :  * server versions, or NULL to give up and do no completion.
<span class="lineNum">      85 </span>            :  */
<span class="lineNum">      86 </span>            : typedef struct VersionedQuery
<span class="lineNum">      87 </span>            : {
<span class="lineNum">      88 </span>            :     int         min_server_version;
<span class="lineNum">      89 </span>            :     const char *query;
<span class="lineNum">      90 </span>            : } VersionedQuery;
<span class="lineNum">      91 </span>            : 
<span class="lineNum">      92 </span>            : /*
<span class="lineNum">      93 </span>            :  * This struct is used to define &quot;schema queries&quot;, which are custom-built
<span class="lineNum">      94 </span>            :  * to obtain possibly-schema-qualified names of database objects.  There is
<span class="lineNum">      95 </span>            :  * enough similarity in the structure that we don't want to repeat it each
<span class="lineNum">      96 </span>            :  * time.  So we put the components of each query into this struct and
<span class="lineNum">      97 </span>            :  * assemble them with the common boilerplate in _complete_from_query().
<span class="lineNum">      98 </span>            :  *
<span class="lineNum">      99 </span>            :  * As with VersionedQuery, we can use an array of these if the query details
<span class="lineNum">     100 </span>            :  * must vary across versions.
<span class="lineNum">     101 </span>            :  */
<span class="lineNum">     102 </span>            : typedef struct SchemaQuery
<span class="lineNum">     103 </span>            : {
<span class="lineNum">     104 </span>            :     /*
<span class="lineNum">     105 </span>            :      * If not zero, minimum server version this struct applies to.  If not
<span class="lineNum">     106 </span>            :      * zero, there should be a following struct with a smaller minimum server
<span class="lineNum">     107 </span>            :      * version; use catname == NULL in the last entry if we should do nothing.
<span class="lineNum">     108 </span>            :      */
<span class="lineNum">     109 </span>            :     int         min_server_version;
<span class="lineNum">     110 </span>            : 
<span class="lineNum">     111 </span>            :     /*
<span class="lineNum">     112 </span>            :      * Name of catalog or catalogs to be queried, with alias, eg.
<span class="lineNum">     113 </span>            :      * &quot;pg_catalog.pg_class c&quot;.  Note that &quot;pg_namespace n&quot; will be added.
<span class="lineNum">     114 </span>            :      */
<span class="lineNum">     115 </span>            :     const char *catname;
<span class="lineNum">     116 </span>            : 
<span class="lineNum">     117 </span>            :     /*
<span class="lineNum">     118 </span>            :      * Selection condition --- only rows meeting this condition are candidates
<span class="lineNum">     119 </span>            :      * to display.  If catname mentions multiple tables, include the necessary
<span class="lineNum">     120 </span>            :      * join condition here.  For example, this might look like &quot;c.relkind = &quot;
<span class="lineNum">     121 </span>            :      * CppAsString2(RELKIND_RELATION).  Write NULL (not an empty string) if
<span class="lineNum">     122 </span>            :      * not needed.
<span class="lineNum">     123 </span>            :      */
<span class="lineNum">     124 </span>            :     const char *selcondition;
<span class="lineNum">     125 </span>            : 
<span class="lineNum">     126 </span>            :     /*
<span class="lineNum">     127 </span>            :      * Visibility condition --- which rows are visible without schema
<span class="lineNum">     128 </span>            :      * qualification?  For example, &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;.
<span class="lineNum">     129 </span>            :      */
<span class="lineNum">     130 </span>            :     const char *viscondition;
<span class="lineNum">     131 </span>            : 
<span class="lineNum">     132 </span>            :     /*
<span class="lineNum">     133 </span>            :      * Namespace --- name of field to join to pg_namespace.oid. For example,
<span class="lineNum">     134 </span>            :      * &quot;c.relnamespace&quot;.
<span class="lineNum">     135 </span>            :      */
<span class="lineNum">     136 </span>            :     const char *namespace;
<span class="lineNum">     137 </span>            : 
<span class="lineNum">     138 </span>            :     /*
<span class="lineNum">     139 </span>            :      * Result --- the appropriately-quoted name to return, in the case of an
<span class="lineNum">     140 </span>            :      * unqualified name.  For example, &quot;pg_catalog.quote_ident(c.relname)&quot;.
<span class="lineNum">     141 </span>            :      */
<span class="lineNum">     142 </span>            :     const char *result;
<span class="lineNum">     143 </span>            : 
<span class="lineNum">     144 </span>            :     /*
<span class="lineNum">     145 </span>            :      * In some cases a different result must be used for qualified names.
<span class="lineNum">     146 </span>            :      * Enter that here, or write NULL if result can be used.
<span class="lineNum">     147 </span>            :      */
<span class="lineNum">     148 </span>            :     const char *qualresult;
<span class="lineNum">     149 </span>            : } SchemaQuery;
<span class="lineNum">     150 </span>            : 
<span class="lineNum">     151 </span>            : 
<span class="lineNum">     152 </span>            : /* Store maximum number of records we want from database queries
<span class="lineNum">     153 </span>            :  * (implemented via SELECT ... LIMIT xx).
<span class="lineNum">     154 </span>            :  */
<span class="lineNum">     155 </span>            : static int  completion_max_records;
<span class="lineNum">     156 </span>            : 
<span class="lineNum">     157 </span>            : /*
<span class="lineNum">     158 </span>            :  * Communication variables set by COMPLETE_WITH_FOO macros and then used by
<span class="lineNum">     159 </span>            :  * the completion callback functions.  Ugly but there is no better way.
<span class="lineNum">     160 </span>            :  */
<span class="lineNum">     161 </span>            : static const char *completion_charp;    /* to pass a string */
<span class="lineNum">     162 </span>            : static const char *const *completion_charpp;    /* to pass a list of strings */
<span class="lineNum">     163 </span>            : static const char *completion_info_charp;   /* to pass a second string */
<span class="lineNum">     164 </span>            : static const char *completion_info_charp2;  /* to pass a third string */
<span class="lineNum">     165 </span>            : static const VersionedQuery *completion_vquery; /* to pass a VersionedQuery */
<span class="lineNum">     166 </span>            : static const SchemaQuery *completion_squery;    /* to pass a SchemaQuery */
<span class="lineNum">     167 </span>            : static bool completion_case_sensitive;  /* completion is case sensitive */
<span class="lineNum">     168 </span>            : 
<span class="lineNum">     169 </span>            : /*
<span class="lineNum">     170 </span>            :  * A few macros to ease typing. You can use these to complete the given
<span class="lineNum">     171 </span>            :  * string with
<span class="lineNum">     172 </span>            :  * 1) The results from a query you pass it. (Perhaps one of those below?)
<span class="lineNum">     173 </span>            :  *    We support both simple and versioned queries.
<span class="lineNum">     174 </span>            :  * 2) The results from a schema query you pass it.
<span class="lineNum">     175 </span>            :  *    We support both simple and versioned schema queries.
<span class="lineNum">     176 </span>            :  * 3) The items from a null-pointer-terminated list (with or without
<span class="lineNum">     177 </span>            :  *    case-sensitive comparison); if the list is constant you can build it
<span class="lineNum">     178 </span>            :  *    with COMPLETE_WITH() or COMPLETE_WITH_CS().
<span class="lineNum">     179 </span>            :  * 4) The list of attributes of the given table (possibly schema-qualified).
<span class="lineNum">     180 </span>            :  * 5) The list of arguments to the given function (possibly schema-qualified).
<span class="lineNum">     181 </span>            :  */
<span class="lineNum">     182 </span>            : #define COMPLETE_WITH_QUERY(query) \
<span class="lineNum">     183 </span>            : do { \
<span class="lineNum">     184 </span>            :     completion_charp = query; \
<span class="lineNum">     185 </span>            :     matches = completion_matches(text, complete_from_query); \
<span class="lineNum">     186 </span>            : } while (0)
<span class="lineNum">     187 </span>            : 
<span class="lineNum">     188 </span>            : #define COMPLETE_WITH_VERSIONED_QUERY(query) \
<span class="lineNum">     189 </span>            : do { \
<span class="lineNum">     190 </span>            :     completion_vquery = query; \
<span class="lineNum">     191 </span>            :     matches = completion_matches(text, complete_from_versioned_query); \
<span class="lineNum">     192 </span>            : } while (0)
<span class="lineNum">     193 </span>            : 
<span class="lineNum">     194 </span>            : #define COMPLETE_WITH_SCHEMA_QUERY(query, addon) \
<span class="lineNum">     195 </span>            : do { \
<span class="lineNum">     196 </span>            :     completion_squery = &amp;(query); \
<span class="lineNum">     197 </span>            :     completion_charp = addon; \
<span class="lineNum">     198 </span>            :     matches = completion_matches(text, complete_from_schema_query); \
<span class="lineNum">     199 </span>            : } while (0)
<span class="lineNum">     200 </span>            : 
<span class="lineNum">     201 </span>            : #define COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(query, addon) \
<span class="lineNum">     202 </span>            : do { \
<span class="lineNum">     203 </span>            :     completion_squery = query; \
<span class="lineNum">     204 </span>            :     completion_vquery = addon; \
<span class="lineNum">     205 </span>            :     matches = completion_matches(text, complete_from_versioned_schema_query); \
<span class="lineNum">     206 </span>            : } while (0)
<span class="lineNum">     207 </span>            : 
<span class="lineNum">     208 </span>            : /*
<span class="lineNum">     209 </span>            :  * Caution: COMPLETE_WITH_CONST is not for general-purpose use; you probably
<span class="lineNum">     210 </span>            :  * want COMPLETE_WITH() with one element, instead.
<span class="lineNum">     211 </span>            :  */
<span class="lineNum">     212 </span>            : #define COMPLETE_WITH_CONST(cs, con) \
<span class="lineNum">     213 </span>            : do { \
<span class="lineNum">     214 </span>            :     completion_case_sensitive = (cs); \
<span class="lineNum">     215 </span>            :     completion_charp = (con); \
<span class="lineNum">     216 </span>            :     matches = completion_matches(text, complete_from_const); \
<span class="lineNum">     217 </span>            : } while (0)
<span class="lineNum">     218 </span>            : 
<span class="lineNum">     219 </span>            : #define COMPLETE_WITH_LIST_INT(cs, list) \
<span class="lineNum">     220 </span>            : do { \
<span class="lineNum">     221 </span>            :     completion_case_sensitive = (cs); \
<span class="lineNum">     222 </span>            :     completion_charpp = (list); \
<span class="lineNum">     223 </span>            :     matches = completion_matches(text, complete_from_list); \
<span class="lineNum">     224 </span>            : } while (0)
<span class="lineNum">     225 </span>            : 
<span class="lineNum">     226 </span>            : #define COMPLETE_WITH_LIST(list) COMPLETE_WITH_LIST_INT(false, list)
<span class="lineNum">     227 </span>            : #define COMPLETE_WITH_LIST_CS(list) COMPLETE_WITH_LIST_INT(true, list)
<span class="lineNum">     228 </span>            : 
<span class="lineNum">     229 </span>            : #define COMPLETE_WITH(...) \
<span class="lineNum">     230 </span>            : do { \
<span class="lineNum">     231 </span>            :     static const char *const list[] = { __VA_ARGS__, NULL }; \
<span class="lineNum">     232 </span>            :     COMPLETE_WITH_LIST(list); \
<span class="lineNum">     233 </span>            : } while (0)
<span class="lineNum">     234 </span>            : 
<span class="lineNum">     235 </span>            : #define COMPLETE_WITH_CS(...) \
<span class="lineNum">     236 </span>            : do { \
<span class="lineNum">     237 </span>            :     static const char *const list[] = { __VA_ARGS__, NULL }; \
<span class="lineNum">     238 </span>            :     COMPLETE_WITH_LIST_CS(list); \
<span class="lineNum">     239 </span>            : } while (0)
<span class="lineNum">     240 </span>            : 
<span class="lineNum">     241 </span>            : #define COMPLETE_WITH_ATTR(relation, addon) \
<span class="lineNum">     242 </span>            : do { \
<span class="lineNum">     243 </span>            :     char   *_completion_schema; \
<span class="lineNum">     244 </span>            :     char   *_completion_table; \
<span class="lineNum">     245 </span>            : \
<span class="lineNum">     246 </span>            :     _completion_schema = strtokx(relation, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     247 </span>            :                                  false, false, pset.encoding); \
<span class="lineNum">     248 </span>            :     (void) strtokx(NULL, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     249 </span>            :                    false, false, pset.encoding); \
<span class="lineNum">     250 </span>            :     _completion_table = strtokx(NULL, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     251 </span>            :                                 false, false, pset.encoding); \
<span class="lineNum">     252 </span>            :     if (_completion_table == NULL) \
<span class="lineNum">     253 </span>            :     { \
<span class="lineNum">     254 </span>            :         completion_charp = Query_for_list_of_attributes  addon; \
<span class="lineNum">     255 </span>            :         completion_info_charp = relation; \
<span class="lineNum">     256 </span>            :     } \
<span class="lineNum">     257 </span>            :     else \
<span class="lineNum">     258 </span>            :     { \
<span class="lineNum">     259 </span>            :         completion_charp = Query_for_list_of_attributes_with_schema  addon; \
<span class="lineNum">     260 </span>            :         completion_info_charp = _completion_table; \
<span class="lineNum">     261 </span>            :         completion_info_charp2 = _completion_schema; \
<span class="lineNum">     262 </span>            :     } \
<span class="lineNum">     263 </span>            :     matches = completion_matches(text, complete_from_query); \
<span class="lineNum">     264 </span>            : } while (0)
<span class="lineNum">     265 </span>            : 
<span class="lineNum">     266 </span>            : #define COMPLETE_WITH_ENUM_VALUE(type) \
<span class="lineNum">     267 </span>            : do { \
<span class="lineNum">     268 </span>            :     char   *_completion_schema; \
<span class="lineNum">     269 </span>            :     char   *_completion_type; \
<span class="lineNum">     270 </span>            : \
<span class="lineNum">     271 </span>            :     _completion_schema = strtokx(type, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     272 </span>            :                                  false, false, pset.encoding); \
<span class="lineNum">     273 </span>            :     (void) strtokx(NULL, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     274 </span>            :                    false, false, pset.encoding); \
<span class="lineNum">     275 </span>            :     _completion_type = strtokx(NULL, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     276 </span>            :                                false, false, pset.encoding);  \
<span class="lineNum">     277 </span>            :     if (_completion_type == NULL)\
<span class="lineNum">     278 </span>            :     { \
<span class="lineNum">     279 </span>            :         completion_charp = Query_for_list_of_enum_values; \
<span class="lineNum">     280 </span>            :         completion_info_charp = type; \
<span class="lineNum">     281 </span>            :     } \
<span class="lineNum">     282 </span>            :     else \
<span class="lineNum">     283 </span>            :     { \
<span class="lineNum">     284 </span>            :         completion_charp = Query_for_list_of_enum_values_with_schema; \
<span class="lineNum">     285 </span>            :         completion_info_charp = _completion_type; \
<span class="lineNum">     286 </span>            :         completion_info_charp2 = _completion_schema; \
<span class="lineNum">     287 </span>            :     } \
<span class="lineNum">     288 </span>            :     matches = completion_matches(text, complete_from_query); \
<span class="lineNum">     289 </span>            : } while (0)
<span class="lineNum">     290 </span>            : 
<span class="lineNum">     291 </span>            : #define COMPLETE_WITH_FUNCTION_ARG(function) \
<span class="lineNum">     292 </span>            : do { \
<span class="lineNum">     293 </span>            :     char   *_completion_schema; \
<span class="lineNum">     294 </span>            :     char   *_completion_function; \
<span class="lineNum">     295 </span>            : \
<span class="lineNum">     296 </span>            :     _completion_schema = strtokx(function, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     297 </span>            :                                  false, false, pset.encoding); \
<span class="lineNum">     298 </span>            :     (void) strtokx(NULL, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     299 </span>            :                    false, false, pset.encoding); \
<span class="lineNum">     300 </span>            :     _completion_function = strtokx(NULL, &quot; \t\n\r&quot;, &quot;.&quot;, &quot;\&quot;&quot;, 0, \
<span class="lineNum">     301 </span>            :                                    false, false, pset.encoding); \
<span class="lineNum">     302 </span>            :     if (_completion_function == NULL) \
<span class="lineNum">     303 </span>            :     { \
<span class="lineNum">     304 </span>            :         completion_charp = Query_for_list_of_arguments; \
<span class="lineNum">     305 </span>            :         completion_info_charp = function; \
<span class="lineNum">     306 </span>            :     } \
<span class="lineNum">     307 </span>            :     else \
<span class="lineNum">     308 </span>            :     { \
<span class="lineNum">     309 </span>            :         completion_charp = Query_for_list_of_arguments_with_schema; \
<span class="lineNum">     310 </span>            :         completion_info_charp = _completion_function; \
<span class="lineNum">     311 </span>            :         completion_info_charp2 = _completion_schema; \
<span class="lineNum">     312 </span>            :     } \
<span class="lineNum">     313 </span>            :     matches = completion_matches(text, complete_from_query); \
<span class="lineNum">     314 </span>            : } while (0)
<span class="lineNum">     315 </span>            : 
<span class="lineNum">     316 </span>            : /*
<span class="lineNum">     317 </span>            :  * Assembly instructions for schema queries
<span class="lineNum">     318 </span>            :  */
<span class="lineNum">     319 </span>            : 
<span class="lineNum">     320 </span>            : static const SchemaQuery Query_for_list_of_aggregates[] = {
<span class="lineNum">     321 </span>            :     {
<span class="lineNum">     322 </span>            :         .min_server_version = 110000,
<span class="lineNum">     323 </span>            :         .catname = &quot;pg_catalog.pg_proc p&quot;,
<span class="lineNum">     324 </span>            :         .selcondition = &quot;p.prokind = 'a'&quot;,
<span class="lineNum">     325 </span>            :         .viscondition = &quot;pg_catalog.pg_function_is_visible(p.oid)&quot;,
<span class="lineNum">     326 </span>            :         .namespace = &quot;p.pronamespace&quot;,
<span class="lineNum">     327 </span>            :         .result = &quot;pg_catalog.quote_ident(p.proname)&quot;,
<span class="lineNum">     328 </span>            :     },
<span class="lineNum">     329 </span>            :     {
<span class="lineNum">     330 </span>            :         .catname = &quot;pg_catalog.pg_proc p&quot;,
<span class="lineNum">     331 </span>            :         .selcondition = &quot;p.proisagg&quot;,
<span class="lineNum">     332 </span>            :         .viscondition = &quot;pg_catalog.pg_function_is_visible(p.oid)&quot;,
<span class="lineNum">     333 </span>            :         .namespace = &quot;p.pronamespace&quot;,
<span class="lineNum">     334 </span>            :         .result = &quot;pg_catalog.quote_ident(p.proname)&quot;,
<span class="lineNum">     335 </span>            :     }
<span class="lineNum">     336 </span>            : };
<span class="lineNum">     337 </span>            : 
<span class="lineNum">     338 </span>            : static const SchemaQuery Query_for_list_of_datatypes = {
<span class="lineNum">     339 </span>            :     .catname = &quot;pg_catalog.pg_type t&quot;,
<span class="lineNum">     340 </span>            :     /* selcondition --- ignore table rowtypes and array types */
<span class="lineNum">     341 </span>            :     .selcondition = &quot;(t.typrelid = 0 &quot;
<span class="lineNum">     342 </span>            :     &quot; OR (SELECT c.relkind = &quot; CppAsString2(RELKIND_COMPOSITE_TYPE)
<span class="lineNum">     343 </span>            :     &quot;     FROM pg_catalog.pg_class c WHERE c.oid = t.typrelid)) &quot;
<span class="lineNum">     344 </span>            :     &quot;AND t.typname !~ '^_'&quot;,
<span class="lineNum">     345 </span>            :     .viscondition = &quot;pg_catalog.pg_type_is_visible(t.oid)&quot;,
<span class="lineNum">     346 </span>            :     .namespace = &quot;t.typnamespace&quot;,
<span class="lineNum">     347 </span>            :     .result = &quot;pg_catalog.format_type(t.oid, NULL)&quot;,
<span class="lineNum">     348 </span>            :     .qualresult = &quot;pg_catalog.quote_ident(t.typname)&quot;,
<span class="lineNum">     349 </span>            : };
<span class="lineNum">     350 </span>            : 
<span class="lineNum">     351 </span>            : static const SchemaQuery Query_for_list_of_composite_datatypes = {
<span class="lineNum">     352 </span>            :     .catname = &quot;pg_catalog.pg_type t&quot;,
<span class="lineNum">     353 </span>            :     /* selcondition --- only get composite types */
<span class="lineNum">     354 </span>            :     .selcondition = &quot;(SELECT c.relkind = &quot; CppAsString2(RELKIND_COMPOSITE_TYPE)
<span class="lineNum">     355 </span>            :     &quot; FROM pg_catalog.pg_class c WHERE c.oid = t.typrelid) &quot;
<span class="lineNum">     356 </span>            :     &quot;AND t.typname !~ '^_'&quot;,
<span class="lineNum">     357 </span>            :     .viscondition = &quot;pg_catalog.pg_type_is_visible(t.oid)&quot;,
<span class="lineNum">     358 </span>            :     .namespace = &quot;t.typnamespace&quot;,
<span class="lineNum">     359 </span>            :     .result = &quot;pg_catalog.format_type(t.oid, NULL)&quot;,
<span class="lineNum">     360 </span>            :     .qualresult = &quot;pg_catalog.quote_ident(t.typname)&quot;,
<span class="lineNum">     361 </span>            : };
<span class="lineNum">     362 </span>            : 
<span class="lineNum">     363 </span>            : static const SchemaQuery Query_for_list_of_domains = {
<span class="lineNum">     364 </span>            :     .catname = &quot;pg_catalog.pg_type t&quot;,
<span class="lineNum">     365 </span>            :     .selcondition = &quot;t.typtype = 'd'&quot;,
<span class="lineNum">     366 </span>            :     .viscondition = &quot;pg_catalog.pg_type_is_visible(t.oid)&quot;,
<span class="lineNum">     367 </span>            :     .namespace = &quot;t.typnamespace&quot;,
<span class="lineNum">     368 </span>            :     .result = &quot;pg_catalog.quote_ident(t.typname)&quot;,
<span class="lineNum">     369 </span>            : };
<span class="lineNum">     370 </span>            : 
<span class="lineNum">     371 </span>            : /* Note: this intentionally accepts aggregates as well as plain functions */
<span class="lineNum">     372 </span>            : static const SchemaQuery Query_for_list_of_functions[] = {
<span class="lineNum">     373 </span>            :     {
<span class="lineNum">     374 </span>            :         .min_server_version = 110000,
<span class="lineNum">     375 </span>            :         .catname = &quot;pg_catalog.pg_proc p&quot;,
<span class="lineNum">     376 </span>            :         .selcondition = &quot;p.prokind != 'p'&quot;,
<span class="lineNum">     377 </span>            :         .viscondition = &quot;pg_catalog.pg_function_is_visible(p.oid)&quot;,
<span class="lineNum">     378 </span>            :         .namespace = &quot;p.pronamespace&quot;,
<span class="lineNum">     379 </span>            :         .result = &quot;pg_catalog.quote_ident(p.proname)&quot;,
<span class="lineNum">     380 </span>            :     },
<span class="lineNum">     381 </span>            :     {
<span class="lineNum">     382 </span>            :         .catname = &quot;pg_catalog.pg_proc p&quot;,
<span class="lineNum">     383 </span>            :         .viscondition = &quot;pg_catalog.pg_function_is_visible(p.oid)&quot;,
<span class="lineNum">     384 </span>            :         .namespace = &quot;p.pronamespace&quot;,
<span class="lineNum">     385 </span>            :         .result = &quot;pg_catalog.quote_ident(p.proname)&quot;,
<span class="lineNum">     386 </span>            :     }
<span class="lineNum">     387 </span>            : };
<span class="lineNum">     388 </span>            : 
<span class="lineNum">     389 </span>            : static const SchemaQuery Query_for_list_of_procedures[] = {
<span class="lineNum">     390 </span>            :     {
<span class="lineNum">     391 </span>            :         .min_server_version = 110000,
<span class="lineNum">     392 </span>            :         .catname = &quot;pg_catalog.pg_proc p&quot;,
<span class="lineNum">     393 </span>            :         .selcondition = &quot;p.prokind = 'p'&quot;,
<span class="lineNum">     394 </span>            :         .viscondition = &quot;pg_catalog.pg_function_is_visible(p.oid)&quot;,
<span class="lineNum">     395 </span>            :         .namespace = &quot;p.pronamespace&quot;,
<span class="lineNum">     396 </span>            :         .result = &quot;pg_catalog.quote_ident(p.proname)&quot;,
<span class="lineNum">     397 </span>            :     },
<span class="lineNum">     398 </span>            :     {
<span class="lineNum">     399 </span>            :         /* not supported in older versions */
<span class="lineNum">     400 </span>            :         .catname = NULL,
<span class="lineNum">     401 </span>            :     }
<span class="lineNum">     402 </span>            : };
<span class="lineNum">     403 </span>            : 
<span class="lineNum">     404 </span>            : static const SchemaQuery Query_for_list_of_routines = {
<span class="lineNum">     405 </span>            :     .catname = &quot;pg_catalog.pg_proc p&quot;,
<span class="lineNum">     406 </span>            :     .viscondition = &quot;pg_catalog.pg_function_is_visible(p.oid)&quot;,
<span class="lineNum">     407 </span>            :     .namespace = &quot;p.pronamespace&quot;,
<span class="lineNum">     408 </span>            :     .result = &quot;pg_catalog.quote_ident(p.proname)&quot;,
<span class="lineNum">     409 </span>            : };
<span class="lineNum">     410 </span>            : 
<span class="lineNum">     411 </span>            : static const SchemaQuery Query_for_list_of_sequences = {
<span class="lineNum">     412 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     413 </span>            :     .selcondition = &quot;c.relkind IN (&quot; CppAsString2(RELKIND_SEQUENCE) &quot;)&quot;,
<span class="lineNum">     414 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     415 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     416 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     417 </span>            : };
<span class="lineNum">     418 </span>            : 
<span class="lineNum">     419 </span>            : static const SchemaQuery Query_for_list_of_foreign_tables = {
<span class="lineNum">     420 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     421 </span>            :     .selcondition = &quot;c.relkind IN (&quot; CppAsString2(RELKIND_FOREIGN_TABLE) &quot;)&quot;,
<span class="lineNum">     422 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     423 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     424 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     425 </span>            : };
<span class="lineNum">     426 </span>            : 
<span class="lineNum">     427 </span>            : static const SchemaQuery Query_for_list_of_tables = {
<span class="lineNum">     428 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     429 </span>            :     .selcondition =
<span class="lineNum">     430 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_RELATION) &quot;, &quot;
<span class="lineNum">     431 </span>            :     CppAsString2(RELKIND_PARTITIONED_TABLE) &quot;)&quot;,
<span class="lineNum">     432 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     433 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     434 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     435 </span>            : };
<span class="lineNum">     436 </span>            : 
<span class="lineNum">     437 </span>            : static const SchemaQuery Query_for_list_of_partitioned_tables = {
<span class="lineNum">     438 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     439 </span>            :     .selcondition = &quot;c.relkind IN (&quot; CppAsString2(RELKIND_PARTITIONED_TABLE) &quot;)&quot;,
<span class="lineNum">     440 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     441 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     442 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     443 </span>            : };
<span class="lineNum">     444 </span>            : 
<span class="lineNum">     445 </span>            : static const SchemaQuery Query_for_list_of_views = {
<span class="lineNum">     446 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     447 </span>            :     .selcondition = &quot;c.relkind IN (&quot; CppAsString2(RELKIND_VIEW) &quot;)&quot;,
<span class="lineNum">     448 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     449 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     450 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     451 </span>            : };
<span class="lineNum">     452 </span>            : 
<span class="lineNum">     453 </span>            : static const SchemaQuery Query_for_list_of_matviews = {
<span class="lineNum">     454 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     455 </span>            :     .selcondition = &quot;c.relkind IN (&quot; CppAsString2(RELKIND_MATVIEW) &quot;)&quot;,
<span class="lineNum">     456 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     457 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     458 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     459 </span>            : };
<span class="lineNum">     460 </span>            : 
<span class="lineNum">     461 </span>            : static const SchemaQuery Query_for_list_of_indexes = {
<span class="lineNum">     462 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     463 </span>            :     .selcondition =
<span class="lineNum">     464 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_INDEX) &quot;, &quot;
<span class="lineNum">     465 </span>            :     CppAsString2(RELKIND_PARTITIONED_INDEX) &quot;)&quot;,
<span class="lineNum">     466 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     467 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     468 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     469 </span>            : };
<span class="lineNum">     470 </span>            : 
<span class="lineNum">     471 </span>            : static const SchemaQuery Query_for_list_of_partitioned_indexes = {
<span class="lineNum">     472 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     473 </span>            :     .selcondition = &quot;c.relkind = &quot; CppAsString2(RELKIND_PARTITIONED_INDEX),
<span class="lineNum">     474 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     475 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     476 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     477 </span>            : };
<span class="lineNum">     478 </span>            : 
<span class="lineNum">     479 </span>            : 
<span class="lineNum">     480 </span>            : /* All relations */
<span class="lineNum">     481 </span>            : static const SchemaQuery Query_for_list_of_relations = {
<span class="lineNum">     482 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     483 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     484 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     485 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     486 </span>            : };
<span class="lineNum">     487 </span>            : 
<span class="lineNum">     488 </span>            : /* partitioned relations */
<span class="lineNum">     489 </span>            : static const SchemaQuery Query_for_list_of_partitioned_relations = {
<span class="lineNum">     490 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     491 </span>            :     .selcondition = &quot;c.relkind IN (&quot; CppAsString2(RELKIND_PARTITIONED_TABLE)
<span class="lineNum">     492 </span>            :     &quot;, &quot; CppAsString2(RELKIND_PARTITIONED_INDEX) &quot;)&quot;,
<span class="lineNum">     493 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     494 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     495 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     496 </span>            : };
<span class="lineNum">     497 </span>            : 
<span class="lineNum">     498 </span>            : /* Relations supporting INSERT, UPDATE or DELETE */
<span class="lineNum">     499 </span>            : static const SchemaQuery Query_for_list_of_updatables = {
<span class="lineNum">     500 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     501 </span>            :     .selcondition =
<span class="lineNum">     502 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_RELATION) &quot;, &quot;
<span class="lineNum">     503 </span>            :     CppAsString2(RELKIND_FOREIGN_TABLE) &quot;, &quot;
<span class="lineNum">     504 </span>            :     CppAsString2(RELKIND_VIEW) &quot;, &quot;
<span class="lineNum">     505 </span>            :     CppAsString2(RELKIND_PARTITIONED_TABLE) &quot;)&quot;,
<span class="lineNum">     506 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     507 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     508 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     509 </span>            : };
<span class="lineNum">     510 </span>            : 
<span class="lineNum">     511 </span>            : /* Relations supporting SELECT */
<span class="lineNum">     512 </span>            : static const SchemaQuery Query_for_list_of_selectables = {
<span class="lineNum">     513 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     514 </span>            :     .selcondition =
<span class="lineNum">     515 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_RELATION) &quot;, &quot;
<span class="lineNum">     516 </span>            :     CppAsString2(RELKIND_SEQUENCE) &quot;, &quot;
<span class="lineNum">     517 </span>            :     CppAsString2(RELKIND_VIEW) &quot;, &quot;
<span class="lineNum">     518 </span>            :     CppAsString2(RELKIND_MATVIEW) &quot;, &quot;
<span class="lineNum">     519 </span>            :     CppAsString2(RELKIND_FOREIGN_TABLE) &quot;, &quot;
<span class="lineNum">     520 </span>            :     CppAsString2(RELKIND_PARTITIONED_TABLE) &quot;)&quot;,
<span class="lineNum">     521 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     522 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     523 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     524 </span>            : };
<span class="lineNum">     525 </span>            : 
<span class="lineNum">     526 </span>            : /* Relations supporting GRANT are currently same as those supporting SELECT */
<span class="lineNum">     527 </span>            : #define Query_for_list_of_grantables Query_for_list_of_selectables
<span class="lineNum">     528 </span>            : 
<span class="lineNum">     529 </span>            : /* Relations supporting ANALYZE */
<span class="lineNum">     530 </span>            : static const SchemaQuery Query_for_list_of_analyzables = {
<span class="lineNum">     531 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     532 </span>            :     .selcondition =
<span class="lineNum">     533 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_RELATION) &quot;, &quot;
<span class="lineNum">     534 </span>            :     CppAsString2(RELKIND_PARTITIONED_TABLE) &quot;, &quot;
<span class="lineNum">     535 </span>            :     CppAsString2(RELKIND_MATVIEW) &quot;, &quot;
<span class="lineNum">     536 </span>            :     CppAsString2(RELKIND_FOREIGN_TABLE) &quot;)&quot;,
<span class="lineNum">     537 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     538 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     539 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     540 </span>            : };
<span class="lineNum">     541 </span>            : 
<span class="lineNum">     542 </span>            : /* Relations supporting index creation */
<span class="lineNum">     543 </span>            : static const SchemaQuery Query_for_list_of_indexables = {
<span class="lineNum">     544 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     545 </span>            :     .selcondition =
<span class="lineNum">     546 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_RELATION) &quot;, &quot;
<span class="lineNum">     547 </span>            :     CppAsString2(RELKIND_PARTITIONED_TABLE) &quot;, &quot;
<span class="lineNum">     548 </span>            :     CppAsString2(RELKIND_MATVIEW) &quot;)&quot;,
<span class="lineNum">     549 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     550 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     551 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     552 </span>            : };
<span class="lineNum">     553 </span>            : 
<span class="lineNum">     554 </span>            : /* Relations supporting VACUUM */
<span class="lineNum">     555 </span>            : static const SchemaQuery Query_for_list_of_vacuumables = {
<span class="lineNum">     556 </span>            :     .catname = &quot;pg_catalog.pg_class c&quot;,
<span class="lineNum">     557 </span>            :     .selcondition =
<span class="lineNum">     558 </span>            :     &quot;c.relkind IN (&quot; CppAsString2(RELKIND_RELATION) &quot;, &quot;
<span class="lineNum">     559 </span>            :     CppAsString2(RELKIND_MATVIEW) &quot;)&quot;,
<span class="lineNum">     560 </span>            :     .viscondition = &quot;pg_catalog.pg_table_is_visible(c.oid)&quot;,
<span class="lineNum">     561 </span>            :     .namespace = &quot;c.relnamespace&quot;,
<span class="lineNum">     562 </span>            :     .result = &quot;pg_catalog.quote_ident(c.relname)&quot;,
<span class="lineNum">     563 </span>            : };
<span class="lineNum">     564 </span>            : 
<span class="lineNum">     565 </span>            : /* Relations supporting CLUSTER are currently same as those supporting VACUUM */
<span class="lineNum">     566 </span>            : #define Query_for_list_of_clusterables Query_for_list_of_vacuumables
<span class="lineNum">     567 </span>            : 
<span class="lineNum">     568 </span>            : static const SchemaQuery Query_for_list_of_constraints_with_schema = {
<span class="lineNum">     569 </span>            :     .catname = &quot;pg_catalog.pg_constraint c&quot;,
<span class="lineNum">     570 </span>            :     .selcondition = &quot;c.conrelid &lt;&gt; 0&quot;,
<span class="lineNum">     571 </span>            :     .viscondition = &quot;true&quot;,       /* there is no pg_constraint_is_visible */
<span class="lineNum">     572 </span>            :     .namespace = &quot;c.connamespace&quot;,
<span class="lineNum">     573 </span>            :     .result = &quot;pg_catalog.quote_ident(c.conname)&quot;,
<span class="lineNum">     574 </span>            : };
<span class="lineNum">     575 </span>            : 
<span class="lineNum">     576 </span>            : static const SchemaQuery Query_for_list_of_statistics = {
<span class="lineNum">     577 </span>            :     .catname = &quot;pg_catalog.pg_statistic_ext s&quot;,
<span class="lineNum">     578 </span>            :     .viscondition = &quot;pg_catalog.pg_statistics_obj_is_visible(s.oid)&quot;,
<span class="lineNum">     579 </span>            :     .namespace = &quot;s.stxnamespace&quot;,
<span class="lineNum">     580 </span>            :     .result = &quot;pg_catalog.quote_ident(s.stxname)&quot;,
<span class="lineNum">     581 </span>            : };
<span class="lineNum">     582 </span>            : 
<span class="lineNum">     583 </span>            : 
<span class="lineNum">     584 </span>            : /*
<span class="lineNum">     585 </span>            :  * Queries to get lists of names of various kinds of things, possibly
<span class="lineNum">     586 </span>            :  * restricted to names matching a partially entered name.  In these queries,
<span class="lineNum">     587 </span>            :  * the first %s will be replaced by the text entered so far (suitably escaped
<span class="lineNum">     588 </span>            :  * to become a SQL literal string).  %d will be replaced by the length of the
<span class="lineNum">     589 </span>            :  * string (in unescaped form).  A second and third %s, if present, will be
<span class="lineNum">     590 </span>            :  * replaced by a suitably-escaped version of the string provided in
<span class="lineNum">     591 </span>            :  * completion_info_charp.  A fourth and fifth %s are similarly replaced by
<span class="lineNum">     592 </span>            :  * completion_info_charp2.
<span class="lineNum">     593 </span>            :  *
<span class="lineNum">     594 </span>            :  * Beware that the allowed sequences of %s and %d are determined by
<span class="lineNum">     595 </span>            :  * _complete_from_query().
<span class="lineNum">     596 </span>            :  */
<span class="lineNum">     597 </span>            : 
<span class="lineNum">     598 </span>            : #define Query_for_list_of_attributes \
<span class="lineNum">     599 </span>            : &quot;SELECT pg_catalog.quote_ident(attname) &quot;\
<span class="lineNum">     600 </span>            : &quot;  FROM pg_catalog.pg_attribute a, pg_catalog.pg_class c &quot;\
<span class="lineNum">     601 </span>            : &quot; WHERE c.oid = a.attrelid &quot;\
<span class="lineNum">     602 </span>            : &quot;   AND a.attnum &gt; 0 &quot;\
<span class="lineNum">     603 </span>            : &quot;   AND NOT a.attisdropped &quot;\
<span class="lineNum">     604 </span>            : &quot;   AND substring(pg_catalog.quote_ident(attname),1,%d)='%s' &quot;\
<span class="lineNum">     605 </span>            : &quot;   AND (pg_catalog.quote_ident(relname)='%s' &quot;\
<span class="lineNum">     606 </span>            : &quot;        OR '\&quot;' || relname || '\&quot;'='%s') &quot;\
<span class="lineNum">     607 </span>            : &quot;   AND pg_catalog.pg_table_is_visible(c.oid)&quot;
<span class="lineNum">     608 </span>            : 
<span class="lineNum">     609 </span>            : #define Query_for_list_of_attribute_numbers \
<span class="lineNum">     610 </span>            : &quot;SELECT attnum &quot;\
<span class="lineNum">     611 </span>            : &quot;  FROM pg_catalog.pg_attribute a, pg_catalog.pg_class c &quot;\
<span class="lineNum">     612 </span>            : &quot; WHERE c.oid = a.attrelid &quot;\
<span class="lineNum">     613 </span>            : &quot;   AND a.attnum &gt; 0 &quot;\
<span class="lineNum">     614 </span>            : &quot;   AND NOT a.attisdropped &quot;\
<span class="lineNum">     615 </span>            : &quot;   AND substring(attnum::pg_catalog.text,1,%d)='%s' &quot;\
<span class="lineNum">     616 </span>            : &quot;   AND (pg_catalog.quote_ident(relname)='%s' &quot;\
<span class="lineNum">     617 </span>            : &quot;        OR '\&quot;' || relname || '\&quot;'='%s') &quot;\
<span class="lineNum">     618 </span>            : &quot;   AND pg_catalog.pg_table_is_visible(c.oid)&quot;
<span class="lineNum">     619 </span>            : 
<span class="lineNum">     620 </span>            : #define Query_for_list_of_attributes_with_schema \
<span class="lineNum">     621 </span>            : &quot;SELECT pg_catalog.quote_ident(attname) &quot;\
<span class="lineNum">     622 </span>            : &quot;  FROM pg_catalog.pg_attribute a, pg_catalog.pg_class c, pg_catalog.pg_namespace n &quot;\
<span class="lineNum">     623 </span>            : &quot; WHERE c.oid = a.attrelid &quot;\
<span class="lineNum">     624 </span>            : &quot;   AND n.oid = c.relnamespace &quot;\
<span class="lineNum">     625 </span>            : &quot;   AND a.attnum &gt; 0 &quot;\
<span class="lineNum">     626 </span>            : &quot;   AND NOT a.attisdropped &quot;\
<span class="lineNum">     627 </span>            : &quot;   AND substring(pg_catalog.quote_ident(attname),1,%d)='%s' &quot;\
<span class="lineNum">     628 </span>            : &quot;   AND (pg_catalog.quote_ident(relname)='%s' &quot;\
<span class="lineNum">     629 </span>            : &quot;        OR '\&quot;' || relname || '\&quot;' ='%s') &quot;\
<span class="lineNum">     630 </span>            : &quot;   AND (pg_catalog.quote_ident(nspname)='%s' &quot;\
<span class="lineNum">     631 </span>            : &quot;        OR '\&quot;' || nspname || '\&quot;' ='%s') &quot;
<span class="lineNum">     632 </span>            : 
<span class="lineNum">     633 </span>            : #define Query_for_list_of_enum_values \
<span class="lineNum">     634 </span>            : &quot;SELECT pg_catalog.quote_literal(enumlabel) &quot;\
<span class="lineNum">     635 </span>            : &quot;  FROM pg_catalog.pg_enum e, pg_catalog.pg_type t &quot;\
<span class="lineNum">     636 </span>            : &quot; WHERE t.oid = e.enumtypid &quot;\
<span class="lineNum">     637 </span>            : &quot;   AND substring(pg_catalog.quote_literal(enumlabel),1,%d)='%s' &quot;\
<span class="lineNum">     638 </span>            : &quot;   AND (pg_catalog.quote_ident(typname)='%s' &quot;\
<span class="lineNum">     639 </span>            : &quot;        OR '\&quot;' || typname || '\&quot;'='%s') &quot;\
<span class="lineNum">     640 </span>            : &quot;   AND pg_catalog.pg_type_is_visible(t.oid)&quot;
<span class="lineNum">     641 </span>            : 
<span class="lineNum">     642 </span>            : #define Query_for_list_of_enum_values_with_schema \
<span class="lineNum">     643 </span>            : &quot;SELECT pg_catalog.quote_literal(enumlabel) &quot;\
<span class="lineNum">     644 </span>            : &quot;  FROM pg_catalog.pg_enum e, pg_catalog.pg_type t, pg_catalog.pg_namespace n &quot;\
<span class="lineNum">     645 </span>            : &quot; WHERE t.oid = e.enumtypid &quot;\
<span class="lineNum">     646 </span>            : &quot;   AND n.oid = t.typnamespace &quot;\
<span class="lineNum">     647 </span>            : &quot;   AND substring(pg_catalog.quote_literal(enumlabel),1,%d)='%s' &quot;\
<span class="lineNum">     648 </span>            : &quot;   AND (pg_catalog.quote_ident(typname)='%s' &quot;\
<span class="lineNum">     649 </span>            : &quot;        OR '\&quot;' || typname || '\&quot;'='%s') &quot;\
<span class="lineNum">     650 </span>            : &quot;   AND (pg_catalog.quote_ident(nspname)='%s' &quot;\
<span class="lineNum">     651 </span>            : &quot;        OR '\&quot;' || nspname || '\&quot;' ='%s') &quot;
<span class="lineNum">     652 </span>            : 
<span class="lineNum">     653 </span>            : #define Query_for_list_of_template_databases \
<span class="lineNum">     654 </span>            : &quot;SELECT pg_catalog.quote_ident(d.datname) &quot;\
<span class="lineNum">     655 </span>            : &quot;  FROM pg_catalog.pg_database d &quot;\
<span class="lineNum">     656 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(d.datname),1,%d)='%s' &quot;\
<span class="lineNum">     657 </span>            : &quot;   AND (d.datistemplate OR pg_catalog.pg_has_role(d.datdba, 'USAGE'))&quot;
<span class="lineNum">     658 </span>            : 
<span class="lineNum">     659 </span>            : #define Query_for_list_of_databases \
<span class="lineNum">     660 </span>            : &quot;SELECT pg_catalog.quote_ident(datname) FROM pg_catalog.pg_database &quot;\
<span class="lineNum">     661 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(datname),1,%d)='%s'&quot;
<span class="lineNum">     662 </span>            : 
<span class="lineNum">     663 </span>            : #define Query_for_list_of_tablespaces \
<span class="lineNum">     664 </span>            : &quot;SELECT pg_catalog.quote_ident(spcname) FROM pg_catalog.pg_tablespace &quot;\
<span class="lineNum">     665 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(spcname),1,%d)='%s'&quot;
<span class="lineNum">     666 </span>            : 
<span class="lineNum">     667 </span>            : #define Query_for_list_of_encodings \
<span class="lineNum">     668 </span>            : &quot; SELECT DISTINCT pg_catalog.pg_encoding_to_char(conforencoding) &quot;\
<span class="lineNum">     669 </span>            : &quot;   FROM pg_catalog.pg_conversion &quot;\
<span class="lineNum">     670 </span>            : &quot;  WHERE substring(pg_catalog.pg_encoding_to_char(conforencoding),1,%d)=UPPER('%s')&quot;
<span class="lineNum">     671 </span>            : 
<span class="lineNum">     672 </span>            : #define Query_for_list_of_languages \
<span class="lineNum">     673 </span>            : &quot;SELECT pg_catalog.quote_ident(lanname) &quot;\
<span class="lineNum">     674 </span>            : &quot;  FROM pg_catalog.pg_language &quot;\
<span class="lineNum">     675 </span>            : &quot; WHERE lanname != 'internal' &quot;\
<span class="lineNum">     676 </span>            : &quot;   AND substring(pg_catalog.quote_ident(lanname),1,%d)='%s'&quot;
<span class="lineNum">     677 </span>            : 
<span class="lineNum">     678 </span>            : #define Query_for_list_of_schemas \
<span class="lineNum">     679 </span>            : &quot;SELECT pg_catalog.quote_ident(nspname) FROM pg_catalog.pg_namespace &quot;\
<span class="lineNum">     680 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(nspname),1,%d)='%s'&quot;
<span class="lineNum">     681 </span>            : 
<span class="lineNum">     682 </span>            : #define Query_for_list_of_alter_system_set_vars \
<span class="lineNum">     683 </span>            : &quot;SELECT name FROM &quot;\
<span class="lineNum">     684 </span>            : &quot; (SELECT pg_catalog.lower(name) AS name FROM pg_catalog.pg_settings &quot;\
<span class="lineNum">     685 </span>            : &quot;  WHERE context != 'internal' &quot;\
<span class="lineNum">     686 </span>            : &quot;  UNION ALL SELECT 'all') ss &quot;\
<span class="lineNum">     687 </span>            : &quot; WHERE substring(name,1,%d)='%s'&quot;
<span class="lineNum">     688 </span>            : 
<span class="lineNum">     689 </span>            : #define Query_for_list_of_set_vars \
<span class="lineNum">     690 </span>            : &quot;SELECT name FROM &quot;\
<span class="lineNum">     691 </span>            : &quot; (SELECT pg_catalog.lower(name) AS name FROM pg_catalog.pg_settings &quot;\
<span class="lineNum">     692 </span>            : &quot;  WHERE context IN ('user', 'superuser') &quot;\
<span class="lineNum">     693 </span>            : &quot;  UNION ALL SELECT 'constraints' &quot;\
<span class="lineNum">     694 </span>            : &quot;  UNION ALL SELECT 'transaction' &quot;\
<span class="lineNum">     695 </span>            : &quot;  UNION ALL SELECT 'session' &quot;\
<span class="lineNum">     696 </span>            : &quot;  UNION ALL SELECT 'role' &quot;\
<span class="lineNum">     697 </span>            : &quot;  UNION ALL SELECT 'tablespace' &quot;\
<span class="lineNum">     698 </span>            : &quot;  UNION ALL SELECT 'all') ss &quot;\
<span class="lineNum">     699 </span>            : &quot; WHERE substring(name,1,%d)='%s'&quot;
<span class="lineNum">     700 </span>            : 
<span class="lineNum">     701 </span>            : #define Query_for_list_of_show_vars \
<span class="lineNum">     702 </span>            : &quot;SELECT name FROM &quot;\
<span class="lineNum">     703 </span>            : &quot; (SELECT pg_catalog.lower(name) AS name FROM pg_catalog.pg_settings &quot;\
<span class="lineNum">     704 </span>            : &quot;  UNION ALL SELECT 'session authorization' &quot;\
<span class="lineNum">     705 </span>            : &quot;  UNION ALL SELECT 'all') ss &quot;\
<span class="lineNum">     706 </span>            : &quot; WHERE substring(name,1,%d)='%s'&quot;
<span class="lineNum">     707 </span>            : 
<span class="lineNum">     708 </span>            : #define Query_for_list_of_roles \
<span class="lineNum">     709 </span>            : &quot; SELECT pg_catalog.quote_ident(rolname) &quot;\
<span class="lineNum">     710 </span>            : &quot;   FROM pg_catalog.pg_roles &quot;\
<span class="lineNum">     711 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(rolname),1,%d)='%s'&quot;
<span class="lineNum">     712 </span>            : 
<span class="lineNum">     713 </span>            : #define Query_for_list_of_grant_roles \
<span class="lineNum">     714 </span>            : &quot; SELECT pg_catalog.quote_ident(rolname) &quot;\
<span class="lineNum">     715 </span>            : &quot;   FROM pg_catalog.pg_roles &quot;\
<span class="lineNum">     716 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(rolname),1,%d)='%s'&quot;\
<span class="lineNum">     717 </span>            : &quot; UNION ALL SELECT 'PUBLIC'&quot;\
<span class="lineNum">     718 </span>            : &quot; UNION ALL SELECT 'CURRENT_USER'&quot;\
<span class="lineNum">     719 </span>            : &quot; UNION ALL SELECT 'SESSION_USER'&quot;
<span class="lineNum">     720 </span>            : 
<span class="lineNum">     721 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     722 </span>            : #define Query_for_index_of_table \
<span class="lineNum">     723 </span>            : &quot;SELECT pg_catalog.quote_ident(c2.relname) &quot;\
<span class="lineNum">     724 </span>            : &quot;  FROM pg_catalog.pg_class c1, pg_catalog.pg_class c2, pg_catalog.pg_index i&quot;\
<span class="lineNum">     725 </span>            : &quot; WHERE c1.oid=i.indrelid and i.indexrelid=c2.oid&quot;\
<span class="lineNum">     726 </span>            : &quot;       and (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     727 </span>            : &quot;       and pg_catalog.quote_ident(c1.relname)='%s'&quot;\
<span class="lineNum">     728 </span>            : &quot;       and pg_catalog.pg_table_is_visible(c2.oid)&quot;
<span class="lineNum">     729 </span>            : 
<span class="lineNum">     730 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     731 </span>            : #define Query_for_constraint_of_table \
<span class="lineNum">     732 </span>            : &quot;SELECT pg_catalog.quote_ident(conname) &quot;\
<span class="lineNum">     733 </span>            : &quot;  FROM pg_catalog.pg_class c1, pg_catalog.pg_constraint con &quot;\
<span class="lineNum">     734 </span>            : &quot; WHERE c1.oid=conrelid and (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     735 </span>            : &quot;       and pg_catalog.quote_ident(c1.relname)='%s'&quot;\
<span class="lineNum">     736 </span>            : &quot;       and pg_catalog.pg_table_is_visible(c1.oid)&quot;
<span class="lineNum">     737 </span>            : 
<span class="lineNum">     738 </span>            : #define Query_for_all_table_constraints \
<span class="lineNum">     739 </span>            : &quot;SELECT pg_catalog.quote_ident(conname) &quot;\
<span class="lineNum">     740 </span>            : &quot;  FROM pg_catalog.pg_constraint c &quot;\
<span class="lineNum">     741 </span>            : &quot; WHERE c.conrelid &lt;&gt; 0 &quot;
<span class="lineNum">     742 </span>            : 
<span class="lineNum">     743 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     744 </span>            : #define Query_for_constraint_of_type \
<span class="lineNum">     745 </span>            : &quot;SELECT pg_catalog.quote_ident(conname) &quot;\
<span class="lineNum">     746 </span>            : &quot;  FROM pg_catalog.pg_type t, pg_catalog.pg_constraint con &quot;\
<span class="lineNum">     747 </span>            : &quot; WHERE t.oid=contypid and (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     748 </span>            : &quot;       and pg_catalog.quote_ident(t.typname)='%s'&quot;\
<span class="lineNum">     749 </span>            : &quot;       and pg_catalog.pg_type_is_visible(t.oid)&quot;
<span class="lineNum">     750 </span>            : 
<span class="lineNum">     751 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     752 </span>            : #define Query_for_list_of_tables_for_constraint \
<span class="lineNum">     753 </span>            : &quot;SELECT pg_catalog.quote_ident(relname) &quot;\
<span class="lineNum">     754 </span>            : &quot;  FROM pg_catalog.pg_class&quot;\
<span class="lineNum">     755 </span>            : &quot; WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     756 </span>            : &quot;   AND oid IN &quot;\
<span class="lineNum">     757 </span>            : &quot;       (SELECT conrelid FROM pg_catalog.pg_constraint &quot;\
<span class="lineNum">     758 </span>            : &quot;         WHERE pg_catalog.quote_ident(conname)='%s')&quot;
<span class="lineNum">     759 </span>            : 
<span class="lineNum">     760 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     761 </span>            : #define Query_for_rule_of_table \
<span class="lineNum">     762 </span>            : &quot;SELECT pg_catalog.quote_ident(rulename) &quot;\
<span class="lineNum">     763 </span>            : &quot;  FROM pg_catalog.pg_class c1, pg_catalog.pg_rewrite &quot;\
<span class="lineNum">     764 </span>            : &quot; WHERE c1.oid=ev_class and (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     765 </span>            : &quot;       and pg_catalog.quote_ident(c1.relname)='%s'&quot;\
<span class="lineNum">     766 </span>            : &quot;       and pg_catalog.pg_table_is_visible(c1.oid)&quot;
<span class="lineNum">     767 </span>            : 
<span class="lineNum">     768 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     769 </span>            : #define Query_for_list_of_tables_for_rule \
<span class="lineNum">     770 </span>            : &quot;SELECT pg_catalog.quote_ident(relname) &quot;\
<span class="lineNum">     771 </span>            : &quot;  FROM pg_catalog.pg_class&quot;\
<span class="lineNum">     772 </span>            : &quot; WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     773 </span>            : &quot;   AND oid IN &quot;\
<span class="lineNum">     774 </span>            : &quot;       (SELECT ev_class FROM pg_catalog.pg_rewrite &quot;\
<span class="lineNum">     775 </span>            : &quot;         WHERE pg_catalog.quote_ident(rulename)='%s')&quot;
<span class="lineNum">     776 </span>            : 
<span class="lineNum">     777 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     778 </span>            : #define Query_for_trigger_of_table \
<span class="lineNum">     779 </span>            : &quot;SELECT pg_catalog.quote_ident(tgname) &quot;\
<span class="lineNum">     780 </span>            : &quot;  FROM pg_catalog.pg_class c1, pg_catalog.pg_trigger &quot;\
<span class="lineNum">     781 </span>            : &quot; WHERE c1.oid=tgrelid and (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     782 </span>            : &quot;       and pg_catalog.quote_ident(c1.relname)='%s'&quot;\
<span class="lineNum">     783 </span>            : &quot;       and pg_catalog.pg_table_is_visible(c1.oid)&quot;\
<span class="lineNum">     784 </span>            : &quot;       and not tgisinternal&quot;
<span class="lineNum">     785 </span>            : 
<span class="lineNum">     786 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     787 </span>            : #define Query_for_list_of_tables_for_trigger \
<span class="lineNum">     788 </span>            : &quot;SELECT pg_catalog.quote_ident(relname) &quot;\
<span class="lineNum">     789 </span>            : &quot;  FROM pg_catalog.pg_class&quot;\
<span class="lineNum">     790 </span>            : &quot; WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     791 </span>            : &quot;   AND oid IN &quot;\
<span class="lineNum">     792 </span>            : &quot;       (SELECT tgrelid FROM pg_catalog.pg_trigger &quot;\
<span class="lineNum">     793 </span>            : &quot;         WHERE pg_catalog.quote_ident(tgname)='%s')&quot;
<span class="lineNum">     794 </span>            : 
<span class="lineNum">     795 </span>            : #define Query_for_list_of_ts_configurations \
<span class="lineNum">     796 </span>            : &quot;SELECT pg_catalog.quote_ident(cfgname) FROM pg_catalog.pg_ts_config &quot;\
<span class="lineNum">     797 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(cfgname),1,%d)='%s'&quot;
<span class="lineNum">     798 </span>            : 
<span class="lineNum">     799 </span>            : #define Query_for_list_of_ts_dictionaries \
<span class="lineNum">     800 </span>            : &quot;SELECT pg_catalog.quote_ident(dictname) FROM pg_catalog.pg_ts_dict &quot;\
<span class="lineNum">     801 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(dictname),1,%d)='%s'&quot;
<span class="lineNum">     802 </span>            : 
<span class="lineNum">     803 </span>            : #define Query_for_list_of_ts_parsers \
<span class="lineNum">     804 </span>            : &quot;SELECT pg_catalog.quote_ident(prsname) FROM pg_catalog.pg_ts_parser &quot;\
<span class="lineNum">     805 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(prsname),1,%d)='%s'&quot;
<span class="lineNum">     806 </span>            : 
<span class="lineNum">     807 </span>            : #define Query_for_list_of_ts_templates \
<span class="lineNum">     808 </span>            : &quot;SELECT pg_catalog.quote_ident(tmplname) FROM pg_catalog.pg_ts_template &quot;\
<span class="lineNum">     809 </span>            : &quot; WHERE substring(pg_catalog.quote_ident(tmplname),1,%d)='%s'&quot;
<span class="lineNum">     810 </span>            : 
<span class="lineNum">     811 </span>            : #define Query_for_list_of_fdws \
<span class="lineNum">     812 </span>            : &quot; SELECT pg_catalog.quote_ident(fdwname) &quot;\
<span class="lineNum">     813 </span>            : &quot;   FROM pg_catalog.pg_foreign_data_wrapper &quot;\
<span class="lineNum">     814 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(fdwname),1,%d)='%s'&quot;
<span class="lineNum">     815 </span>            : 
<span class="lineNum">     816 </span>            : #define Query_for_list_of_servers \
<span class="lineNum">     817 </span>            : &quot; SELECT pg_catalog.quote_ident(srvname) &quot;\
<span class="lineNum">     818 </span>            : &quot;   FROM pg_catalog.pg_foreign_server &quot;\
<span class="lineNum">     819 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(srvname),1,%d)='%s'&quot;
<span class="lineNum">     820 </span>            : 
<span class="lineNum">     821 </span>            : #define Query_for_list_of_user_mappings \
<span class="lineNum">     822 </span>            : &quot; SELECT pg_catalog.quote_ident(usename) &quot;\
<span class="lineNum">     823 </span>            : &quot;   FROM pg_catalog.pg_user_mappings &quot;\
<span class="lineNum">     824 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(usename),1,%d)='%s'&quot;
<span class="lineNum">     825 </span>            : 
<span class="lineNum">     826 </span>            : #define Query_for_list_of_access_methods \
<span class="lineNum">     827 </span>            : &quot; SELECT pg_catalog.quote_ident(amname) &quot;\
<span class="lineNum">     828 </span>            : &quot;   FROM pg_catalog.pg_am &quot;\
<span class="lineNum">     829 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(amname),1,%d)='%s'&quot;
<span class="lineNum">     830 </span>            : 
<span class="lineNum">     831 </span>            : #define Query_for_list_of_index_access_methods \
<span class="lineNum">     832 </span>            : &quot; SELECT pg_catalog.quote_ident(amname) &quot;\
<span class="lineNum">     833 </span>            : &quot;   FROM pg_catalog.pg_am &quot;\
<span class="lineNum">     834 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(amname),1,%d)='%s' AND &quot;\
<span class="lineNum">     835 </span>            : &quot;   amtype=&quot; CppAsString2(AMTYPE_INDEX)
<span class="lineNum">     836 </span>            : 
<span class="lineNum">     837 </span>            : #define Query_for_list_of_table_access_methods \
<span class="lineNum">     838 </span>            : &quot; SELECT pg_catalog.quote_ident(amname) &quot;\
<span class="lineNum">     839 </span>            : &quot;   FROM pg_catalog.pg_am &quot;\
<span class="lineNum">     840 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(amname),1,%d)='%s' AND &quot;\
<span class="lineNum">     841 </span>            : &quot;   amtype=&quot; CppAsString2(AMTYPE_TABLE)
<span class="lineNum">     842 </span>            : 
<span class="lineNum">     843 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     844 </span>            : #define Query_for_list_of_arguments \
<span class="lineNum">     845 </span>            : &quot;SELECT pg_catalog.oidvectortypes(proargtypes)||')' &quot;\
<span class="lineNum">     846 </span>            : &quot;  FROM pg_catalog.pg_proc &quot;\
<span class="lineNum">     847 </span>            : &quot; WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     848 </span>            : &quot;   AND (pg_catalog.quote_ident(proname)='%s'&quot;\
<span class="lineNum">     849 </span>            : &quot;        OR '\&quot;' || proname || '\&quot;'='%s') &quot;\
<span class="lineNum">     850 </span>            : &quot;   AND (pg_catalog.pg_function_is_visible(pg_proc.oid))&quot;
<span class="lineNum">     851 </span>            : 
<span class="lineNum">     852 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     853 </span>            : #define Query_for_list_of_arguments_with_schema \
<span class="lineNum">     854 </span>            : &quot;SELECT pg_catalog.oidvectortypes(proargtypes)||')' &quot;\
<span class="lineNum">     855 </span>            : &quot;  FROM pg_catalog.pg_proc p, pg_catalog.pg_namespace n &quot;\
<span class="lineNum">     856 </span>            : &quot; WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     857 </span>            : &quot;   AND n.oid = p.pronamespace &quot;\
<span class="lineNum">     858 </span>            : &quot;   AND (pg_catalog.quote_ident(proname)='%s' &quot;\
<span class="lineNum">     859 </span>            : &quot;        OR '\&quot;' || proname || '\&quot;' ='%s') &quot;\
<span class="lineNum">     860 </span>            : &quot;   AND (pg_catalog.quote_ident(nspname)='%s' &quot;\
<span class="lineNum">     861 </span>            : &quot;        OR '\&quot;' || nspname || '\&quot;' ='%s') &quot;
<span class="lineNum">     862 </span>            : 
<span class="lineNum">     863 </span>            : #define Query_for_list_of_extensions \
<span class="lineNum">     864 </span>            : &quot; SELECT pg_catalog.quote_ident(extname) &quot;\
<span class="lineNum">     865 </span>            : &quot;   FROM pg_catalog.pg_extension &quot;\
<span class="lineNum">     866 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(extname),1,%d)='%s'&quot;
<span class="lineNum">     867 </span>            : 
<span class="lineNum">     868 </span>            : #define Query_for_list_of_available_extensions \
<span class="lineNum">     869 </span>            : &quot; SELECT pg_catalog.quote_ident(name) &quot;\
<span class="lineNum">     870 </span>            : &quot;   FROM pg_catalog.pg_available_extensions &quot;\
<span class="lineNum">     871 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(name),1,%d)='%s' AND installed_version IS NULL&quot;
<span class="lineNum">     872 </span>            : 
<span class="lineNum">     873 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     874 </span>            : #define Query_for_list_of_available_extension_versions \
<span class="lineNum">     875 </span>            : &quot; SELECT pg_catalog.quote_ident(version) &quot;\
<span class="lineNum">     876 </span>            : &quot;   FROM pg_catalog.pg_available_extension_versions &quot;\
<span class="lineNum">     877 </span>            : &quot;  WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     878 </span>            : &quot;    AND pg_catalog.quote_ident(name)='%s'&quot;
<span class="lineNum">     879 </span>            : 
<span class="lineNum">     880 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     881 </span>            : #define Query_for_list_of_available_extension_versions_with_TO \
<span class="lineNum">     882 </span>            : &quot; SELECT 'TO ' || pg_catalog.quote_ident(version) &quot;\
<span class="lineNum">     883 </span>            : &quot;   FROM pg_catalog.pg_available_extension_versions &quot;\
<span class="lineNum">     884 </span>            : &quot;  WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     885 </span>            : &quot;    AND pg_catalog.quote_ident(name)='%s'&quot;
<span class="lineNum">     886 </span>            : 
<span class="lineNum">     887 </span>            : #define Query_for_list_of_prepared_statements \
<span class="lineNum">     888 </span>            : &quot; SELECT pg_catalog.quote_ident(name) &quot;\
<span class="lineNum">     889 </span>            : &quot;   FROM pg_catalog.pg_prepared_statements &quot;\
<span class="lineNum">     890 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(name),1,%d)='%s'&quot;
<span class="lineNum">     891 </span>            : 
<span class="lineNum">     892 </span>            : #define Query_for_list_of_event_triggers \
<span class="lineNum">     893 </span>            : &quot; SELECT pg_catalog.quote_ident(evtname) &quot;\
<span class="lineNum">     894 </span>            : &quot;   FROM pg_catalog.pg_event_trigger &quot;\
<span class="lineNum">     895 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(evtname),1,%d)='%s'&quot;
<span class="lineNum">     896 </span>            : 
<span class="lineNum">     897 </span>            : #define Query_for_list_of_tablesample_methods \
<span class="lineNum">     898 </span>            : &quot; SELECT pg_catalog.quote_ident(proname) &quot;\
<span class="lineNum">     899 </span>            : &quot;   FROM pg_catalog.pg_proc &quot;\
<span class="lineNum">     900 </span>            : &quot;  WHERE prorettype = 'pg_catalog.tsm_handler'::pg_catalog.regtype AND &quot;\
<span class="lineNum">     901 </span>            : &quot;        proargtypes[0] = 'pg_catalog.internal'::pg_catalog.regtype AND &quot;\
<span class="lineNum">     902 </span>            : &quot;        substring(pg_catalog.quote_ident(proname),1,%d)='%s'&quot;
<span class="lineNum">     903 </span>            : 
<span class="lineNum">     904 </span>            : #define Query_for_list_of_policies \
<span class="lineNum">     905 </span>            : &quot; SELECT pg_catalog.quote_ident(polname) &quot;\
<span class="lineNum">     906 </span>            : &quot;   FROM pg_catalog.pg_policy &quot;\
<span class="lineNum">     907 </span>            : &quot;  WHERE substring(pg_catalog.quote_ident(polname),1,%d)='%s'&quot;
<span class="lineNum">     908 </span>            : 
<span class="lineNum">     909 </span>            : #define Query_for_list_of_tables_for_policy \
<span class="lineNum">     910 </span>            : &quot;SELECT pg_catalog.quote_ident(relname) &quot;\
<span class="lineNum">     911 </span>            : &quot;  FROM pg_catalog.pg_class&quot;\
<span class="lineNum">     912 </span>            : &quot; WHERE (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     913 </span>            : &quot;   AND oid IN &quot;\
<span class="lineNum">     914 </span>            : &quot;       (SELECT polrelid FROM pg_catalog.pg_policy &quot;\
<span class="lineNum">     915 </span>            : &quot;         WHERE pg_catalog.quote_ident(polname)='%s')&quot;
<span class="lineNum">     916 </span>            : 
<span class="lineNum">     917 </span>            : #define Query_for_enum \
<span class="lineNum">     918 </span>            : &quot; SELECT name FROM ( &quot;\
<span class="lineNum">     919 </span>            : &quot;   SELECT pg_catalog.quote_ident(pg_catalog.unnest(enumvals)) AS name &quot;\
<span class="lineNum">     920 </span>            : &quot;     FROM pg_catalog.pg_settings &quot;\
<span class="lineNum">     921 </span>            : &quot;    WHERE pg_catalog.lower(name)=pg_catalog.lower('%s') &quot;\
<span class="lineNum">     922 </span>            : &quot;    UNION ALL &quot; \
<span class="lineNum">     923 </span>            : &quot;   SELECT 'DEFAULT' ) ss &quot;\
<span class="lineNum">     924 </span>            : &quot;  WHERE pg_catalog.substring(name,1,%%d)='%%s'&quot;
<span class="lineNum">     925 </span>            : 
<span class="lineNum">     926 </span>            : /* the silly-looking length condition is just to eat up the current word */
<span class="lineNum">     927 </span>            : #define Query_for_partition_of_table \
<span class="lineNum">     928 </span>            : &quot;SELECT pg_catalog.quote_ident(c2.relname) &quot;\
<span class="lineNum">     929 </span>            : &quot;  FROM pg_catalog.pg_class c1, pg_catalog.pg_class c2, pg_catalog.pg_inherits i&quot;\
<span class="lineNum">     930 </span>            : &quot; WHERE c1.oid=i.inhparent and i.inhrelid=c2.oid&quot;\
<span class="lineNum">     931 </span>            : &quot;       and (%d = pg_catalog.length('%s'))&quot;\
<span class="lineNum">     932 </span>            : &quot;       and pg_catalog.quote_ident(c1.relname)='%s'&quot;\
<span class="lineNum">     933 </span>            : &quot;       and pg_catalog.pg_table_is_visible(c2.oid)&quot;\
<span class="lineNum">     934 </span>            : &quot;       and c2.relispartition = 'true'&quot;
<span class="lineNum">     935 </span>            : 
<span class="lineNum">     936 </span>            : /*
<span class="lineNum">     937 </span>            :  * These object types were introduced later than our support cutoff of
<span class="lineNum">     938 </span>            :  * server version 7.4.  We use the VersionedQuery infrastructure so that
<span class="lineNum">     939 </span>            :  * we don't send certain-to-fail queries to older servers.
<span class="lineNum">     940 </span>            :  */
<span class="lineNum">     941 </span>            : 
<span class="lineNum">     942 </span>            : static const VersionedQuery Query_for_list_of_publications[] = {
<span class="lineNum">     943 </span>            :     {100000,
<span class="lineNum">     944 </span>            :         &quot; SELECT pg_catalog.quote_ident(pubname) &quot;
<span class="lineNum">     945 </span>            :         &quot;   FROM pg_catalog.pg_publication &quot;
<span class="lineNum">     946 </span>            :         &quot;  WHERE substring(pg_catalog.quote_ident(pubname),1,%d)='%s'&quot;
<span class="lineNum">     947 </span>            :     },
<span class="lineNum">     948 </span>            :     {0, NULL}
<span class="lineNum">     949 </span>            : };
<span class="lineNum">     950 </span>            : 
<span class="lineNum">     951 </span>            : static const VersionedQuery Query_for_list_of_subscriptions[] = {
<span class="lineNum">     952 </span>            :     {100000,
<span class="lineNum">     953 </span>            :         &quot; SELECT pg_catalog.quote_ident(s.subname) &quot;
<span class="lineNum">     954 </span>            :         &quot;   FROM pg_catalog.pg_subscription s, pg_catalog.pg_database d &quot;
<span class="lineNum">     955 </span>            :         &quot;  WHERE substring(pg_catalog.quote_ident(s.subname),1,%d)='%s' &quot;
<span class="lineNum">     956 </span>            :         &quot;    AND d.datname = pg_catalog.current_database() &quot;
<span class="lineNum">     957 </span>            :         &quot;    AND s.subdbid = d.oid&quot;
<span class="lineNum">     958 </span>            :     },
<span class="lineNum">     959 </span>            :     {0, NULL}
<span class="lineNum">     960 </span>            : };
<span class="lineNum">     961 </span>            : 
<span class="lineNum">     962 </span>            : /*
<span class="lineNum">     963 </span>            :  * This is a list of all &quot;things&quot; in Pgsql, which can show up after CREATE or
<span class="lineNum">     964 </span>            :  * DROP; and there is also a query to get a list of them.
<span class="lineNum">     965 </span>            :  */
<span class="lineNum">     966 </span>            : 
<span class="lineNum">     967 </span>            : typedef struct
<span class="lineNum">     968 </span>            : {
<span class="lineNum">     969 </span>            :     const char *name;
<span class="lineNum">     970 </span>            :     const char *query;          /* simple query, or NULL */
<span class="lineNum">     971 </span>            :     const VersionedQuery *vquery;   /* versioned query, or NULL */
<span class="lineNum">     972 </span>            :     const SchemaQuery *squery;  /* schema query, or NULL */
<span class="lineNum">     973 </span>            :     const bits32 flags;         /* visibility flags, see below */
<span class="lineNum">     974 </span>            : } pgsql_thing_t;
<span class="lineNum">     975 </span>            : 
<span class="lineNum">     976 </span>            : #define THING_NO_CREATE     (1 &lt;&lt; 0)  /* should not show up after CREATE */
<span class="lineNum">     977 </span>            : #define THING_NO_DROP       (1 &lt;&lt; 1)  /* should not show up after DROP */
<span class="lineNum">     978 </span>            : #define THING_NO_ALTER      (1 &lt;&lt; 2)  /* should not show up after ALTER */
<span class="lineNum">     979 </span>            : #define THING_NO_SHOW       (THING_NO_CREATE | THING_NO_DROP | THING_NO_ALTER)
<span class="lineNum">     980 </span>            : 
<span class="lineNum">     981 </span>            : static const pgsql_thing_t words_after_create[] = {
<span class="lineNum">     982 </span>            :     {&quot;ACCESS METHOD&quot;, NULL, NULL, NULL, THING_NO_ALTER},
<span class="lineNum">     983 </span>            :     {&quot;AGGREGATE&quot;, NULL, NULL, Query_for_list_of_aggregates},
<span class="lineNum">     984 </span>            :     {&quot;CAST&quot;, NULL, NULL, NULL}, /* Casts have complex structures for names, so
<span class="lineNum">     985 </span>            :                                  * skip it */
<span class="lineNum">     986 </span>            :     {&quot;COLLATION&quot;, &quot;SELECT pg_catalog.quote_ident(collname) FROM pg_catalog.pg_collation WHERE collencoding IN (-1, pg_catalog.pg_char_to_encoding(pg_catalog.getdatabaseencoding())) AND substring(pg_catalog.quote_ident(collname),1,%d)='%s'&quot;},
<span class="lineNum">     987 </span>            : 
<span class="lineNum">     988 </span>            :     /*
<span class="lineNum">     989 </span>            :      * CREATE CONSTRAINT TRIGGER is not supported here because it is designed
<span class="lineNum">     990 </span>            :      * to be used only by pg_dump.
<span class="lineNum">     991 </span>            :      */
<span class="lineNum">     992 </span>            :     {&quot;CONFIGURATION&quot;, Query_for_list_of_ts_configurations, NULL, NULL, THING_NO_SHOW},
<span class="lineNum">     993 </span>            :     {&quot;CONVERSION&quot;, &quot;SELECT pg_catalog.quote_ident(conname) FROM pg_catalog.pg_conversion WHERE substring(pg_catalog.quote_ident(conname),1,%d)='%s'&quot;},
<span class="lineNum">     994 </span>            :     {&quot;DATABASE&quot;, Query_for_list_of_databases},
<span class="lineNum">     995 </span>            :     {&quot;DEFAULT PRIVILEGES&quot;, NULL, NULL, NULL, THING_NO_CREATE | THING_NO_DROP},
<span class="lineNum">     996 </span>            :     {&quot;DICTIONARY&quot;, Query_for_list_of_ts_dictionaries, NULL, NULL, THING_NO_SHOW},
<span class="lineNum">     997 </span>            :     {&quot;DOMAIN&quot;, NULL, NULL, &amp;Query_for_list_of_domains},
<span class="lineNum">     998 </span>            :     {&quot;EVENT TRIGGER&quot;, NULL, NULL, NULL},
<span class="lineNum">     999 </span>            :     {&quot;EXTENSION&quot;, Query_for_list_of_extensions},
<span class="lineNum">    1000 </span>            :     {&quot;FOREIGN DATA WRAPPER&quot;, NULL, NULL, NULL},
<span class="lineNum">    1001 </span>            :     {&quot;FOREIGN TABLE&quot;, NULL, NULL, NULL},
<span class="lineNum">    1002 </span>            :     {&quot;FUNCTION&quot;, NULL, NULL, Query_for_list_of_functions},
<span class="lineNum">    1003 </span>            :     {&quot;GROUP&quot;, Query_for_list_of_roles},
<span class="lineNum">    1004 </span>            :     {&quot;INCREMENTAL MATERIALIZED VIEW&quot;, NULL, NULL, &amp;Query_for_list_of_matviews},
<span class="lineNum">    1005 </span>            :     {&quot;INDEX&quot;, NULL, NULL, &amp;Query_for_list_of_indexes},
<span class="lineNum">    1006 </span>            :     {&quot;LANGUAGE&quot;, Query_for_list_of_languages},
<span class="lineNum">    1007 </span>            :     {&quot;LARGE OBJECT&quot;, NULL, NULL, NULL, THING_NO_CREATE | THING_NO_DROP},
<span class="lineNum">    1008 </span>            :     {&quot;MATERIALIZED VIEW&quot;, NULL, NULL, &amp;Query_for_list_of_matviews},
<span class="lineNum">    1009 </span>            :     {&quot;OPERATOR&quot;, NULL, NULL, NULL}, /* Querying for this is probably not such
<span class="lineNum">    1010 </span>            :                                      * a good idea. */
<span class="lineNum">    1011 </span>            :     {&quot;OR REPLACE&quot;, NULL, NULL, NULL, THING_NO_DROP | THING_NO_ALTER},
<span class="lineNum">    1012 </span>            :     {&quot;OWNED&quot;, NULL, NULL, NULL, THING_NO_CREATE | THING_NO_ALTER},    /* for DROP OWNED BY ... */
<span class="lineNum">    1013 </span>            :     {&quot;PARSER&quot;, Query_for_list_of_ts_parsers, NULL, NULL, THING_NO_SHOW},
<span class="lineNum">    1014 </span>            :     {&quot;POLICY&quot;, NULL, NULL, NULL},
<span class="lineNum">    1015 </span>            :     {&quot;PROCEDURE&quot;, NULL, NULL, Query_for_list_of_procedures},
<span class="lineNum">    1016 </span>            :     {&quot;PUBLICATION&quot;, NULL, Query_for_list_of_publications},
<span class="lineNum">    1017 </span>            :     {&quot;ROLE&quot;, Query_for_list_of_roles},
<span class="lineNum">    1018 </span>            :     {&quot;ROUTINE&quot;, NULL, NULL, &amp;Query_for_list_of_routines, THING_NO_CREATE},
<span class="lineNum">    1019 </span>            :     {&quot;RULE&quot;, &quot;SELECT pg_catalog.quote_ident(rulename) FROM pg_catalog.pg_rules WHERE substring(pg_catalog.quote_ident(rulename),1,%d)='%s'&quot;},
<span class="lineNum">    1020 </span>            :     {&quot;SCHEMA&quot;, Query_for_list_of_schemas},
<span class="lineNum">    1021 </span>            :     {&quot;SEQUENCE&quot;, NULL, NULL, &amp;Query_for_list_of_sequences},
<span class="lineNum">    1022 </span>            :     {&quot;SERVER&quot;, Query_for_list_of_servers},
<span class="lineNum">    1023 </span>            :     {&quot;STATISTICS&quot;, NULL, NULL, &amp;Query_for_list_of_statistics},
<span class="lineNum">    1024 </span>            :     {&quot;SUBSCRIPTION&quot;, NULL, Query_for_list_of_subscriptions},
<span class="lineNum">    1025 </span>            :     {&quot;SYSTEM&quot;, NULL, NULL, NULL, THING_NO_CREATE | THING_NO_DROP},
<span class="lineNum">    1026 </span>            :     {&quot;TABLE&quot;, NULL, NULL, &amp;Query_for_list_of_tables},
<span class="lineNum">    1027 </span>            :     {&quot;TABLESPACE&quot;, Query_for_list_of_tablespaces},
<span class="lineNum">    1028 </span>            :     {&quot;TEMP&quot;, NULL, NULL, NULL, THING_NO_DROP | THING_NO_ALTER}, /* for CREATE TEMP TABLE
<span class="lineNum">    1029 </span>            :                                                                  * ... */
<span class="lineNum">    1030 </span>            :     {&quot;TEMPLATE&quot;, Query_for_list_of_ts_templates, NULL, NULL, THING_NO_SHOW},
<span class="lineNum">    1031 </span>            :     {&quot;TEMPORARY&quot;, NULL, NULL, NULL, THING_NO_DROP | THING_NO_ALTER},  /* for CREATE TEMPORARY
<span class="lineNum">    1032 </span>            :                                                                          * TABLE ... */
<span class="lineNum">    1033 </span>            :     {&quot;TEXT SEARCH&quot;, NULL, NULL, NULL},
<span class="lineNum">    1034 </span>            :     {&quot;TRANSFORM&quot;, NULL, NULL, NULL},
<span class="lineNum">    1035 </span>            :     {&quot;TRIGGER&quot;, &quot;SELECT pg_catalog.quote_ident(tgname) FROM pg_catalog.pg_trigger WHERE substring(pg_catalog.quote_ident(tgname),1,%d)='%s' AND NOT tgisinternal&quot;},
<span class="lineNum">    1036 </span>            :     {&quot;TYPE&quot;, NULL, NULL, &amp;Query_for_list_of_datatypes},
<span class="lineNum">    1037 </span>            :     {&quot;UNIQUE&quot;, NULL, NULL, NULL, THING_NO_DROP | THING_NO_ALTER}, /* for CREATE UNIQUE
<span class="lineNum">    1038 </span>            :                                                                      * INDEX ... */
<span class="lineNum">    1039 </span>            :     {&quot;UNLOGGED&quot;, NULL, NULL, NULL, THING_NO_DROP | THING_NO_ALTER}, /* for CREATE UNLOGGED
<span class="lineNum">    1040 </span>            :                                                                      * TABLE ... */
<span class="lineNum">    1041 </span>            :     {&quot;USER&quot;, Query_for_list_of_roles &quot; UNION SELECT 'MAPPING FOR'&quot;},
<span class="lineNum">    1042 </span>            :     {&quot;USER MAPPING FOR&quot;, NULL, NULL, NULL},
<span class="lineNum">    1043 </span>            :     {&quot;VIEW&quot;, NULL, NULL, &amp;Query_for_list_of_views},
<span class="lineNum">    1044 </span>            :     {NULL}                      /* end of list */
<span class="lineNum">    1045 </span>            : };
<span class="lineNum">    1046 </span>            : 
<span class="lineNum">    1047 </span>            : /* Storage parameters for CREATE TABLE and ALTER TABLE */
<span class="lineNum">    1048 </span>            : static const char *const table_storage_parameters[] = {
<span class="lineNum">    1049 </span>            :     &quot;autovacuum_analyze_scale_factor&quot;,
<span class="lineNum">    1050 </span>            :     &quot;autovacuum_analyze_threshold&quot;,
<span class="lineNum">    1051 </span>            :     &quot;autovacuum_enabled&quot;,
<span class="lineNum">    1052 </span>            :     &quot;autovacuum_freeze_max_age&quot;,
<span class="lineNum">    1053 </span>            :     &quot;autovacuum_freeze_min_age&quot;,
<span class="lineNum">    1054 </span>            :     &quot;autovacuum_freeze_table_age&quot;,
<span class="lineNum">    1055 </span>            :     &quot;autovacuum_multixact_freeze_max_age&quot;,
<span class="lineNum">    1056 </span>            :     &quot;autovacuum_multixact_freeze_min_age&quot;,
<span class="lineNum">    1057 </span>            :     &quot;autovacuum_multixact_freeze_table_age&quot;,
<span class="lineNum">    1058 </span>            :     &quot;autovacuum_vacuum_cost_delay&quot;,
<span class="lineNum">    1059 </span>            :     &quot;autovacuum_vacuum_cost_limit&quot;,
<span class="lineNum">    1060 </span>            :     &quot;autovacuum_vacuum_scale_factor&quot;,
<span class="lineNum">    1061 </span>            :     &quot;autovacuum_vacuum_threshold&quot;,
<span class="lineNum">    1062 </span>            :     &quot;fillfactor&quot;,
<span class="lineNum">    1063 </span>            :     &quot;log_autovacuum_min_duration&quot;,
<span class="lineNum">    1064 </span>            :     &quot;parallel_workers&quot;,
<span class="lineNum">    1065 </span>            :     &quot;toast.autovacuum_enabled&quot;,
<span class="lineNum">    1066 </span>            :     &quot;toast.autovacuum_freeze_max_age&quot;,
<span class="lineNum">    1067 </span>            :     &quot;toast.autovacuum_freeze_min_age&quot;,
<span class="lineNum">    1068 </span>            :     &quot;toast.autovacuum_freeze_table_age&quot;,
<span class="lineNum">    1069 </span>            :     &quot;toast.autovacuum_multixact_freeze_max_age&quot;,
<span class="lineNum">    1070 </span>            :     &quot;toast.autovacuum_multixact_freeze_min_age&quot;,
<span class="lineNum">    1071 </span>            :     &quot;toast.autovacuum_multixact_freeze_table_age&quot;,
<span class="lineNum">    1072 </span>            :     &quot;toast.autovacuum_vacuum_cost_delay&quot;,
<span class="lineNum">    1073 </span>            :     &quot;toast.autovacuum_vacuum_cost_limit&quot;,
<span class="lineNum">    1074 </span>            :     &quot;toast.autovacuum_vacuum_scale_factor&quot;,
<span class="lineNum">    1075 </span>            :     &quot;toast.autovacuum_vacuum_threshold&quot;,
<span class="lineNum">    1076 </span>            :     &quot;toast.log_autovacuum_min_duration&quot;,
<span class="lineNum">    1077 </span>            :     &quot;toast.vacuum_index_cleanup&quot;,
<span class="lineNum">    1078 </span>            :     &quot;toast.vacuum_truncate&quot;,
<span class="lineNum">    1079 </span>            :     &quot;toast_tuple_target&quot;,
<span class="lineNum">    1080 </span>            :     &quot;user_catalog_table&quot;,
<span class="lineNum">    1081 </span>            :     &quot;vacuum_index_cleanup&quot;,
<span class="lineNum">    1082 </span>            :     &quot;vacuum_truncate&quot;,
<span class="lineNum">    1083 </span>            :     NULL
<span class="lineNum">    1084 </span>            : };
<span class="lineNum">    1085 </span>            : 
<span class="lineNum">    1086 </span>            : 
<span class="lineNum">    1087 </span>            : /* Forward declaration of functions */
<span class="lineNum">    1088 </span>            : static char **psql_completion(const char *text, int start, int end);
<span class="lineNum">    1089 </span>            : static char *create_command_generator(const char *text, int state);
<span class="lineNum">    1090 </span>            : static char *drop_command_generator(const char *text, int state);
<span class="lineNum">    1091 </span>            : static char *alter_command_generator(const char *text, int state);
<span class="lineNum">    1092 </span>            : static char *complete_from_query(const char *text, int state);
<span class="lineNum">    1093 </span>            : static char *complete_from_versioned_query(const char *text, int state);
<span class="lineNum">    1094 </span>            : static char *complete_from_schema_query(const char *text, int state);
<span class="lineNum">    1095 </span>            : static char *complete_from_versioned_schema_query(const char *text, int state);
<span class="lineNum">    1096 </span>            : static char *_complete_from_query(const char *simple_query,
<span class="lineNum">    1097 </span>            :                                   const SchemaQuery *schema_query,
<span class="lineNum">    1098 </span>            :                                   const char *text, int state);
<span class="lineNum">    1099 </span>            : static char *complete_from_list(const char *text, int state);
<span class="lineNum">    1100 </span>            : static char *complete_from_const(const char *text, int state);
<span class="lineNum">    1101 </span>            : static void append_variable_names(char ***varnames, int *nvars,
<span class="lineNum">    1102 </span>            :                                   int *maxvars, const char *varname,
<span class="lineNum">    1103 </span>            :                                   const char *prefix, const char *suffix);
<span class="lineNum">    1104 </span>            : static char **complete_from_variables(const char *text,
<span class="lineNum">    1105 </span>            :                                       const char *prefix, const char *suffix, bool need_value);
<span class="lineNum">    1106 </span>            : static char *complete_from_files(const char *text, int state);
<span class="lineNum">    1107 </span>            : 
<span class="lineNum">    1108 </span>            : static char *pg_strdup_keyword_case(const char *s, const char *ref);
<span class="lineNum">    1109 </span>            : static char *escape_string(const char *text);
<span class="lineNum">    1110 </span>            : static PGresult *exec_query(const char *query);
<span class="lineNum">    1111 </span>            : 
<span class="lineNum">    1112 </span>            : static char **get_previous_words(int point, char **buffer, int *nwords);
<span class="lineNum">    1113 </span>            : 
<span class="lineNum">    1114 </span>            : static char *get_guctype(const char *varname);
<span class="lineNum">    1115 </span>            : 
<span class="lineNum">    1116 </span>            : #ifdef NOT_USED
<span class="lineNum">    1117 </span>            : static char *quote_file_name(char *text, int match_type, char *quote_pointer);
<span class="lineNum">    1118 </span>            : static char *dequote_file_name(char *text, char quote_char);
<span class="lineNum">    1119 </span>            : #endif
<span class="lineNum">    1120 </span>            : 
<span class="lineNum">    1121 </span>            : 
<span class="lineNum">    1122 </span>            : /*
<span class="lineNum">    1123 </span>            :  * Initialize the readline library for our purposes.
<a name="1124"><span class="lineNum">    1124 </span>            :  */</a>
<span class="lineNum">    1125 </span>            : void
<span class="lineNum">    1126 </span><span class="lineNoCov">          0 : initialize_readline(void)</span>
<span class="lineNum">    1127 </span>            : {
<span class="lineNum">    1128 </span><span class="lineNoCov">          0 :     rl_readline_name = (char *) pset.progname;</span>
<span class="lineNum">    1129 </span><span class="lineNoCov">          0 :     rl_attempted_completion_function = psql_completion;</span>
<span class="lineNum">    1130 </span>            : 
<span class="lineNum">    1131 </span><span class="lineNoCov">          0 :     rl_basic_word_break_characters = WORD_BREAKS;</span>
<span class="lineNum">    1132 </span>            : 
<span class="lineNum">    1133 </span><span class="lineNoCov">          0 :     completion_max_records = 1000;</span>
<span class="lineNum">    1134 </span>            : 
<span class="lineNum">    1135 </span>            :     /*
<span class="lineNum">    1136 </span>            :      * There is a variable rl_completion_query_items for this but apparently
<span class="lineNum">    1137 </span>            :      * it's not defined everywhere.
<span class="lineNum">    1138 </span>            :      */
<span class="lineNum">    1139 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    1140 </span>            : 
<span class="lineNum">    1141 </span>            : /*
<span class="lineNum">    1142 </span>            :  * Check if 'word' matches any of the '|'-separated strings in 'pattern',
<span class="lineNum">    1143 </span>            :  * using case-insensitive or case-sensitive comparisons.
<span class="lineNum">    1144 </span>            :  *
<span class="lineNum">    1145 </span>            :  * If pattern is NULL, it's a wild card that matches any word.
<span class="lineNum">    1146 </span>            :  * If pattern begins with '!', the result is negated, ie we check that 'word'
<span class="lineNum">    1147 </span>            :  * does *not* match any alternative appearing in the rest of 'pattern'.
<span class="lineNum">    1148 </span>            :  * Any alternative can contain '*' which is a wild card, i.e., it can match
<span class="lineNum">    1149 </span>            :  * any substring; however, we allow at most one '*' per alternative.
<span class="lineNum">    1150 </span>            :  *
<span class="lineNum">    1151 </span>            :  * For readability, callers should use the macros MatchAny and MatchAnyExcept
<span class="lineNum">    1152 </span>            :  * to invoke those two special cases for 'pattern'.  (But '|' and '*' must
<span class="lineNum">    1153 </span>            :  * just be written directly in patterns.)
<span class="lineNum">    1154 </span>            :  */
<span class="lineNum">    1155 </span>            : #define MatchAny  NULL
<span class="lineNum">    1156 </span>            : #define MatchAnyExcept(pattern)  (&quot;!&quot; pattern)
<a name="1157"><span class="lineNum">    1157 </span>            : </a>
<span class="lineNum">    1158 </span>            : static bool
<span class="lineNum">    1159 </span><span class="lineNoCov">          0 : word_matches(const char *pattern,</span>
<span class="lineNum">    1160 </span>            :              const char *word,
<span class="lineNum">    1161 </span>            :              bool case_sensitive)
<span class="lineNum">    1162 </span>            : {
<span class="lineNum">    1163 </span>            :     size_t      wordlen;
<span class="lineNum">    1164 </span>            : 
<span class="lineNum">    1165 </span>            : #define cimatch(s1, s2, n) \
<span class="lineNum">    1166 </span>            :     (case_sensitive ? strncmp(s1, s2, n) == 0 : pg_strncasecmp(s1, s2, n) == 0)
<span class="lineNum">    1167 </span>            : 
<span class="lineNum">    1168 </span>            :     /* NULL pattern matches anything. */
<span class="lineNum">    1169 </span><span class="lineNoCov">          0 :     if (pattern == NULL)</span>
<span class="lineNum">    1170 </span><span class="lineNoCov">          0 :         return true;</span>
<span class="lineNum">    1171 </span>            : 
<span class="lineNum">    1172 </span>            :     /* Handle negated patterns from the MatchAnyExcept macro. */
<span class="lineNum">    1173 </span><span class="lineNoCov">          0 :     if (*pattern == '!')</span>
<span class="lineNum">    1174 </span><span class="lineNoCov">          0 :         return !word_matches(pattern + 1, word, case_sensitive);</span>
<span class="lineNum">    1175 </span>            : 
<span class="lineNum">    1176 </span>            :     /* Else consider each alternative in the pattern. */
<span class="lineNum">    1177 </span><span class="lineNoCov">          0 :     wordlen = strlen(word);</span>
<span class="lineNum">    1178 </span>            :     for (;;)
<span class="lineNum">    1179 </span>            :     {
<span class="lineNum">    1180 </span><span class="lineNoCov">          0 :         const char *star = NULL;</span>
<span class="lineNum">    1181 </span>            :         const char *c;
<span class="lineNum">    1182 </span>            : 
<span class="lineNum">    1183 </span>            :         /* Find end of current alternative, and locate any wild card. */
<span class="lineNum">    1184 </span><span class="lineNoCov">          0 :         c = pattern;</span>
<span class="lineNum">    1185 </span><span class="lineNoCov">          0 :         while (*c != '\0' &amp;&amp; *c != '|')</span>
<span class="lineNum">    1186 </span>            :         {
<span class="lineNum">    1187 </span><span class="lineNoCov">          0 :             if (*c == '*')</span>
<span class="lineNum">    1188 </span><span class="lineNoCov">          0 :                 star = c;</span>
<span class="lineNum">    1189 </span><span class="lineNoCov">          0 :             c++;</span>
<span class="lineNum">    1190 </span>            :         }
<span class="lineNum">    1191 </span>            :         /* Was there a wild card? */
<span class="lineNum">    1192 </span><span class="lineNoCov">          0 :         if (star)</span>
<span class="lineNum">    1193 </span>            :         {
<span class="lineNum">    1194 </span>            :             /* Yes, wildcard match? */
<span class="lineNum">    1195 </span><span class="lineNoCov">          0 :             size_t      beforelen = star - pattern,</span>
<span class="lineNum">    1196 </span><span class="lineNoCov">          0 :                         afterlen = c - star - 1;</span>
<span class="lineNum">    1197 </span>            : 
<span class="lineNum">    1198 </span><span class="lineNoCov">          0 :             if (wordlen &gt;= (beforelen + afterlen) &amp;&amp;</span>
<span class="lineNum">    1199 </span><span class="lineNoCov">          0 :                 cimatch(word, pattern, beforelen) &amp;&amp;</span>
<span class="lineNum">    1200 </span><span class="lineNoCov">          0 :                 cimatch(word + wordlen - afterlen, star + 1, afterlen))</span>
<span class="lineNum">    1201 </span><span class="lineNoCov">          0 :                 return true;</span>
<span class="lineNum">    1202 </span>            :         }
<span class="lineNum">    1203 </span>            :         else
<span class="lineNum">    1204 </span>            :         {
<span class="lineNum">    1205 </span>            :             /* No, plain match? */
<span class="lineNum">    1206 </span><span class="lineNoCov">          0 :             if (wordlen == (c - pattern) &amp;&amp;</span>
<span class="lineNum">    1207 </span><span class="lineNoCov">          0 :                 cimatch(word, pattern, wordlen))</span>
<span class="lineNum">    1208 </span><span class="lineNoCov">          0 :                 return true;</span>
<span class="lineNum">    1209 </span>            :         }
<span class="lineNum">    1210 </span>            :         /* Out of alternatives? */
<span class="lineNum">    1211 </span><span class="lineNoCov">          0 :         if (*c == '\0')</span>
<span class="lineNum">    1212 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    1213 </span>            :         /* Nope, try next alternative. */
<span class="lineNum">    1214 </span><span class="lineNoCov">          0 :         pattern = c + 1;</span>
<span class="lineNum">    1215 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">    1216 </span>            : 
<span class="lineNum">    1217 </span><span class="lineNoCov">          0 :     return false;</span>
<span class="lineNum">    1218 </span>            : }
<span class="lineNum">    1219 </span>            : 
<span class="lineNum">    1220 </span>            : /*
<span class="lineNum">    1221 </span>            :  * Implementation of TailMatches and TailMatchesCS macros: do the last N words
<span class="lineNum">    1222 </span>            :  * in previous_words match the variadic arguments?
<span class="lineNum">    1223 </span>            :  *
<span class="lineNum">    1224 </span>            :  * The array indexing might look backwards, but remember that
<span class="lineNum">    1225 </span>            :  * previous_words[0] contains the *last* word on the line, not the first.
<a name="1226"><span class="lineNum">    1226 </span>            :  */</a>
<span class="lineNum">    1227 </span>            : static bool
<span class="lineNum">    1228 </span><span class="lineNoCov">          0 : TailMatchesImpl(bool case_sensitive,</span>
<span class="lineNum">    1229 </span>            :                 int previous_words_count, char **previous_words,
<span class="lineNum">    1230 </span>            :                 int narg,...)
<span class="lineNum">    1231 </span>            : {
<span class="lineNum">    1232 </span>            :     va_list     args;
<span class="lineNum">    1233 </span>            : 
<span class="lineNum">    1234 </span><span class="lineNoCov">          0 :     if (previous_words_count &lt; narg)</span>
<span class="lineNum">    1235 </span><span class="lineNoCov">          0 :         return false;</span>
<span class="lineNum">    1236 </span>            : 
<span class="lineNum">    1237 </span><span class="lineNoCov">          0 :     va_start(args, narg);</span>
<span class="lineNum">    1238 </span>            : 
<span class="lineNum">    1239 </span><span class="lineNoCov">          0 :     for (int argno = 0; argno &lt; narg; argno++)</span>
<span class="lineNum">    1240 </span>            :     {
<span class="lineNum">    1241 </span><span class="lineNoCov">          0 :         const char *arg = va_arg(args, const char *);</span>
<span class="lineNum">    1242 </span>            : 
<span class="lineNum">    1243 </span><span class="lineNoCov">          0 :         if (!word_matches(arg, previous_words[narg - argno - 1],</span>
<span class="lineNum">    1244 </span>            :                           case_sensitive))
<span class="lineNum">    1245 </span>            :         {
<span class="lineNum">    1246 </span><span class="lineNoCov">          0 :             va_end(args);</span>
<span class="lineNum">    1247 </span><span class="lineNoCov">          0 :             return false;</span>
<span class="lineNum">    1248 </span>            :         }
<span class="lineNum">    1249 </span>            :     }
<span class="lineNum">    1250 </span>            : 
<span class="lineNum">    1251 </span><span class="lineNoCov">          0 :     va_end(args);</span>
<span class="lineNum">    1252 </span>            : 
<span class="lineNum">    1253 </span><span class="lineNoCov">          0 :     return true;</span>
<span class="lineNum">    1254 </span>            : }
<span class="lineNum">    1255 </span>            : 
<span class="lineNum">    1256 </span>            : /*
<span class="lineNum">    1257 </span>            :  * Implementation of Matches and MatchesCS macros: do all of the words
<span class="lineNum">    1258 </span>            :  * in previous_words match the variadic arguments?
<a name="1259"><span class="lineNum">    1259 </span>            :  */</a>
<span class="lineNum">    1260 </span>            : static bool
<span class="lineNum">    1261 </span><span class="lineNoCov">          0 : MatchesImpl(bool case_sensitive,</span>
<span class="lineNum">    1262 </span>            :             int previous_words_count, char **previous_words,
<span class="lineNum">    1263 </span>            :             int narg,...)
<span class="lineNum">    1264 </span>            : {
<span class="lineNum">    1265 </span>            :     va_list     args;
<span class="lineNum">    1266 </span>            : 
<span class="lineNum">    1267 </span><span class="lineNoCov">          0 :     if (previous_words_count != narg)</span>
<span class="lineNum">    1268 </span><span class="lineNoCov">          0 :         return false;</span>
<span class="lineNum">    1269 </span>            : 
<span class="lineNum">    1270 </span><span class="lineNoCov">          0 :     va_start(args, narg);</span>
<span class="lineNum">    1271 </span>            : 
<span class="lineNum">    1272 </span><span class="lineNoCov">          0 :     for (int argno = 0; argno &lt; narg; argno++)</span>
<span class="lineNum">    1273 </span>            :     {
<span class="lineNum">    1274 </span><span class="lineNoCov">          0 :         const char *arg = va_arg(args, const char *);</span>
<span class="lineNum">    1275 </span>            : 
<span class="lineNum">    1276 </span><span class="lineNoCov">          0 :         if (!word_matches(arg, previous_words[narg - argno - 1],</span>
<span class="lineNum">    1277 </span>            :                           case_sensitive))
<span class="lineNum">    1278 </span>            :         {
<span class="lineNum">    1279 </span><span class="lineNoCov">          0 :             va_end(args);</span>
<span class="lineNum">    1280 </span><span class="lineNoCov">          0 :             return false;</span>
<span class="lineNum">    1281 </span>            :         }
<span class="lineNum">    1282 </span>            :     }
<span class="lineNum">    1283 </span>            : 
<span class="lineNum">    1284 </span><span class="lineNoCov">          0 :     va_end(args);</span>
<span class="lineNum">    1285 </span>            : 
<span class="lineNum">    1286 </span><span class="lineNoCov">          0 :     return true;</span>
<span class="lineNum">    1287 </span>            : }
<span class="lineNum">    1288 </span>            : 
<span class="lineNum">    1289 </span>            : /*
<span class="lineNum">    1290 </span>            :  * Implementation of HeadMatches and HeadMatchesCS macros: do the first N
<span class="lineNum">    1291 </span>            :  * words in previous_words match the variadic arguments?
<a name="1292"><span class="lineNum">    1292 </span>            :  */</a>
<span class="lineNum">    1293 </span>            : static bool
<span class="lineNum">    1294 </span><span class="lineNoCov">          0 : HeadMatchesImpl(bool case_sensitive,</span>
<span class="lineNum">    1295 </span>            :                 int previous_words_count, char **previous_words,
<span class="lineNum">    1296 </span>            :                 int narg,...)
<span class="lineNum">    1297 </span>            : {
<span class="lineNum">    1298 </span>            :     va_list     args;
<span class="lineNum">    1299 </span>            : 
<span class="lineNum">    1300 </span><span class="lineNoCov">          0 :     if (previous_words_count &lt; narg)</span>
<span class="lineNum">    1301 </span><span class="lineNoCov">          0 :         return false;</span>
<span class="lineNum">    1302 </span>            : 
<span class="lineNum">    1303 </span><span class="lineNoCov">          0 :     va_start(args, narg);</span>
<span class="lineNum">    1304 </span>            : 
<span class="lineNum">    1305 </span><span class="lineNoCov">          0 :     for (int argno = 0; argno &lt; narg; argno++)</span>
<span class="lineNum">    1306 </span>            :     {
<span class="lineNum">    1307 </span><span class="lineNoCov">          0 :         const char *arg = va_arg(args, const char *);</span>
<span class="lineNum">    1308 </span>            : 
<span class="lineNum">    1309 </span><span class="lineNoCov">          0 :         if (!word_matches(arg, previous_words[previous_words_count - argno - 1],</span>
<span class="lineNum">    1310 </span>            :                           case_sensitive))
<span class="lineNum">    1311 </span>            :         {
<span class="lineNum">    1312 </span><span class="lineNoCov">          0 :             va_end(args);</span>
<span class="lineNum">    1313 </span><span class="lineNoCov">          0 :             return false;</span>
<span class="lineNum">    1314 </span>            :         }
<span class="lineNum">    1315 </span>            :     }
<span class="lineNum">    1316 </span>            : 
<span class="lineNum">    1317 </span><span class="lineNoCov">          0 :     va_end(args);</span>
<span class="lineNum">    1318 </span>            : 
<span class="lineNum">    1319 </span><span class="lineNoCov">          0 :     return true;</span>
<span class="lineNum">    1320 </span>            : }
<span class="lineNum">    1321 </span>            : 
<span class="lineNum">    1322 </span>            : /*
<span class="lineNum">    1323 </span>            :  * Check if the final character of 's' is 'c'.
<a name="1324"><span class="lineNum">    1324 </span>            :  */</a>
<span class="lineNum">    1325 </span>            : static bool
<span class="lineNum">    1326 </span><span class="lineNoCov">          0 : ends_with(const char *s, char c)</span>
<span class="lineNum">    1327 </span>            : {
<span class="lineNum">    1328 </span><span class="lineNoCov">          0 :     size_t      length = strlen(s);</span>
<span class="lineNum">    1329 </span>            : 
<span class="lineNum">    1330 </span><span class="lineNoCov">          0 :     return (length &gt; 0 &amp;&amp; s[length - 1] == c);</span>
<span class="lineNum">    1331 </span>            : }
<span class="lineNum">    1332 </span>            : 
<span class="lineNum">    1333 </span>            : /*
<span class="lineNum">    1334 </span>            :  * The completion function.
<span class="lineNum">    1335 </span>            :  *
<span class="lineNum">    1336 </span>            :  * According to readline spec this gets passed the text entered so far and its
<span class="lineNum">    1337 </span>            :  * start and end positions in the readline buffer. The return value is some
<span class="lineNum">    1338 </span>            :  * partially obscure list format that can be generated by readline's
<span class="lineNum">    1339 </span>            :  * completion_matches() function, so we don't have to worry about it.
<a name="1340"><span class="lineNum">    1340 </span>            :  */</a>
<span class="lineNum">    1341 </span>            : static char **
<span class="lineNum">    1342 </span><span class="lineNoCov">          0 : psql_completion(const char *text, int start, int end)</span>
<span class="lineNum">    1343 </span>            : {
<span class="lineNum">    1344 </span>            :     /* This is the variable we'll return. */
<span class="lineNum">    1345 </span><span class="lineNoCov">          0 :     char      **matches = NULL;</span>
<span class="lineNum">    1346 </span>            : 
<span class="lineNum">    1347 </span>            :     /* Workspace for parsed words. */
<span class="lineNum">    1348 </span>            :     char       *words_buffer;
<span class="lineNum">    1349 </span>            : 
<span class="lineNum">    1350 </span>            :     /* This array will contain pointers to parsed words. */
<span class="lineNum">    1351 </span>            :     char      **previous_words;
<span class="lineNum">    1352 </span>            : 
<span class="lineNum">    1353 </span>            :     /* The number of words found on the input line. */
<span class="lineNum">    1354 </span>            :     int         previous_words_count;
<span class="lineNum">    1355 </span>            : 
<span class="lineNum">    1356 </span>            :     /*
<span class="lineNum">    1357 </span>            :      * For compactness, we use these macros to reference previous_words[].
<span class="lineNum">    1358 </span>            :      * Caution: do not access a previous_words[] entry without having checked
<span class="lineNum">    1359 </span>            :      * previous_words_count to be sure it's valid.  In most cases below, that
<span class="lineNum">    1360 </span>            :      * check is implicit in a TailMatches() or similar macro, but in some
<span class="lineNum">    1361 </span>            :      * places we have to check it explicitly.
<span class="lineNum">    1362 </span>            :      */
<span class="lineNum">    1363 </span>            : #define prev_wd   (previous_words[0])
<span class="lineNum">    1364 </span>            : #define prev2_wd  (previous_words[1])
<span class="lineNum">    1365 </span>            : #define prev3_wd  (previous_words[2])
<span class="lineNum">    1366 </span>            : #define prev4_wd  (previous_words[3])
<span class="lineNum">    1367 </span>            : #define prev5_wd  (previous_words[4])
<span class="lineNum">    1368 </span>            : #define prev6_wd  (previous_words[5])
<span class="lineNum">    1369 </span>            : #define prev7_wd  (previous_words[6])
<span class="lineNum">    1370 </span>            : #define prev8_wd  (previous_words[7])
<span class="lineNum">    1371 </span>            : #define prev9_wd  (previous_words[8])
<span class="lineNum">    1372 </span>            : 
<span class="lineNum">    1373 </span>            :     /* Match the last N words before point, case-insensitively. */
<span class="lineNum">    1374 </span>            : #define TailMatches(...) \
<span class="lineNum">    1375 </span>            :     TailMatchesImpl(false, previous_words_count, previous_words, \
<span class="lineNum">    1376 </span>            :                     VA_ARGS_NARGS(__VA_ARGS__), __VA_ARGS__)
<span class="lineNum">    1377 </span>            : 
<span class="lineNum">    1378 </span>            :     /* Match the last N words before point, case-sensitively. */
<span class="lineNum">    1379 </span>            : #define TailMatchesCS(...) \
<span class="lineNum">    1380 </span>            :     TailMatchesImpl(true, previous_words_count, previous_words, \
<span class="lineNum">    1381 </span>            :                     VA_ARGS_NARGS(__VA_ARGS__), __VA_ARGS__)
<span class="lineNum">    1382 </span>            : 
<span class="lineNum">    1383 </span>            :     /* Match N words representing all of the line, case-insensitively. */
<span class="lineNum">    1384 </span>            : #define Matches(...) \
<span class="lineNum">    1385 </span>            :     MatchesImpl(false, previous_words_count, previous_words, \
<span class="lineNum">    1386 </span>            :                 VA_ARGS_NARGS(__VA_ARGS__), __VA_ARGS__)
<span class="lineNum">    1387 </span>            : 
<span class="lineNum">    1388 </span>            :     /* Match N words representing all of the line, case-sensitively. */
<span class="lineNum">    1389 </span>            : #define MatchesCS(...) \
<span class="lineNum">    1390 </span>            :     MatchesImpl(true, previous_words_count, previous_words, \
<span class="lineNum">    1391 </span>            :                 VA_ARGS_NARGS(__VA_ARGS__), __VA_ARGS__)
<span class="lineNum">    1392 </span>            : 
<span class="lineNum">    1393 </span>            :     /* Match the first N words on the line, case-insensitively. */
<span class="lineNum">    1394 </span>            : #define HeadMatches(...) \
<span class="lineNum">    1395 </span>            :     HeadMatchesImpl(false, previous_words_count, previous_words, \
<span class="lineNum">    1396 </span>            :                     VA_ARGS_NARGS(__VA_ARGS__), __VA_ARGS__)
<span class="lineNum">    1397 </span>            : 
<span class="lineNum">    1398 </span>            :     /* Match the first N words on the line, case-sensitively. */
<span class="lineNum">    1399 </span>            : #define HeadMatchesCS(...) \
<span class="lineNum">    1400 </span>            :     HeadMatchesImpl(true, previous_words_count, previous_words, \
<span class="lineNum">    1401 </span>            :                     VA_ARGS_NARGS(__VA_ARGS__), __VA_ARGS__)
<span class="lineNum">    1402 </span>            : 
<span class="lineNum">    1403 </span>            :     /* Known command-starting keywords. */
<span class="lineNum">    1404 </span>            :     static const char *const sql_commands[] = {
<span class="lineNum">    1405 </span>            :         &quot;ABORT&quot;, &quot;ALTER&quot;, &quot;ANALYZE&quot;, &quot;BEGIN&quot;, &quot;CALL&quot;, &quot;CHECKPOINT&quot;, &quot;CLOSE&quot;, &quot;CLUSTER&quot;,
<span class="lineNum">    1406 </span>            :         &quot;COMMENT&quot;, &quot;COMMIT&quot;, &quot;COPY&quot;, &quot;CREATE&quot;, &quot;DEALLOCATE&quot;, &quot;DECLARE&quot;,
<span class="lineNum">    1407 </span>            :         &quot;DELETE FROM&quot;, &quot;DISCARD&quot;, &quot;DO&quot;, &quot;DROP&quot;, &quot;END&quot;, &quot;EXECUTE&quot;, &quot;EXPLAIN&quot;,
<span class="lineNum">    1408 </span>            :         &quot;FETCH&quot;, &quot;GRANT&quot;, &quot;IMPORT&quot;, &quot;INSERT&quot;, &quot;LISTEN&quot;, &quot;LOAD&quot;, &quot;LOCK&quot;,
<span class="lineNum">    1409 </span>            :         &quot;MOVE&quot;, &quot;NOTIFY&quot;, &quot;PREPARE&quot;,
<span class="lineNum">    1410 </span>            :         &quot;REASSIGN&quot;, &quot;REFRESH MATERIALIZED VIEW&quot;, &quot;REINDEX&quot;, &quot;RELEASE&quot;,
<span class="lineNum">    1411 </span>            :         &quot;RESET&quot;, &quot;REVOKE&quot;, &quot;ROLLBACK&quot;,
<span class="lineNum">    1412 </span>            :         &quot;SAVEPOINT&quot;, &quot;SECURITY LABEL&quot;, &quot;SELECT&quot;, &quot;SET&quot;, &quot;SHOW&quot;, &quot;START&quot;,
<span class="lineNum">    1413 </span>            :         &quot;TABLE&quot;, &quot;TRUNCATE&quot;, &quot;UNLISTEN&quot;, &quot;UPDATE&quot;, &quot;VACUUM&quot;, &quot;VALUES&quot;, &quot;WITH&quot;,
<span class="lineNum">    1414 </span>            :         NULL
<span class="lineNum">    1415 </span>            :     };
<span class="lineNum">    1416 </span>            : 
<span class="lineNum">    1417 </span>            :     /* psql's backslash commands. */
<span class="lineNum">    1418 </span>            :     static const char *const backslash_commands[] = {
<span class="lineNum">    1419 </span>            :         &quot;\\a&quot;,
<span class="lineNum">    1420 </span>            :         &quot;\\connect&quot;, &quot;\\conninfo&quot;, &quot;\\C&quot;, &quot;\\cd&quot;, &quot;\\copy&quot;,
<span class="lineNum">    1421 </span>            :         &quot;\\copyright&quot;, &quot;\\crosstabview&quot;,
<span class="lineNum">    1422 </span>            :         &quot;\\d&quot;, &quot;\\da&quot;, &quot;\\dA&quot;, &quot;\\db&quot;, &quot;\\dc&quot;, &quot;\\dC&quot;, &quot;\\dd&quot;, &quot;\\ddp&quot;, &quot;\\dD&quot;,
<span class="lineNum">    1423 </span>            :         &quot;\\des&quot;, &quot;\\det&quot;, &quot;\\deu&quot;, &quot;\\dew&quot;, &quot;\\dE&quot;, &quot;\\df&quot;,
<span class="lineNum">    1424 </span>            :         &quot;\\dF&quot;, &quot;\\dFd&quot;, &quot;\\dFp&quot;, &quot;\\dFt&quot;, &quot;\\dg&quot;, &quot;\\di&quot;, &quot;\\dl&quot;, &quot;\\dL&quot;,
<span class="lineNum">    1425 </span>            :         &quot;\\dm&quot;, &quot;\\dn&quot;, &quot;\\do&quot;, &quot;\\dO&quot;, &quot;\\dp&quot;, &quot;\\dP&quot;, &quot;\\dPi&quot;, &quot;\\dPt&quot;,
<span class="lineNum">    1426 </span>            :         &quot;\\drds&quot;, &quot;\\dRs&quot;, &quot;\\dRp&quot;, &quot;\\ds&quot;, &quot;\\dS&quot;,
<span class="lineNum">    1427 </span>            :         &quot;\\dt&quot;, &quot;\\dT&quot;, &quot;\\dv&quot;, &quot;\\du&quot;, &quot;\\dx&quot;, &quot;\\dy&quot;,
<span class="lineNum">    1428 </span>            :         &quot;\\e&quot;, &quot;\\echo&quot;, &quot;\\ef&quot;, &quot;\\elif&quot;, &quot;\\else&quot;, &quot;\\encoding&quot;,
<span class="lineNum">    1429 </span>            :         &quot;\\endif&quot;, &quot;\\errverbose&quot;, &quot;\\ev&quot;,
<span class="lineNum">    1430 </span>            :         &quot;\\f&quot;,
<span class="lineNum">    1431 </span>            :         &quot;\\g&quot;, &quot;\\gdesc&quot;, &quot;\\gexec&quot;, &quot;\\gset&quot;, &quot;\\gx&quot;,
<span class="lineNum">    1432 </span>            :         &quot;\\h&quot;, &quot;\\help&quot;, &quot;\\H&quot;,
<span class="lineNum">    1433 </span>            :         &quot;\\i&quot;, &quot;\\if&quot;, &quot;\\ir&quot;,
<span class="lineNum">    1434 </span>            :         &quot;\\l&quot;, &quot;\\lo_import&quot;, &quot;\\lo_export&quot;, &quot;\\lo_list&quot;, &quot;\\lo_unlink&quot;,
<span class="lineNum">    1435 </span>            :         &quot;\\o&quot;,
<span class="lineNum">    1436 </span>            :         &quot;\\p&quot;, &quot;\\password&quot;, &quot;\\prompt&quot;, &quot;\\pset&quot;,
<span class="lineNum">    1437 </span>            :         &quot;\\q&quot;, &quot;\\qecho&quot;,
<span class="lineNum">    1438 </span>            :         &quot;\\r&quot;,
<span class="lineNum">    1439 </span>            :         &quot;\\s&quot;, &quot;\\set&quot;, &quot;\\setenv&quot;, &quot;\\sf&quot;, &quot;\\sv&quot;,
<span class="lineNum">    1440 </span>            :         &quot;\\t&quot;, &quot;\\T&quot;, &quot;\\timing&quot;,
<span class="lineNum">    1441 </span>            :         &quot;\\unset&quot;,
<span class="lineNum">    1442 </span>            :         &quot;\\x&quot;,
<span class="lineNum">    1443 </span>            :         &quot;\\w&quot;, &quot;\\warn&quot;, &quot;\\watch&quot;,
<span class="lineNum">    1444 </span>            :         &quot;\\z&quot;,
<span class="lineNum">    1445 </span>            :         &quot;\\!&quot;, &quot;\\?&quot;,
<span class="lineNum">    1446 </span>            :         NULL
<span class="lineNum">    1447 </span>            :     };
<span class="lineNum">    1448 </span>            : 
<span class="lineNum">    1449 </span>            :     (void) end;                 /* &quot;end&quot; is not used */
<span class="lineNum">    1450 </span>            : 
<span class="lineNum">    1451 </span>            : #ifdef HAVE_RL_COMPLETION_APPEND_CHARACTER
<span class="lineNum">    1452 </span><span class="lineNoCov">          0 :     rl_completion_append_character = ' ';</span>
<span class="lineNum">    1453 </span>            : #endif
<span class="lineNum">    1454 </span>            : 
<span class="lineNum">    1455 </span>            :     /* Clear a few things. */
<span class="lineNum">    1456 </span><span class="lineNoCov">          0 :     completion_charp = NULL;</span>
<span class="lineNum">    1457 </span><span class="lineNoCov">          0 :     completion_charpp = NULL;</span>
<span class="lineNum">    1458 </span><span class="lineNoCov">          0 :     completion_info_charp = NULL;</span>
<span class="lineNum">    1459 </span><span class="lineNoCov">          0 :     completion_info_charp2 = NULL;</span>
<span class="lineNum">    1460 </span>            : 
<span class="lineNum">    1461 </span>            :     /*
<span class="lineNum">    1462 </span>            :      * Scan the input line to extract the words before our current position.
<span class="lineNum">    1463 </span>            :      * According to those we'll make some smart decisions on what the user is
<span class="lineNum">    1464 </span>            :      * probably intending to type.
<span class="lineNum">    1465 </span>            :      */
<span class="lineNum">    1466 </span><span class="lineNoCov">          0 :     previous_words = get_previous_words(start,</span>
<span class="lineNum">    1467 </span>            :                                         &amp;words_buffer,
<span class="lineNum">    1468 </span>            :                                         &amp;previous_words_count);
<span class="lineNum">    1469 </span>            : 
<span class="lineNum">    1470 </span>            :     /* If current word is a backslash command, offer completions for that */
<span class="lineNum">    1471 </span><span class="lineNoCov">          0 :     if (text[0] == '\\')</span>
<span class="lineNum">    1472 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_LIST_CS(backslash_commands);</span>
<span class="lineNum">    1473 </span>            : 
<span class="lineNum">    1474 </span>            :     /* If current word is a variable interpolation, handle that case */
<span class="lineNum">    1475 </span><span class="lineNoCov">          0 :     else if (text[0] == ':' &amp;&amp; text[1] != ':')</span>
<span class="lineNum">    1476 </span>            :     {
<span class="lineNum">    1477 </span><span class="lineNoCov">          0 :         if (text[1] == '\'')</span>
<span class="lineNum">    1478 </span><span class="lineNoCov">          0 :             matches = complete_from_variables(text, &quot;:'&quot;, &quot;'&quot;, true);</span>
<span class="lineNum">    1479 </span><span class="lineNoCov">          0 :         else if (text[1] == '&quot;')</span>
<span class="lineNum">    1480 </span><span class="lineNoCov">          0 :             matches = complete_from_variables(text, &quot;:\&quot;&quot;, &quot;\&quot;&quot;, true);</span>
<span class="lineNum">    1481 </span>            :         else
<span class="lineNum">    1482 </span><span class="lineNoCov">          0 :             matches = complete_from_variables(text, &quot;:&quot;, &quot;&quot;, true);</span>
<span class="lineNum">    1483 </span>            :     }
<span class="lineNum">    1484 </span>            : 
<span class="lineNum">    1485 </span>            :     /* If no previous word, suggest one of the basic sql commands */
<span class="lineNum">    1486 </span><span class="lineNoCov">          0 :     else if (previous_words_count == 0)</span>
<span class="lineNum">    1487 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_LIST(sql_commands);</span>
<span class="lineNum">    1488 </span>            : 
<span class="lineNum">    1489 </span>            : /* CREATE */
<span class="lineNum">    1490 </span>            :     /* complete with something you can create */
<span class="lineNum">    1491 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;))</span>
<span class="lineNum">    1492 </span><span class="lineNoCov">          0 :         matches = completion_matches(text, create_command_generator);</span>
<span class="lineNum">    1493 </span>            : 
<span class="lineNum">    1494 </span>            :     /* complete with something you can create or replace */
<span class="lineNum">    1495 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;OR&quot;, &quot;REPLACE&quot;))</span>
<span class="lineNum">    1496 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FUNCTION&quot;, &quot;PROCEDURE&quot;, &quot;LANGUAGE&quot;, &quot;RULE&quot;, &quot;VIEW&quot;,</span>
<span class="lineNum">    1497 </span>            :                       &quot;AGGREGATE&quot;, &quot;TRANSFORM&quot;);
<span class="lineNum">    1498 </span>            : 
<span class="lineNum">    1499 </span>            : /* DROP, but not DROP embedded in other commands */
<span class="lineNum">    1500 </span>            :     /* complete with something you can drop */
<span class="lineNum">    1501 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;))</span>
<span class="lineNum">    1502 </span><span class="lineNoCov">          0 :         matches = completion_matches(text, drop_command_generator);</span>
<span class="lineNum">    1503 </span>            : 
<span class="lineNum">    1504 </span>            : /* ALTER */
<span class="lineNum">    1505 </span>            : 
<span class="lineNum">    1506 </span>            :     /* ALTER TABLE */
<span class="lineNum">    1507 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;))</span>
<span class="lineNum">    1508 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables,</span>
<span class="lineNum">    1509 </span>            :                                    &quot;UNION SELECT 'ALL IN TABLESPACE'&quot;);
<span class="lineNum">    1510 </span>            : 
<span class="lineNum">    1511 </span>            :     /* ALTER something */
<span class="lineNum">    1512 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;))</span>
<span class="lineNum">    1513 </span><span class="lineNoCov">          0 :         matches = completion_matches(text, alter_command_generator);</span>
<span class="lineNum">    1514 </span>            :     /* ALTER TABLE,INDEX,MATERIALIZED VIEW ALL IN TABLESPACE xxx */
<span class="lineNum">    1515 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;ALL&quot;, &quot;IN&quot;, &quot;TABLESPACE&quot;, MatchAny))</span>
<span class="lineNum">    1516 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SET TABLESPACE&quot;, &quot;OWNED BY&quot;);</span>
<span class="lineNum">    1517 </span>            :     /* ALTER TABLE,INDEX,MATERIALIZED VIEW ALL IN TABLESPACE xxx OWNED BY */
<span class="lineNum">    1518 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;ALL&quot;, &quot;IN&quot;, &quot;TABLESPACE&quot;, MatchAny, &quot;OWNED&quot;, &quot;BY&quot;))</span>
<span class="lineNum">    1519 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    1520 </span>            :     /* ALTER TABLE,INDEX,MATERIALIZED VIEW ALL IN TABLESPACE xxx OWNED BY xxx */
<span class="lineNum">    1521 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;ALL&quot;, &quot;IN&quot;, &quot;TABLESPACE&quot;, MatchAny, &quot;OWNED&quot;, &quot;BY&quot;, MatchAny))</span>
<span class="lineNum">    1522 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SET TABLESPACE&quot;);</span>
<span class="lineNum">    1523 </span>            :     /* ALTER AGGREGATE,FUNCTION,PROCEDURE,ROUTINE &lt;name&gt; */
<span class="lineNum">    1524 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;AGGREGATE|FUNCTION|PROCEDURE|ROUTINE&quot;, MatchAny))</span>
<span class="lineNum">    1525 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    1526 </span>            :     /* ALTER AGGREGATE,FUNCTION,PROCEDURE,ROUTINE &lt;name&gt; (...) */
<span class="lineNum">    1527 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;AGGREGATE|FUNCTION|PROCEDURE|ROUTINE&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    1528 </span>            :     {
<span class="lineNum">    1529 </span><span class="lineNoCov">          0 :         if (ends_with(prev_wd, ')'))</span>
<span class="lineNum">    1530 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;);</span>
<span class="lineNum">    1531 </span>            :         else
<span class="lineNum">    1532 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_FUNCTION_ARG(prev2_wd);</span>
<span class="lineNum">    1533 </span>            :     }
<span class="lineNum">    1534 </span>            :     /* ALTER PUBLICATION &lt;name&gt; */
<span class="lineNum">    1535 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;PUBLICATION&quot;, MatchAny))</span>
<span class="lineNum">    1536 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD TABLE&quot;, &quot;DROP TABLE&quot;, &quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET&quot;);</span>
<span class="lineNum">    1537 </span>            :     /* ALTER PUBLICATION &lt;name&gt; SET */
<span class="lineNum">    1538 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;PUBLICATION&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1539 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    1540 </span>            :     /* ALTER PUBLICATION &lt;name&gt; SET ( */
<span class="lineNum">    1541 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;PUBLICATION&quot;, MatchAny) &amp;&amp; TailMatches(&quot;SET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1542 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;publish&quot;);</span>
<span class="lineNum">    1543 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; */
<span class="lineNum">    1544 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny))</span>
<span class="lineNum">    1545 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONNECTION&quot;, &quot;ENABLE&quot;, &quot;DISABLE&quot;, &quot;OWNER TO&quot;,</span>
<span class="lineNum">    1546 </span>            :                       &quot;RENAME TO&quot;, &quot;REFRESH PUBLICATION&quot;, &quot;SET&quot;);
<span class="lineNum">    1547 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; REFRESH PUBLICATION */
<span class="lineNum">    1548 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    1549 </span><span class="lineNoCov">          0 :              TailMatches(&quot;REFRESH&quot;, &quot;PUBLICATION&quot;))</span>
<span class="lineNum">    1550 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH (&quot;);</span>
<span class="lineNum">    1551 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; REFRESH PUBLICATION WITH ( */
<span class="lineNum">    1552 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    1553 </span><span class="lineNoCov">          0 :              TailMatches(&quot;REFRESH&quot;, &quot;PUBLICATION&quot;, &quot;WITH&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1554 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;copy_data&quot;);</span>
<span class="lineNum">    1555 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; SET */
<span class="lineNum">    1556 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1557 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;PUBLICATION&quot;);</span>
<span class="lineNum">    1558 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; SET ( */
<span class="lineNum">    1559 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny) &amp;&amp; TailMatches(&quot;SET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1560 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;slot_name&quot;, &quot;synchronous_commit&quot;);</span>
<span class="lineNum">    1561 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; SET PUBLICATION */
<span class="lineNum">    1562 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny) &amp;&amp; TailMatches(&quot;SET&quot;, &quot;PUBLICATION&quot;))</span>
<span class="lineNum">    1563 </span>            :     {
<span class="lineNum">    1564 </span>            :         /* complete with nothing here as this refers to remote publications */
<span class="lineNum">    1565 </span>            :     }
<span class="lineNum">    1566 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; SET PUBLICATION &lt;name&gt; */
<span class="lineNum">    1567 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    1568 </span><span class="lineNoCov">          0 :              TailMatches(&quot;SET&quot;, &quot;PUBLICATION&quot;, MatchAny))</span>
<span class="lineNum">    1569 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH (&quot;);</span>
<span class="lineNum">    1570 </span>            :     /* ALTER SUBSCRIPTION &lt;name&gt; SET PUBLICATION &lt;name&gt; WITH ( */
<span class="lineNum">    1571 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;SUBSCRIPTION&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    1572 </span><span class="lineNoCov">          0 :              TailMatches(&quot;SET&quot;, &quot;PUBLICATION&quot;, MatchAny, &quot;WITH&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1573 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;copy_data&quot;, &quot;refresh&quot;);</span>
<span class="lineNum">    1574 </span>            :     /* ALTER SCHEMA &lt;name&gt; */
<span class="lineNum">    1575 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SCHEMA&quot;, MatchAny))</span>
<span class="lineNum">    1576 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;);</span>
<span class="lineNum">    1577 </span>            : 
<span class="lineNum">    1578 </span>            :     /* ALTER COLLATION &lt;name&gt; */
<span class="lineNum">    1579 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;COLLATION&quot;, MatchAny))</span>
<span class="lineNum">    1580 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;);</span>
<span class="lineNum">    1581 </span>            : 
<span class="lineNum">    1582 </span>            :     /* ALTER CONVERSION &lt;name&gt; */
<span class="lineNum">    1583 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;CONVERSION&quot;, MatchAny))</span>
<span class="lineNum">    1584 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;);</span>
<span class="lineNum">    1585 </span>            : 
<span class="lineNum">    1586 </span>            :     /* ALTER DATABASE &lt;name&gt; */
<span class="lineNum">    1587 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DATABASE&quot;, MatchAny))</span>
<span class="lineNum">    1588 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RESET&quot;, &quot;SET&quot;, &quot;OWNER TO&quot;, &quot;RENAME TO&quot;,</span>
<span class="lineNum">    1589 </span>            :                       &quot;IS_TEMPLATE&quot;, &quot;ALLOW_CONNECTIONS&quot;,
<span class="lineNum">    1590 </span>            :                       &quot;CONNECTION LIMIT&quot;);
<span class="lineNum">    1591 </span>            : 
<span class="lineNum">    1592 </span>            :     /* ALTER DATABASE &lt;name&gt; SET TABLESPACE */
<span class="lineNum">    1593 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DATABASE&quot;, MatchAny, &quot;SET&quot;, &quot;TABLESPACE&quot;))</span>
<span class="lineNum">    1594 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tablespaces);</span>
<span class="lineNum">    1595 </span>            : 
<span class="lineNum">    1596 </span>            :     /* ALTER EVENT TRIGGER */
<span class="lineNum">    1597 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;))</span>
<span class="lineNum">    1598 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_event_triggers);</span>
<span class="lineNum">    1599 </span>            : 
<span class="lineNum">    1600 </span>            :     /* ALTER EVENT TRIGGER &lt;name&gt; */
<span class="lineNum">    1601 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;, MatchAny))</span>
<span class="lineNum">    1602 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DISABLE&quot;, &quot;ENABLE&quot;, &quot;OWNER TO&quot;, &quot;RENAME TO&quot;);</span>
<span class="lineNum">    1603 </span>            : 
<span class="lineNum">    1604 </span>            :     /* ALTER EVENT TRIGGER &lt;name&gt; ENABLE */
<span class="lineNum">    1605 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ENABLE&quot;))</span>
<span class="lineNum">    1606 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;REPLICA&quot;, &quot;ALWAYS&quot;);</span>
<span class="lineNum">    1607 </span>            : 
<span class="lineNum">    1608 </span>            :     /* ALTER EXTENSION &lt;name&gt; */
<span class="lineNum">    1609 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;EXTENSION&quot;, MatchAny))</span>
<span class="lineNum">    1610 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD&quot;, &quot;DROP&quot;, &quot;UPDATE&quot;, &quot;SET SCHEMA&quot;);</span>
<span class="lineNum">    1611 </span>            : 
<span class="lineNum">    1612 </span>            :     /* ALTER EXTENSION &lt;name&gt; UPDATE */
<span class="lineNum">    1613 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;EXTENSION&quot;, MatchAny, &quot;UPDATE&quot;))</span>
<span class="lineNum">    1614 </span>            :     {
<span class="lineNum">    1615 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    1616 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_available_extension_versions_with_TO);</span>
<span class="lineNum">    1617 </span>            :     }
<span class="lineNum">    1618 </span>            : 
<span class="lineNum">    1619 </span>            :     /* ALTER EXTENSION &lt;name&gt; UPDATE TO */
<span class="lineNum">    1620 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;EXTENSION&quot;, MatchAny, &quot;UPDATE&quot;, &quot;TO&quot;))</span>
<span class="lineNum">    1621 </span>            :     {
<span class="lineNum">    1622 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1623 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_available_extension_versions);</span>
<span class="lineNum">    1624 </span>            :     }
<span class="lineNum">    1625 </span>            : 
<span class="lineNum">    1626 </span>            :     /* ALTER FOREIGN */
<span class="lineNum">    1627 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    1628 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA WRAPPER&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    1629 </span>            : 
<span class="lineNum">    1630 </span>            :     /* ALTER FOREIGN DATA WRAPPER &lt;name&gt; */
<span class="lineNum">    1631 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;FOREIGN&quot;, &quot;DATA&quot;, &quot;WRAPPER&quot;, MatchAny))</span>
<span class="lineNum">    1632 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;HANDLER&quot;, &quot;VALIDATOR&quot;, &quot;OPTIONS&quot;, &quot;OWNER TO&quot;, &quot;RENAME TO&quot;);</span>
<span class="lineNum">    1633 </span>            : 
<span class="lineNum">    1634 </span>            :     /* ALTER FOREIGN TABLE &lt;name&gt; */
<span class="lineNum">    1635 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;FOREIGN&quot;, &quot;TABLE&quot;, MatchAny))</span>
<span class="lineNum">    1636 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD&quot;, &quot;ALTER&quot;, &quot;DISABLE TRIGGER&quot;, &quot;DROP&quot;, &quot;ENABLE&quot;,</span>
<span class="lineNum">    1637 </span>            :                       &quot;INHERIT&quot;, &quot;NO INHERIT&quot;, &quot;OPTIONS&quot;, &quot;OWNER TO&quot;,
<span class="lineNum">    1638 </span>            :                       &quot;RENAME&quot;, &quot;SET&quot;, &quot;VALIDATE CONSTRAINT&quot;);
<span class="lineNum">    1639 </span>            : 
<span class="lineNum">    1640 </span>            :     /* ALTER INDEX */
<span class="lineNum">    1641 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;))</span>
<span class="lineNum">    1642 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes,</span>
<span class="lineNum">    1643 </span>            :                                    &quot;UNION SELECT 'ALL IN TABLESPACE'&quot;);
<span class="lineNum">    1644 </span>            :     /* ALTER INDEX &lt;name&gt; */
<span class="lineNum">    1645 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny))</span>
<span class="lineNum">    1646 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALTER COLUMN&quot;, &quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET&quot;,</span>
<span class="lineNum">    1647 </span>            :                       &quot;RESET&quot;, &quot;ATTACH PARTITION&quot;);
<span class="lineNum">    1648 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ATTACH&quot;))</span>
<span class="lineNum">    1649 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;PARTITION&quot;);</span>
<span class="lineNum">    1650 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ATTACH&quot;, &quot;PARTITION&quot;))</span>
<span class="lineNum">    1651 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes, NULL);</span>
<span class="lineNum">    1652 </span>            :     /* ALTER INDEX &lt;name&gt; ALTER */
<span class="lineNum">    1653 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ALTER&quot;))</span>
<span class="lineNum">    1654 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;COLUMN&quot;);</span>
<span class="lineNum">    1655 </span>            :     /* ALTER INDEX &lt;name&gt; ALTER COLUMN */
<span class="lineNum">    1656 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;))</span>
<span class="lineNum">    1657 </span>            :     {
<span class="lineNum">    1658 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1659 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_attribute_numbers);</span>
<span class="lineNum">    1660 </span>            :     }
<span class="lineNum">    1661 </span>            :     /* ALTER INDEX &lt;name&gt; ALTER COLUMN &lt;colnum&gt; */
<span class="lineNum">    1662 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny))</span>
<span class="lineNum">    1663 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SET STATISTICS&quot;);</span>
<span class="lineNum">    1664 </span>            :     /* ALTER INDEX &lt;name&gt; ALTER COLUMN &lt;colnum&gt; SET */
<span class="lineNum">    1665 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1666 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;STATISTICS&quot;);</span>
<span class="lineNum">    1667 </span>            :     /* ALTER INDEX &lt;name&gt; ALTER COLUMN &lt;colnum&gt; SET STATISTICS */
<span class="lineNum">    1668 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;SET&quot;, &quot;STATISTICS&quot;))</span>
<span class="lineNum">    1669 </span>            :     {
<span class="lineNum">    1670 </span>            :         /* Enforce no completion here, as an integer has to be specified */
<span class="lineNum">    1671 </span>            :     }
<span class="lineNum">    1672 </span>            :     /* ALTER INDEX &lt;name&gt; SET */
<span class="lineNum">    1673 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1674 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;TABLESPACE&quot;);</span>
<span class="lineNum">    1675 </span>            :     /* ALTER INDEX &lt;name&gt; RESET */
<span class="lineNum">    1676 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;RESET&quot;))</span>
<span class="lineNum">    1677 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    1678 </span>            :     /* ALTER INDEX &lt;foo&gt; SET|RESET ( */
<span class="lineNum">    1679 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;RESET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1680 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;fillfactor&quot;,</span>
<span class="lineNum">    1681 </span>            :                       &quot;vacuum_cleanup_index_scale_factor&quot;,    /* BTREE */
<span class="lineNum">    1682 </span>            :                       &quot;fastupdate&quot;, &quot;gin_pending_list_limit&quot;,   /* GIN */
<span class="lineNum">    1683 </span>            :                       &quot;buffering&quot;,    /* GiST */
<span class="lineNum">    1684 </span>            :                       &quot;pages_per_range&quot;, &quot;autosummarize&quot;    /* BRIN */
<span class="lineNum">    1685 </span>            :             );
<span class="lineNum">    1686 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;INDEX&quot;, MatchAny, &quot;SET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1687 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;fillfactor =&quot;,</span>
<span class="lineNum">    1688 </span>            :                       &quot;vacuum_cleanup_index_scale_factor =&quot;,  /* BTREE */
<span class="lineNum">    1689 </span>            :                       &quot;fastupdate =&quot;, &quot;gin_pending_list_limit =&quot;,   /* GIN */
<span class="lineNum">    1690 </span>            :                       &quot;buffering =&quot;,  /* GiST */
<span class="lineNum">    1691 </span>            :                       &quot;pages_per_range =&quot;, &quot;autosummarize =&quot;    /* BRIN */
<span class="lineNum">    1692 </span>            :             );
<span class="lineNum">    1693 </span>            : 
<span class="lineNum">    1694 </span>            :     /* ALTER LANGUAGE &lt;name&gt; */
<span class="lineNum">    1695 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;LANGUAGE&quot;, MatchAny))</span>
<span class="lineNum">    1696 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;);</span>
<span class="lineNum">    1697 </span>            : 
<span class="lineNum">    1698 </span>            :     /* ALTER LARGE OBJECT &lt;oid&gt; */
<span class="lineNum">    1699 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;LARGE&quot;, &quot;OBJECT&quot;, MatchAny))</span>
<span class="lineNum">    1700 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;);</span>
<span class="lineNum">    1701 </span>            : 
<span class="lineNum">    1702 </span>            :     /* ALTER MATERIALIZED VIEW */
<span class="lineNum">    1703 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;))</span>
<span class="lineNum">    1704 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_matviews,</span>
<span class="lineNum">    1705 </span>            :                                    &quot;UNION SELECT 'ALL IN TABLESPACE'&quot;);
<span class="lineNum">    1706 </span>            : 
<span class="lineNum">    1707 </span>            :     /* ALTER USER,ROLE &lt;name&gt; */
<span class="lineNum">    1708 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;USER|ROLE&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    1709 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;USER&quot;, &quot;MAPPING&quot;))</span>
<span class="lineNum">    1710 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BYPASSRLS&quot;, &quot;CONNECTION LIMIT&quot;, &quot;CREATEDB&quot;, &quot;CREATEROLE&quot;,</span>
<span class="lineNum">    1711 </span>            :                       &quot;ENCRYPTED PASSWORD&quot;, &quot;INHERIT&quot;, &quot;LOGIN&quot;, &quot;NOBYPASSRLS&quot;,
<span class="lineNum">    1712 </span>            :                       &quot;NOCREATEDB&quot;, &quot;NOCREATEROLE&quot;, &quot;NOINHERIT&quot;,
<span class="lineNum">    1713 </span>            :                       &quot;NOLOGIN&quot;, &quot;NOREPLICATION&quot;, &quot;NOSUPERUSER&quot;, &quot;PASSWORD&quot;,
<span class="lineNum">    1714 </span>            :                       &quot;RENAME TO&quot;, &quot;REPLICATION&quot;, &quot;RESET&quot;, &quot;SET&quot;, &quot;SUPERUSER&quot;,
<span class="lineNum">    1715 </span>            :                       &quot;VALID UNTIL&quot;, &quot;WITH&quot;);
<span class="lineNum">    1716 </span>            : 
<span class="lineNum">    1717 </span>            :     /* ALTER USER,ROLE &lt;name&gt; WITH */
<span class="lineNum">    1718 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;USER|ROLE&quot;, MatchAny, &quot;WITH&quot;))</span>
<span class="lineNum">    1719 </span>            :         /* Similar to the above, but don't complete &quot;WITH&quot; again. */
<span class="lineNum">    1720 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BYPASSRLS&quot;, &quot;CONNECTION LIMIT&quot;, &quot;CREATEDB&quot;, &quot;CREATEROLE&quot;,</span>
<span class="lineNum">    1721 </span>            :                       &quot;ENCRYPTED PASSWORD&quot;, &quot;INHERIT&quot;, &quot;LOGIN&quot;, &quot;NOBYPASSRLS&quot;,
<span class="lineNum">    1722 </span>            :                       &quot;NOCREATEDB&quot;, &quot;NOCREATEROLE&quot;, &quot;NOINHERIT&quot;,
<span class="lineNum">    1723 </span>            :                       &quot;NOLOGIN&quot;, &quot;NOREPLICATION&quot;, &quot;NOSUPERUSER&quot;, &quot;PASSWORD&quot;,
<span class="lineNum">    1724 </span>            :                       &quot;RENAME TO&quot;, &quot;REPLICATION&quot;, &quot;RESET&quot;, &quot;SET&quot;, &quot;SUPERUSER&quot;,
<span class="lineNum">    1725 </span>            :                       &quot;VALID UNTIL&quot;);
<span class="lineNum">    1726 </span>            : 
<span class="lineNum">    1727 </span>            :     /* ALTER DEFAULT PRIVILEGES */
<span class="lineNum">    1728 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;))</span>
<span class="lineNum">    1729 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOR ROLE&quot;, &quot;IN SCHEMA&quot;);</span>
<span class="lineNum">    1730 </span>            :     /* ALTER DEFAULT PRIVILEGES FOR */
<span class="lineNum">    1731 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;FOR&quot;))</span>
<span class="lineNum">    1732 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ROLE&quot;);</span>
<span class="lineNum">    1733 </span>            :     /* ALTER DEFAULT PRIVILEGES IN */
<span class="lineNum">    1734 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;IN&quot;))</span>
<span class="lineNum">    1735 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SCHEMA&quot;);</span>
<span class="lineNum">    1736 </span>            :     /* ALTER DEFAULT PRIVILEGES FOR ROLE|USER ... */
<span class="lineNum">    1737 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;FOR&quot;, &quot;ROLE|USER&quot;,</span>
<span class="lineNum">    1738 </span>            :                      MatchAny))
<span class="lineNum">    1739 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;GRANT&quot;, &quot;REVOKE&quot;, &quot;IN SCHEMA&quot;);</span>
<span class="lineNum">    1740 </span>            :     /* ALTER DEFAULT PRIVILEGES IN SCHEMA ... */
<span class="lineNum">    1741 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;IN&quot;, &quot;SCHEMA&quot;,</span>
<span class="lineNum">    1742 </span>            :                      MatchAny))
<span class="lineNum">    1743 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;GRANT&quot;, &quot;REVOKE&quot;, &quot;FOR ROLE&quot;);</span>
<span class="lineNum">    1744 </span>            :     /* ALTER DEFAULT PRIVILEGES IN SCHEMA ... FOR */
<span class="lineNum">    1745 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;IN&quot;, &quot;SCHEMA&quot;,</span>
<span class="lineNum">    1746 </span>            :                      MatchAny, &quot;FOR&quot;))
<span class="lineNum">    1747 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ROLE&quot;);</span>
<span class="lineNum">    1748 </span>            :     /* ALTER DEFAULT PRIVILEGES FOR ROLE|USER ... IN SCHEMA ... */
<span class="lineNum">    1749 </span>            :     /* ALTER DEFAULT PRIVILEGES IN SCHEMA ... FOR ROLE|USER ... */
<span class="lineNum">    1750 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;FOR&quot;, &quot;ROLE|USER&quot;,</span>
<span class="lineNum">    1751 </span><span class="lineNoCov">          0 :                      MatchAny, &quot;IN&quot;, &quot;SCHEMA&quot;, MatchAny) ||</span>
<span class="lineNum">    1752 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;, &quot;IN&quot;, &quot;SCHEMA&quot;,</span>
<span class="lineNum">    1753 </span>            :                      MatchAny, &quot;FOR&quot;, &quot;ROLE|USER&quot;, MatchAny))
<span class="lineNum">    1754 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;GRANT&quot;, &quot;REVOKE&quot;);</span>
<span class="lineNum">    1755 </span>            :     /* ALTER DOMAIN &lt;name&gt; */
<span class="lineNum">    1756 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DOMAIN&quot;, MatchAny))</span>
<span class="lineNum">    1757 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD&quot;, &quot;DROP&quot;, &quot;OWNER TO&quot;, &quot;RENAME&quot;, &quot;SET&quot;,</span>
<span class="lineNum">    1758 </span>            :                       &quot;VALIDATE CONSTRAINT&quot;);
<span class="lineNum">    1759 </span>            :     /* ALTER DOMAIN &lt;sth&gt; DROP */
<span class="lineNum">    1760 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DOMAIN&quot;, MatchAny, &quot;DROP&quot;))</span>
<span class="lineNum">    1761 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONSTRAINT&quot;, &quot;DEFAULT&quot;, &quot;NOT NULL&quot;);</span>
<span class="lineNum">    1762 </span>            :     /* ALTER DOMAIN &lt;sth&gt; DROP|RENAME|VALIDATE CONSTRAINT */
<span class="lineNum">    1763 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DOMAIN&quot;, MatchAny, &quot;DROP|RENAME|VALIDATE&quot;, &quot;CONSTRAINT&quot;))</span>
<span class="lineNum">    1764 </span>            :     {
<span class="lineNum">    1765 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1766 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_constraint_of_type);</span>
<span class="lineNum">    1767 </span>            :     }
<span class="lineNum">    1768 </span>            :     /* ALTER DOMAIN &lt;sth&gt; RENAME */
<span class="lineNum">    1769 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DOMAIN&quot;, MatchAny, &quot;RENAME&quot;))</span>
<span class="lineNum">    1770 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONSTRAINT&quot;, &quot;TO&quot;);</span>
<span class="lineNum">    1771 </span>            :     /* ALTER DOMAIN &lt;sth&gt; RENAME CONSTRAINT &lt;sth&gt; */
<span class="lineNum">    1772 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DOMAIN&quot;, MatchAny, &quot;RENAME&quot;, &quot;CONSTRAINT&quot;, MatchAny))</span>
<span class="lineNum">    1773 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1774 </span>            : 
<span class="lineNum">    1775 </span>            :     /* ALTER DOMAIN &lt;sth&gt; SET */
<span class="lineNum">    1776 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;DOMAIN&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1777 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DEFAULT&quot;, &quot;NOT NULL&quot;, &quot;SCHEMA&quot;);</span>
<span class="lineNum">    1778 </span>            :     /* ALTER SEQUENCE &lt;name&gt; */
<span class="lineNum">    1779 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SEQUENCE&quot;, MatchAny))</span>
<span class="lineNum">    1780 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INCREMENT&quot;, &quot;MINVALUE&quot;, &quot;MAXVALUE&quot;, &quot;RESTART&quot;, &quot;NO&quot;,</span>
<span class="lineNum">    1781 </span>            :                       &quot;CACHE&quot;, &quot;CYCLE&quot;, &quot;SET SCHEMA&quot;, &quot;OWNED BY&quot;, &quot;OWNER TO&quot;,
<span class="lineNum">    1782 </span>            :                       &quot;RENAME TO&quot;);
<span class="lineNum">    1783 </span>            :     /* ALTER SEQUENCE &lt;name&gt; NO */
<span class="lineNum">    1784 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SEQUENCE&quot;, MatchAny, &quot;NO&quot;))</span>
<span class="lineNum">    1785 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;MINVALUE&quot;, &quot;MAXVALUE&quot;, &quot;CYCLE&quot;);</span>
<span class="lineNum">    1786 </span>            :     /* ALTER SERVER &lt;name&gt; */
<span class="lineNum">    1787 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SERVER&quot;, MatchAny))</span>
<span class="lineNum">    1788 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;VERSION&quot;, &quot;OPTIONS&quot;, &quot;OWNER TO&quot;, &quot;RENAME TO&quot;);</span>
<span class="lineNum">    1789 </span>            :     /* ALTER SERVER &lt;name&gt; VERSION &lt;version&gt; */
<span class="lineNum">    1790 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SERVER&quot;, MatchAny, &quot;VERSION&quot;, MatchAny))</span>
<span class="lineNum">    1791 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OPTIONS&quot;);</span>
<span class="lineNum">    1792 </span>            :     /* ALTER SYSTEM SET, RESET, RESET ALL */
<span class="lineNum">    1793 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SYSTEM&quot;))</span>
<span class="lineNum">    1794 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SET&quot;, &quot;RESET&quot;);</span>
<span class="lineNum">    1795 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SYSTEM&quot;, &quot;SET|RESET&quot;))</span>
<span class="lineNum">    1796 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_alter_system_set_vars);</span>
<span class="lineNum">    1797 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;SYSTEM&quot;, &quot;SET&quot;, MatchAny))</span>
<span class="lineNum">    1798 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1799 </span>            :     /* ALTER VIEW &lt;name&gt; */
<span class="lineNum">    1800 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;VIEW&quot;, MatchAny))</span>
<span class="lineNum">    1801 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALTER COLUMN&quot;, &quot;OWNER TO&quot;, &quot;RENAME&quot;,</span>
<span class="lineNum">    1802 </span>            :                       &quot;SET SCHEMA&quot;);
<span class="lineNum">    1803 </span>            :     /* ALTER VIEW xxx RENAME */
<span class="lineNum">    1804 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;VIEW&quot;, MatchAny, &quot;RENAME&quot;))</span>
<span class="lineNum">    1805 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot; UNION SELECT 'COLUMN' UNION SELECT 'TO'&quot;);</span>
<span class="lineNum">    1806 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;VIEW&quot;, MatchAny, &quot;ALTER|RENAME&quot;, &quot;COLUMN&quot;))</span>
<span class="lineNum">    1807 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev3_wd, &quot;&quot;);</span>
<span class="lineNum">    1808 </span>            :     /* ALTER VIEW xxx RENAME yyy */
<span class="lineNum">    1809 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;VIEW&quot;, MatchAny, &quot;RENAME&quot;, MatchAnyExcept(&quot;TO&quot;)))</span>
<span class="lineNum">    1810 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1811 </span>            :     /* ALTER VIEW xxx RENAME COLUMN yyy */
<span class="lineNum">    1812 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;VIEW&quot;, MatchAny, &quot;RENAME&quot;, &quot;COLUMN&quot;, MatchAnyExcept(&quot;TO&quot;)))</span>
<span class="lineNum">    1813 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1814 </span>            : 
<span class="lineNum">    1815 </span>            :     /* ALTER MATERIALIZED VIEW &lt;name&gt; */
<span class="lineNum">    1816 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny))</span>
<span class="lineNum">    1817 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALTER COLUMN&quot;, &quot;CLUSTER ON&quot;, &quot;DEPENDS ON EXTENSION&quot;,</span>
<span class="lineNum">    1818 </span>            :                       &quot;OWNER TO&quot;, &quot;RENAME&quot;, &quot;RESET (&quot;, &quot;SET&quot;);
<span class="lineNum">    1819 </span>            :     /* ALTER MATERIALIZED VIEW xxx RENAME */
<span class="lineNum">    1820 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;RENAME&quot;))</span>
<span class="lineNum">    1821 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot; UNION SELECT 'COLUMN' UNION SELECT 'TO'&quot;);</span>
<span class="lineNum">    1822 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;ALTER|RENAME&quot;, &quot;COLUMN&quot;))</span>
<span class="lineNum">    1823 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev3_wd, &quot;&quot;);</span>
<span class="lineNum">    1824 </span>            :     /* ALTER MATERIALIZED VIEW xxx RENAME yyy */
<span class="lineNum">    1825 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;RENAME&quot;, MatchAnyExcept(&quot;TO&quot;)))</span>
<span class="lineNum">    1826 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1827 </span>            :     /* ALTER MATERIALIZED VIEW xxx RENAME COLUMN yyy */
<span class="lineNum">    1828 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;RENAME&quot;, &quot;COLUMN&quot;, MatchAnyExcept(&quot;TO&quot;)))</span>
<span class="lineNum">    1829 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1830 </span>            :     /* ALTER MATERIALIZED VIEW xxx SET */
<span class="lineNum">    1831 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1832 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;SCHEMA&quot;, &quot;TABLESPACE&quot;, &quot;WITHOUT CLUSTER&quot;);</span>
<span class="lineNum">    1833 </span>            :     /* ALTER POLICY &lt;name&gt; */
<span class="lineNum">    1834 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;))</span>
<span class="lineNum">    1835 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_policies);</span>
<span class="lineNum">    1836 </span>            :     /* ALTER POLICY &lt;name&gt; ON */
<span class="lineNum">    1837 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;, MatchAny))</span>
<span class="lineNum">    1838 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    1839 </span>            :     /* ALTER POLICY &lt;name&gt; ON &lt;table&gt; */
<span class="lineNum">    1840 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    1841 </span>            :     {
<span class="lineNum">    1842 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    1843 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_policy);</span>
<span class="lineNum">    1844 </span>            :     }
<span class="lineNum">    1845 </span>            :     /* ALTER POLICY &lt;name&gt; ON &lt;table&gt; - show options */
<span class="lineNum">    1846 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    1847 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RENAME TO&quot;, &quot;TO&quot;, &quot;USING (&quot;, &quot;WITH CHECK (&quot;);</span>
<span class="lineNum">    1848 </span>            :     /* ALTER POLICY &lt;name&gt; ON &lt;table&gt; TO &lt;role&gt; */
<span class="lineNum">    1849 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;TO&quot;))</span>
<span class="lineNum">    1850 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_grant_roles);</span>
<span class="lineNum">    1851 </span>            :     /* ALTER POLICY &lt;name&gt; ON &lt;table&gt; USING ( */
<span class="lineNum">    1852 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;USING&quot;))</span>
<span class="lineNum">    1853 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    1854 </span>            :     /* ALTER POLICY &lt;name&gt; ON &lt;table&gt; WITH CHECK ( */
<span class="lineNum">    1855 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;WITH&quot;, &quot;CHECK&quot;))</span>
<span class="lineNum">    1856 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    1857 </span>            : 
<span class="lineNum">    1858 </span>            :     /* ALTER RULE &lt;name&gt;, add ON */
<span class="lineNum">    1859 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;RULE&quot;, MatchAny))</span>
<span class="lineNum">    1860 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    1861 </span>            : 
<span class="lineNum">    1862 </span>            :     /* If we have ALTER RULE &lt;name&gt; ON, then add the correct tablename */
<span class="lineNum">    1863 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;RULE&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    1864 </span>            :     {
<span class="lineNum">    1865 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    1866 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_rule);</span>
<span class="lineNum">    1867 </span>            :     }
<span class="lineNum">    1868 </span>            : 
<span class="lineNum">    1869 </span>            :     /* ALTER RULE &lt;name&gt; ON &lt;name&gt; */
<span class="lineNum">    1870 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;RULE&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    1871 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RENAME TO&quot;);</span>
<span class="lineNum">    1872 </span>            : 
<span class="lineNum">    1873 </span>            :     /* ALTER STATISTICS &lt;name&gt; */
<span class="lineNum">    1874 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;STATISTICS&quot;, MatchAny))</span>
<span class="lineNum">    1875 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;, &quot;SET STATISTICS&quot;);</span>
<span class="lineNum">    1876 </span>            : 
<span class="lineNum">    1877 </span>            :     /* ALTER TRIGGER &lt;name&gt;, add ON */
<span class="lineNum">    1878 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TRIGGER&quot;, MatchAny))</span>
<span class="lineNum">    1879 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    1880 </span>            : 
<span class="lineNum">    1881 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TRIGGER&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    1882 </span>            :     {
<span class="lineNum">    1883 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    1884 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_trigger);</span>
<span class="lineNum">    1885 </span>            :     }
<span class="lineNum">    1886 </span>            : 
<span class="lineNum">    1887 </span>            :     /*
<span class="lineNum">    1888 </span>            :      * If we have ALTER TRIGGER &lt;sth&gt; ON, then add the correct tablename
<span class="lineNum">    1889 </span>            :      */
<span class="lineNum">    1890 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    1891 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    1892 </span>            : 
<span class="lineNum">    1893 </span>            :     /* ALTER TRIGGER &lt;name&gt; ON &lt;name&gt; */
<span class="lineNum">    1894 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    1895 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RENAME TO&quot;);</span>
<span class="lineNum">    1896 </span>            : 
<span class="lineNum">    1897 </span>            :     /*
<span class="lineNum">    1898 </span>            :      * If we detect ALTER TABLE &lt;name&gt;, suggest sub commands
<span class="lineNum">    1899 </span>            :      */
<span class="lineNum">    1900 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny))</span>
<span class="lineNum">    1901 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD&quot;, &quot;ALTER&quot;, &quot;CLUSTER ON&quot;, &quot;DISABLE&quot;, &quot;DROP&quot;,</span>
<span class="lineNum">    1902 </span>            :                       &quot;ENABLE&quot;, &quot;INHERIT&quot;, &quot;NO INHERIT&quot;, &quot;RENAME&quot;, &quot;RESET&quot;,
<span class="lineNum">    1903 </span>            :                       &quot;OWNER TO&quot;, &quot;SET&quot;, &quot;VALIDATE CONSTRAINT&quot;,
<span class="lineNum">    1904 </span>            :                       &quot;REPLICA IDENTITY&quot;, &quot;ATTACH PARTITION&quot;,
<span class="lineNum">    1905 </span>            :                       &quot;DETACH PARTITION&quot;);
<span class="lineNum">    1906 </span>            :     /* ALTER TABLE xxx ENABLE */
<span class="lineNum">    1907 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ENABLE&quot;))</span>
<span class="lineNum">    1908 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALWAYS&quot;, &quot;REPLICA&quot;, &quot;ROW LEVEL SECURITY&quot;, &quot;RULE&quot;,</span>
<span class="lineNum">    1909 </span>            :                       &quot;TRIGGER&quot;);
<span class="lineNum">    1910 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ENABLE&quot;, &quot;REPLICA|ALWAYS&quot;))</span>
<span class="lineNum">    1911 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RULE&quot;, &quot;TRIGGER&quot;);</span>
<span class="lineNum">    1912 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ENABLE&quot;, &quot;RULE&quot;))</span>
<span class="lineNum">    1913 </span>            :     {
<span class="lineNum">    1914 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1915 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_rule_of_table);</span>
<span class="lineNum">    1916 </span>            :     }
<span class="lineNum">    1917 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ENABLE&quot;, MatchAny, &quot;RULE&quot;))</span>
<span class="lineNum">    1918 </span>            :     {
<span class="lineNum">    1919 </span><span class="lineNoCov">          0 :         completion_info_charp = prev4_wd;</span>
<span class="lineNum">    1920 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_rule_of_table);</span>
<span class="lineNum">    1921 </span>            :     }
<span class="lineNum">    1922 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ENABLE&quot;, &quot;TRIGGER&quot;))</span>
<span class="lineNum">    1923 </span>            :     {
<span class="lineNum">    1924 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1925 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_trigger_of_table);</span>
<span class="lineNum">    1926 </span>            :     }
<span class="lineNum">    1927 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ENABLE&quot;, MatchAny, &quot;TRIGGER&quot;))</span>
<span class="lineNum">    1928 </span>            :     {
<span class="lineNum">    1929 </span><span class="lineNoCov">          0 :         completion_info_charp = prev4_wd;</span>
<span class="lineNum">    1930 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_trigger_of_table);</span>
<span class="lineNum">    1931 </span>            :     }
<span class="lineNum">    1932 </span>            :     /* ALTER TABLE xxx INHERIT */
<span class="lineNum">    1933 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;INHERIT&quot;))</span>
<span class="lineNum">    1934 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, &quot;&quot;);</span>
<span class="lineNum">    1935 </span>            :     /* ALTER TABLE xxx NO INHERIT */
<span class="lineNum">    1936 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;NO&quot;, &quot;INHERIT&quot;))</span>
<span class="lineNum">    1937 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, &quot;&quot;);</span>
<span class="lineNum">    1938 </span>            :     /* ALTER TABLE xxx DISABLE */
<span class="lineNum">    1939 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;DISABLE&quot;))</span>
<span class="lineNum">    1940 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ROW LEVEL SECURITY&quot;, &quot;RULE&quot;, &quot;TRIGGER&quot;);</span>
<span class="lineNum">    1941 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;DISABLE&quot;, &quot;RULE&quot;))</span>
<span class="lineNum">    1942 </span>            :     {
<span class="lineNum">    1943 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1944 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_rule_of_table);</span>
<span class="lineNum">    1945 </span>            :     }
<span class="lineNum">    1946 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;DISABLE&quot;, &quot;TRIGGER&quot;))</span>
<span class="lineNum">    1947 </span>            :     {
<span class="lineNum">    1948 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1949 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_trigger_of_table);</span>
<span class="lineNum">    1950 </span>            :     }
<span class="lineNum">    1951 </span>            : 
<span class="lineNum">    1952 </span>            :     /* ALTER TABLE xxx ALTER */
<span class="lineNum">    1953 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;))</span>
<span class="lineNum">    1954 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot; UNION SELECT 'COLUMN' UNION SELECT 'CONSTRAINT'&quot;);</span>
<span class="lineNum">    1955 </span>            : 
<span class="lineNum">    1956 </span>            :     /* ALTER TABLE xxx RENAME */
<span class="lineNum">    1957 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;RENAME&quot;))</span>
<span class="lineNum">    1958 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot; UNION SELECT 'COLUMN' UNION SELECT 'CONSTRAINT' UNION SELECT 'TO'&quot;);</span>
<span class="lineNum">    1959 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER|RENAME&quot;, &quot;COLUMN&quot;))</span>
<span class="lineNum">    1960 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev3_wd, &quot;&quot;);</span>
<span class="lineNum">    1961 </span>            : 
<span class="lineNum">    1962 </span>            :     /* ALTER TABLE xxx RENAME yyy */
<span class="lineNum">    1963 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;RENAME&quot;, MatchAnyExcept(&quot;CONSTRAINT|TO&quot;)))</span>
<span class="lineNum">    1964 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1965 </span>            : 
<span class="lineNum">    1966 </span>            :     /* ALTER TABLE xxx RENAME COLUMN/CONSTRAINT yyy */
<span class="lineNum">    1967 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;RENAME&quot;, &quot;COLUMN|CONSTRAINT&quot;, MatchAnyExcept(&quot;TO&quot;)))</span>
<span class="lineNum">    1968 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    1969 </span>            : 
<span class="lineNum">    1970 </span>            :     /* If we have ALTER TABLE &lt;sth&gt; DROP, provide COLUMN or CONSTRAINT */
<span class="lineNum">    1971 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;DROP&quot;))</span>
<span class="lineNum">    1972 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;COLUMN&quot;, &quot;CONSTRAINT&quot;);</span>
<span class="lineNum">    1973 </span>            :     /* If we have ALTER TABLE &lt;sth&gt; DROP COLUMN, provide list of columns */
<span class="lineNum">    1974 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;DROP&quot;, &quot;COLUMN&quot;))</span>
<span class="lineNum">    1975 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev3_wd, &quot;&quot;);</span>
<span class="lineNum">    1976 </span>            : 
<span class="lineNum">    1977 </span>            :     /*
<span class="lineNum">    1978 </span>            :      * If we have ALTER TABLE &lt;sth&gt; ALTER|DROP|RENAME|VALIDATE CONSTRAINT,
<span class="lineNum">    1979 </span>            :      * provide list of constraints
<span class="lineNum">    1980 </span>            :      */
<span class="lineNum">    1981 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER|DROP|RENAME|VALIDATE&quot;, &quot;CONSTRAINT&quot;))</span>
<span class="lineNum">    1982 </span>            :     {
<span class="lineNum">    1983 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    1984 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_constraint_of_table);</span>
<span class="lineNum">    1985 </span>            :     }
<span class="lineNum">    1986 </span>            :     /* ALTER TABLE ALTER [COLUMN] &lt;foo&gt; */
<span class="lineNum">    1987 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny) ||</span>
<span class="lineNum">    1988 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, MatchAny))</span>
<span class="lineNum">    1989 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TYPE&quot;, &quot;SET&quot;, &quot;RESET&quot;, &quot;RESTART&quot;, &quot;ADD&quot;, &quot;DROP&quot;);</span>
<span class="lineNum">    1990 </span>            :     /* ALTER TABLE ALTER [COLUMN] &lt;foo&gt; SET */
<span class="lineNum">    1991 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;SET&quot;) ||</span>
<span class="lineNum">    1992 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    1993 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;DEFAULT&quot;, &quot;NOT NULL&quot;, &quot;STATISTICS&quot;, &quot;STORAGE&quot;);</span>
<span class="lineNum">    1994 </span>            :     /* ALTER TABLE ALTER [COLUMN] &lt;foo&gt; SET ( */
<span class="lineNum">    1995 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;SET&quot;, &quot;(&quot;) ||</span>
<span class="lineNum">    1996 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, MatchAny, &quot;SET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    1997 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;n_distinct&quot;, &quot;n_distinct_inherited&quot;);</span>
<span class="lineNum">    1998 </span>            :     /* ALTER TABLE ALTER [COLUMN] &lt;foo&gt; SET STORAGE */
<span class="lineNum">    1999 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;SET&quot;, &quot;STORAGE&quot;) ||</span>
<span class="lineNum">    2000 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, MatchAny, &quot;SET&quot;, &quot;STORAGE&quot;))</span>
<span class="lineNum">    2001 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;PLAIN&quot;, &quot;EXTERNAL&quot;, &quot;EXTENDED&quot;, &quot;MAIN&quot;);</span>
<span class="lineNum">    2002 </span>            :     /* ALTER TABLE ALTER [COLUMN] &lt;foo&gt; SET STATISTICS */
<span class="lineNum">    2003 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;SET&quot;, &quot;STATISTICS&quot;) ||</span>
<span class="lineNum">    2004 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, MatchAny, &quot;SET&quot;, &quot;STATISTICS&quot;))</span>
<span class="lineNum">    2005 </span>            :     {
<span class="lineNum">    2006 </span>            :         /* Enforce no completion here, as an integer has to be specified */
<span class="lineNum">    2007 </span>            :     }
<span class="lineNum">    2008 </span>            :     /* ALTER TABLE ALTER [COLUMN] &lt;foo&gt; DROP */
<span class="lineNum">    2009 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, &quot;COLUMN&quot;, MatchAny, &quot;DROP&quot;) ||</span>
<span class="lineNum">    2010 </span><span class="lineNoCov">          0 :              Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ALTER&quot;, MatchAny, &quot;DROP&quot;))</span>
<span class="lineNum">    2011 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DEFAULT&quot;, &quot;IDENTITY&quot;, &quot;NOT NULL&quot;);</span>
<span class="lineNum">    2012 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;CLUSTER&quot;))</span>
<span class="lineNum">    2013 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2014 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;CLUSTER&quot;, &quot;ON&quot;))</span>
<span class="lineNum">    2015 </span>            :     {
<span class="lineNum">    2016 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    2017 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_index_of_table);</span>
<span class="lineNum">    2018 </span>            :     }
<span class="lineNum">    2019 </span>            :     /* If we have ALTER TABLE &lt;sth&gt; SET, provide list of attributes and '(' */
<span class="lineNum">    2020 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    2021 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;LOGGED&quot;, &quot;SCHEMA&quot;, &quot;TABLESPACE&quot;, &quot;UNLOGGED&quot;,</span>
<span class="lineNum">    2022 </span>            :                       &quot;WITH&quot;, &quot;WITHOUT&quot;);
<span class="lineNum">    2023 </span>            : 
<span class="lineNum">    2024 </span>            :     /*
<span class="lineNum">    2025 </span>            :      * If we have ALTER TABLE &lt;sth&gt; SET TABLESPACE provide a list of
<span class="lineNum">    2026 </span>            :      * tablespaces
<span class="lineNum">    2027 </span>            :      */
<span class="lineNum">    2028 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;SET&quot;, &quot;TABLESPACE&quot;))</span>
<span class="lineNum">    2029 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tablespaces);</span>
<span class="lineNum">    2030 </span>            :     /* If we have ALTER TABLE &lt;sth&gt; SET WITHOUT provide CLUSTER or OIDS */
<span class="lineNum">    2031 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;SET&quot;, &quot;WITHOUT&quot;))</span>
<span class="lineNum">    2032 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CLUSTER&quot;, &quot;OIDS&quot;);</span>
<span class="lineNum">    2033 </span>            :     /* ALTER TABLE &lt;foo&gt; RESET */
<span class="lineNum">    2034 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;RESET&quot;))</span>
<span class="lineNum">    2035 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2036 </span>            :     /* ALTER TABLE &lt;foo&gt; SET|RESET ( */
<span class="lineNum">    2037 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;SET|RESET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2038 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_LIST(table_storage_parameters);</span>
<span class="lineNum">    2039 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;REPLICA&quot;, &quot;IDENTITY&quot;, &quot;USING&quot;, &quot;INDEX&quot;))</span>
<span class="lineNum">    2040 </span>            :     {
<span class="lineNum">    2041 </span><span class="lineNoCov">          0 :         completion_info_charp = prev5_wd;</span>
<span class="lineNum">    2042 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_index_of_table);</span>
<span class="lineNum">    2043 </span>            :     }
<span class="lineNum">    2044 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;REPLICA&quot;, &quot;IDENTITY&quot;, &quot;USING&quot;))</span>
<span class="lineNum">    2045 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INDEX&quot;);</span>
<span class="lineNum">    2046 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;REPLICA&quot;, &quot;IDENTITY&quot;))</span>
<span class="lineNum">    2047 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FULL&quot;, &quot;NOTHING&quot;, &quot;DEFAULT&quot;, &quot;USING&quot;);</span>
<span class="lineNum">    2048 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;REPLICA&quot;))</span>
<span class="lineNum">    2049 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;IDENTITY&quot;);</span>
<span class="lineNum">    2050 </span>            : 
<span class="lineNum">    2051 </span>            :     /*
<span class="lineNum">    2052 </span>            :      * If we have ALTER TABLE &lt;foo&gt; ATTACH PARTITION, provide a list of
<span class="lineNum">    2053 </span>            :      * tables.
<span class="lineNum">    2054 </span>            :      */
<span class="lineNum">    2055 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;ATTACH&quot;, &quot;PARTITION&quot;))</span>
<span class="lineNum">    2056 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, &quot;&quot;);</span>
<span class="lineNum">    2057 </span>            :     /* Limited completion support for partition bound specification */
<span class="lineNum">    2058 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;ATTACH&quot;, &quot;PARTITION&quot;, MatchAny))</span>
<span class="lineNum">    2059 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOR VALUES&quot;, &quot;DEFAULT&quot;);</span>
<span class="lineNum">    2060 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FOR&quot;, &quot;VALUES&quot;))</span>
<span class="lineNum">    2061 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FROM (&quot;, &quot;IN (&quot;, &quot;WITH (&quot;);</span>
<span class="lineNum">    2062 </span>            : 
<span class="lineNum">    2063 </span>            :     /*
<span class="lineNum">    2064 </span>            :      * If we have ALTER TABLE &lt;foo&gt; DETACH PARTITION, provide a list of
<span class="lineNum">    2065 </span>            :      * partitions of &lt;foo&gt;.
<span class="lineNum">    2066 </span>            :      */
<span class="lineNum">    2067 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLE&quot;, MatchAny, &quot;DETACH&quot;, &quot;PARTITION&quot;))</span>
<span class="lineNum">    2068 </span>            :     {
<span class="lineNum">    2069 </span><span class="lineNoCov">          0 :         completion_info_charp = prev3_wd;</span>
<span class="lineNum">    2070 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_partition_of_table);</span>
<span class="lineNum">    2071 </span>            :     }
<span class="lineNum">    2072 </span>            : 
<span class="lineNum">    2073 </span>            :     /* ALTER TABLESPACE &lt;foo&gt; with RENAME TO, OWNER TO, SET, RESET */
<span class="lineNum">    2074 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLESPACE&quot;, MatchAny))</span>
<span class="lineNum">    2075 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RENAME TO&quot;, &quot;OWNER TO&quot;, &quot;SET&quot;, &quot;RESET&quot;);</span>
<span class="lineNum">    2076 </span>            :     /* ALTER TABLESPACE &lt;foo&gt; SET|RESET */
<span class="lineNum">    2077 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLESPACE&quot;, MatchAny, &quot;SET|RESET&quot;))</span>
<span class="lineNum">    2078 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2079 </span>            :     /* ALTER TABLESPACE &lt;foo&gt; SET|RESET ( */
<span class="lineNum">    2080 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TABLESPACE&quot;, MatchAny, &quot;SET|RESET&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2081 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;seq_page_cost&quot;, &quot;random_page_cost&quot;,</span>
<span class="lineNum">    2082 </span>            :                       &quot;effective_io_concurrency&quot;);
<span class="lineNum">    2083 </span>            : 
<span class="lineNum">    2084 </span>            :     /* ALTER TEXT SEARCH */
<span class="lineNum">    2085 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;))</span>
<span class="lineNum">    2086 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONFIGURATION&quot;, &quot;DICTIONARY&quot;, &quot;PARSER&quot;, &quot;TEMPLATE&quot;);</span>
<span class="lineNum">    2087 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;, &quot;TEMPLATE|PARSER&quot;, MatchAny))</span>
<span class="lineNum">    2088 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;);</span>
<span class="lineNum">    2089 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;, &quot;DICTIONARY&quot;, MatchAny))</span>
<span class="lineNum">    2090 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;);</span>
<span class="lineNum">    2091 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;, &quot;CONFIGURATION&quot;, MatchAny))</span>
<span class="lineNum">    2092 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD MAPPING FOR&quot;, &quot;ALTER MAPPING&quot;,</span>
<span class="lineNum">    2093 </span>            :                       &quot;DROP MAPPING FOR&quot;,
<span class="lineNum">    2094 </span>            :                       &quot;OWNER TO&quot;, &quot;RENAME TO&quot;, &quot;SET SCHEMA&quot;);
<span class="lineNum">    2095 </span>            : 
<span class="lineNum">    2096 </span>            :     /* complete ALTER TYPE &lt;foo&gt; with actions */
<span class="lineNum">    2097 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny))</span>
<span class="lineNum">    2098 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD ATTRIBUTE&quot;, &quot;ADD VALUE&quot;, &quot;ALTER ATTRIBUTE&quot;,</span>
<span class="lineNum">    2099 </span>            :                       &quot;DROP ATTRIBUTE&quot;,
<span class="lineNum">    2100 </span>            :                       &quot;OWNER TO&quot;, &quot;RENAME&quot;, &quot;SET SCHEMA&quot;);
<span class="lineNum">    2101 </span>            :     /* complete ALTER TYPE &lt;foo&gt; ADD with actions */
<span class="lineNum">    2102 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny, &quot;ADD&quot;))</span>
<span class="lineNum">    2103 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ATTRIBUTE&quot;, &quot;VALUE&quot;);</span>
<span class="lineNum">    2104 </span>            :     /* ALTER TYPE &lt;foo&gt; RENAME    */
<span class="lineNum">    2105 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny, &quot;RENAME&quot;))</span>
<span class="lineNum">    2106 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ATTRIBUTE&quot;, &quot;TO&quot;, &quot;VALUE&quot;);</span>
<span class="lineNum">    2107 </span>            :     /* ALTER TYPE xxx RENAME (ATTRIBUTE|VALUE) yyy */
<span class="lineNum">    2108 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny, &quot;RENAME&quot;, &quot;ATTRIBUTE|VALUE&quot;, MatchAny))</span>
<span class="lineNum">    2109 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    2110 </span>            : 
<span class="lineNum">    2111 </span>            :     /*
<span class="lineNum">    2112 </span>            :      * If we have ALTER TYPE &lt;sth&gt; ALTER/DROP/RENAME ATTRIBUTE, provide list
<span class="lineNum">    2113 </span>            :      * of attributes
<span class="lineNum">    2114 </span>            :      */
<span class="lineNum">    2115 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny, &quot;ALTER|DROP|RENAME&quot;, &quot;ATTRIBUTE&quot;))</span>
<span class="lineNum">    2116 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev3_wd, &quot;&quot;);</span>
<span class="lineNum">    2117 </span>            :     /* ALTER TYPE ALTER ATTRIBUTE &lt;foo&gt; */
<span class="lineNum">    2118 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny, &quot;ALTER&quot;, &quot;ATTRIBUTE&quot;, MatchAny))</span>
<span class="lineNum">    2119 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TYPE&quot;);</span>
<span class="lineNum">    2120 </span>            :     /* complete ALTER GROUP &lt;foo&gt; */
<span class="lineNum">    2121 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;GROUP&quot;, MatchAny))</span>
<span class="lineNum">    2122 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADD USER&quot;, &quot;DROP USER&quot;, &quot;RENAME TO&quot;);</span>
<span class="lineNum">    2123 </span>            :     /* complete ALTER GROUP &lt;foo&gt; ADD|DROP with USER */
<span class="lineNum">    2124 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;GROUP&quot;, MatchAny, &quot;ADD|DROP&quot;))</span>
<span class="lineNum">    2125 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;USER&quot;);</span>
<span class="lineNum">    2126 </span>            :     /* complete ALTER GROUP &lt;foo&gt; ADD|DROP USER with a user name */
<span class="lineNum">    2127 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;GROUP&quot;, MatchAny, &quot;ADD|DROP&quot;, &quot;USER&quot;))</span>
<span class="lineNum">    2128 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    2129 </span>            : 
<span class="lineNum">    2130 </span>            :     /*
<span class="lineNum">    2131 </span>            :      * If we have ALTER TYPE &lt;sth&gt; RENAME VALUE, provide list of enum values
<span class="lineNum">    2132 </span>            :      */
<span class="lineNum">    2133 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER&quot;, &quot;TYPE&quot;, MatchAny, &quot;RENAME&quot;, &quot;VALUE&quot;))</span>
<span class="lineNum">    2134 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ENUM_VALUE(prev3_wd);</span>
<span class="lineNum">    2135 </span>            : 
<span class="lineNum">    2136 </span>            : /*
<span class="lineNum">    2137 </span>            :  * ANALYZE [ ( option [, ...] ) ] [ table_and_columns [, ...] ]
<span class="lineNum">    2138 </span>            :  * ANALYZE [ VERBOSE ] [ table_and_columns [, ...] ]
<span class="lineNum">    2139 </span>            :  */
<span class="lineNum">    2140 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ANALYZE&quot;))</span>
<span class="lineNum">    2141 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_analyzables,</span>
<span class="lineNum">    2142 </span>            :                                    &quot; UNION SELECT 'VERBOSE'&quot;);
<span class="lineNum">    2143 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ANALYZE&quot;, &quot;(*&quot;) &amp;&amp;</span>
<span class="lineNum">    2144 </span><span class="lineNoCov">          0 :              !HeadMatches(&quot;ANALYZE&quot;, &quot;(*)&quot;))</span>
<span class="lineNum">    2145 </span>            :     {
<span class="lineNum">    2146 </span>            :         /*
<span class="lineNum">    2147 </span>            :          * This fires if we're in an unfinished parenthesized option list.
<span class="lineNum">    2148 </span>            :          * get_previous_words treats a completed parenthesized option list as
<span class="lineNum">    2149 </span>            :          * one word, so the above test is correct.
<span class="lineNum">    2150 </span>            :          */
<span class="lineNum">    2151 </span><span class="lineNoCov">          0 :         if (ends_with(prev_wd, '(') || ends_with(prev_wd, ','))</span>
<span class="lineNum">    2152 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;VERBOSE&quot;, &quot;SKIP_LOCKED&quot;);</span>
<span class="lineNum">    2153 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;VERBOSE|SKIP_LOCKED&quot;))</span>
<span class="lineNum">    2154 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;ON&quot;, &quot;OFF&quot;);</span>
<span class="lineNum">    2155 </span>            :     }
<span class="lineNum">    2156 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ANALYZE&quot;) &amp;&amp; TailMatches(&quot;(&quot;))</span>
<span class="lineNum">    2157 </span>            :         /* &quot;ANALYZE (&quot; should be caught above, so assume we want columns */
<span class="lineNum">    2158 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot;&quot;);</span>
<span class="lineNum">    2159 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ANALYZE&quot;))</span>
<span class="lineNum">    2160 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_analyzables, NULL);</span>
<span class="lineNum">    2161 </span>            : 
<span class="lineNum">    2162 </span>            : /* BEGIN */
<span class="lineNum">    2163 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;BEGIN&quot;))</span>
<span class="lineNum">    2164 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WORK&quot;, &quot;TRANSACTION&quot;, &quot;ISOLATION LEVEL&quot;, &quot;READ&quot;, &quot;DEFERRABLE&quot;, &quot;NOT DEFERRABLE&quot;);</span>
<span class="lineNum">    2165 </span>            : /* END, ABORT */
<span class="lineNum">    2166 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;END|ABORT&quot;))</span>
<span class="lineNum">    2167 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AND&quot;, &quot;WORK&quot;, &quot;TRANSACTION&quot;);</span>
<span class="lineNum">    2168 </span>            : /* COMMIT */
<span class="lineNum">    2169 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMIT&quot;))</span>
<span class="lineNum">    2170 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AND&quot;, &quot;WORK&quot;, &quot;TRANSACTION&quot;, &quot;PREPARED&quot;);</span>
<span class="lineNum">    2171 </span>            : /* RELEASE SAVEPOINT */
<span class="lineNum">    2172 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;RELEASE&quot;))</span>
<span class="lineNum">    2173 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SAVEPOINT&quot;);</span>
<span class="lineNum">    2174 </span>            : /* ROLLBACK */
<span class="lineNum">    2175 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ROLLBACK&quot;))</span>
<span class="lineNum">    2176 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AND&quot;, &quot;WORK&quot;, &quot;TRANSACTION&quot;, &quot;TO SAVEPOINT&quot;, &quot;PREPARED&quot;);</span>
<span class="lineNum">    2177 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ABORT|END|COMMIT|ROLLBACK&quot;, &quot;AND&quot;))</span>
<span class="lineNum">    2178 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CHAIN&quot;);</span>
<span class="lineNum">    2179 </span>            : /* CALL */
<span class="lineNum">    2180 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CALL&quot;))</span>
<span class="lineNum">    2181 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_procedures, NULL);</span>
<span class="lineNum">    2182 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CALL&quot;, MatchAny))</span>
<span class="lineNum">    2183 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2184 </span>            : /* CLUSTER */
<span class="lineNum">    2185 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CLUSTER&quot;))</span>
<span class="lineNum">    2186 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_clusterables, &quot;UNION SELECT 'VERBOSE'&quot;);</span>
<span class="lineNum">    2187 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CLUSTER&quot;, &quot;VERBOSE&quot;))</span>
<span class="lineNum">    2188 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_clusterables, NULL);</span>
<span class="lineNum">    2189 </span>            :     /* If we have CLUSTER &lt;sth&gt;, then add &quot;USING&quot; */
<span class="lineNum">    2190 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CLUSTER&quot;, MatchAnyExcept(&quot;VERBOSE|ON&quot;)))</span>
<span class="lineNum">    2191 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;USING&quot;);</span>
<span class="lineNum">    2192 </span>            :     /* If we have CLUSTER VERBOSE &lt;sth&gt;, then add &quot;USING&quot; */
<span class="lineNum">    2193 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CLUSTER&quot;, &quot;VERBOSE&quot;, MatchAny))</span>
<span class="lineNum">    2194 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;USING&quot;);</span>
<span class="lineNum">    2195 </span>            :     /* If we have CLUSTER &lt;sth&gt; USING, then add the index as well */
<span class="lineNum">    2196 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CLUSTER&quot;, MatchAny, &quot;USING&quot;) ||</span>
<span class="lineNum">    2197 </span><span class="lineNoCov">          0 :              Matches(&quot;CLUSTER&quot;, &quot;VERBOSE&quot;, MatchAny, &quot;USING&quot;))</span>
<span class="lineNum">    2198 </span>            :     {
<span class="lineNum">    2199 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    2200 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_index_of_table);</span>
<span class="lineNum">    2201 </span>            :     }
<span class="lineNum">    2202 </span>            : 
<span class="lineNum">    2203 </span>            : /* COMMENT */
<span class="lineNum">    2204 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;))</span>
<span class="lineNum">    2205 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2206 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;))</span>
<span class="lineNum">    2207 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ACCESS METHOD&quot;, &quot;CAST&quot;, &quot;COLLATION&quot;, &quot;CONVERSION&quot;,</span>
<span class="lineNum">    2208 </span>            :                       &quot;DATABASE&quot;, &quot;EVENT TRIGGER&quot;, &quot;EXTENSION&quot;,
<span class="lineNum">    2209 </span>            :                       &quot;FOREIGN DATA WRAPPER&quot;, &quot;FOREIGN TABLE&quot;, &quot;SERVER&quot;,
<span class="lineNum">    2210 </span>            :                       &quot;INDEX&quot;, &quot;LANGUAGE&quot;, &quot;POLICY&quot;, &quot;PUBLICATION&quot;, &quot;RULE&quot;,
<span class="lineNum">    2211 </span>            :                       &quot;SCHEMA&quot;, &quot;SEQUENCE&quot;, &quot;STATISTICS&quot;, &quot;SUBSCRIPTION&quot;,
<span class="lineNum">    2212 </span>            :                       &quot;TABLE&quot;, &quot;TYPE&quot;, &quot;VIEW&quot;, &quot;MATERIALIZED VIEW&quot;,
<span class="lineNum">    2213 </span>            :                       &quot;COLUMN&quot;, &quot;AGGREGATE&quot;, &quot;FUNCTION&quot;,
<span class="lineNum">    2214 </span>            :                       &quot;PROCEDURE&quot;, &quot;ROUTINE&quot;,
<span class="lineNum">    2215 </span>            :                       &quot;OPERATOR&quot;, &quot;TRIGGER&quot;, &quot;CONSTRAINT&quot;, &quot;DOMAIN&quot;,
<span class="lineNum">    2216 </span>            :                       &quot;LARGE OBJECT&quot;, &quot;TABLESPACE&quot;, &quot;TEXT SEARCH&quot;, &quot;ROLE&quot;);
<span class="lineNum">    2217 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;ACCESS&quot;, &quot;METHOD&quot;))</span>
<span class="lineNum">    2218 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_access_methods);</span>
<span class="lineNum">    2219 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    2220 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA WRAPPER&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    2221 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;))</span>
<span class="lineNum">    2222 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONFIGURATION&quot;, &quot;DICTIONARY&quot;, &quot;PARSER&quot;, &quot;TEMPLATE&quot;);</span>
<span class="lineNum">    2223 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;CONSTRAINT&quot;))</span>
<span class="lineNum">    2224 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_all_table_constraints);</span>
<span class="lineNum">    2225 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;CONSTRAINT&quot;, MatchAny))</span>
<span class="lineNum">    2226 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2227 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;CONSTRAINT&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2228 </span>            :     {
<span class="lineNum">    2229 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    2230 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_constraint);</span>
<span class="lineNum">    2231 </span>            :     }
<span class="lineNum">    2232 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;))</span>
<span class="lineNum">    2233 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_matviews, NULL);</span>
<span class="lineNum">    2234 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;))</span>
<span class="lineNum">    2235 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_event_triggers);</span>
<span class="lineNum">    2236 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COMMENT&quot;, &quot;ON&quot;, MatchAny, MatchAnyExcept(&quot;IS&quot;)) ||</span>
<span class="lineNum">    2237 </span><span class="lineNoCov">          0 :              Matches(&quot;COMMENT&quot;, &quot;ON&quot;, MatchAny, MatchAny, MatchAnyExcept(&quot;IS&quot;)) ||</span>
<span class="lineNum">    2238 </span><span class="lineNoCov">          0 :              Matches(&quot;COMMENT&quot;, &quot;ON&quot;, MatchAny, MatchAny, MatchAny, MatchAnyExcept(&quot;IS&quot;)))</span>
<span class="lineNum">    2239 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;IS&quot;);</span>
<span class="lineNum">    2240 </span>            : 
<span class="lineNum">    2241 </span>            : /* COPY */
<span class="lineNum">    2242 </span>            : 
<span class="lineNum">    2243 </span>            :     /*
<span class="lineNum">    2244 </span>            :      * If we have COPY, offer list of tables or &quot;(&quot; (Also cover the analogous
<span class="lineNum">    2245 </span>            :      * backslash command).
<span class="lineNum">    2246 </span>            :      */
<span class="lineNum">    2247 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY|\\copy&quot;))</span>
<span class="lineNum">    2248 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables,</span>
<span class="lineNum">    2249 </span>            :                                    &quot; UNION ALL SELECT '('&quot;);
<span class="lineNum">    2250 </span>            :     /* If we have COPY BINARY, complete with list of tables */
<span class="lineNum">    2251 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY&quot;, &quot;BINARY&quot;))</span>
<span class="lineNum">    2252 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    2253 </span>            :     /* If we have COPY (, complete it with legal commands */
<span class="lineNum">    2254 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY|\\copy&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2255 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;TABLE&quot;, &quot;VALUES&quot;, &quot;INSERT&quot;, &quot;UPDATE&quot;, &quot;DELETE&quot;, &quot;WITH&quot;);</span>
<span class="lineNum">    2256 </span>            :     /* If we have COPY [BINARY] &lt;sth&gt;, complete it with &quot;TO&quot; or &quot;FROM&quot; */
<span class="lineNum">    2257 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY|\\copy&quot;, MatchAny) ||</span>
<span class="lineNum">    2258 </span><span class="lineNoCov">          0 :              Matches(&quot;COPY&quot;, &quot;BINARY&quot;, MatchAny))</span>
<span class="lineNum">    2259 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FROM&quot;, &quot;TO&quot;);</span>
<span class="lineNum">    2260 </span>            :     /* If we have COPY [BINARY] &lt;sth&gt; FROM|TO, complete with filename */
<span class="lineNum">    2261 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY|\\copy&quot;, MatchAny, &quot;FROM|TO&quot;) ||</span>
<span class="lineNum">    2262 </span><span class="lineNoCov">          0 :              Matches(&quot;COPY&quot;, &quot;BINARY&quot;, MatchAny, &quot;FROM|TO&quot;))</span>
<span class="lineNum">    2263 </span>            :     {
<span class="lineNum">    2264 </span><span class="lineNoCov">          0 :         completion_charp = &quot;&quot;;</span>
<span class="lineNum">    2265 </span><span class="lineNoCov">          0 :         matches = completion_matches(text, complete_from_files);</span>
<span class="lineNum">    2266 </span>            :     }
<span class="lineNum">    2267 </span>            : 
<span class="lineNum">    2268 </span>            :     /* Handle COPY [BINARY] &lt;sth&gt; FROM|TO filename */
<span class="lineNum">    2269 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY|\\copy&quot;, MatchAny, &quot;FROM|TO&quot;, MatchAny) ||</span>
<span class="lineNum">    2270 </span><span class="lineNoCov">          0 :              Matches(&quot;COPY&quot;, &quot;BINARY&quot;, MatchAny, &quot;FROM|TO&quot;, MatchAny))</span>
<span class="lineNum">    2271 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BINARY&quot;, &quot;DELIMITER&quot;, &quot;NULL&quot;, &quot;CSV&quot;,</span>
<span class="lineNum">    2272 </span>            :                       &quot;ENCODING&quot;);
<span class="lineNum">    2273 </span>            : 
<span class="lineNum">    2274 </span>            :     /* Handle COPY [BINARY] &lt;sth&gt; FROM|TO filename CSV */
<span class="lineNum">    2275 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;COPY|\\copy&quot;, MatchAny, &quot;FROM|TO&quot;, MatchAny, &quot;CSV&quot;) ||</span>
<span class="lineNum">    2276 </span><span class="lineNoCov">          0 :              Matches(&quot;COPY&quot;, &quot;BINARY&quot;, MatchAny, &quot;FROM|TO&quot;, MatchAny, &quot;CSV&quot;))</span>
<span class="lineNum">    2277 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;HEADER&quot;, &quot;QUOTE&quot;, &quot;ESCAPE&quot;, &quot;FORCE QUOTE&quot;,</span>
<span class="lineNum">    2278 </span>            :                       &quot;FORCE NOT NULL&quot;);
<span class="lineNum">    2279 </span>            : 
<span class="lineNum">    2280 </span>            :     /* CREATE ACCESS METHOD */
<span class="lineNum">    2281 </span>            :     /* Complete &quot;CREATE ACCESS METHOD &lt;name&gt;&quot; */
<span class="lineNum">    2282 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;ACCESS&quot;, &quot;METHOD&quot;, MatchAny))</span>
<span class="lineNum">    2283 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TYPE&quot;);</span>
<span class="lineNum">    2284 </span>            :     /* Complete &quot;CREATE ACCESS METHOD &lt;name&gt; TYPE&quot; */
<span class="lineNum">    2285 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;ACCESS&quot;, &quot;METHOD&quot;, MatchAny, &quot;TYPE&quot;))</span>
<span class="lineNum">    2286 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INDEX&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    2287 </span>            :     /* Complete &quot;CREATE ACCESS METHOD &lt;name&gt; TYPE &lt;type&gt;&quot; */
<span class="lineNum">    2288 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;ACCESS&quot;, &quot;METHOD&quot;, MatchAny, &quot;TYPE&quot;, MatchAny))</span>
<span class="lineNum">    2289 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;HANDLER&quot;);</span>
<span class="lineNum">    2290 </span>            : 
<span class="lineNum">    2291 </span>            :     /* CREATE DATABASE */
<span class="lineNum">    2292 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;DATABASE&quot;, MatchAny))</span>
<span class="lineNum">    2293 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER&quot;, &quot;TEMPLATE&quot;, &quot;ENCODING&quot;, &quot;TABLESPACE&quot;,</span>
<span class="lineNum">    2294 </span>            :                       &quot;IS_TEMPLATE&quot;,
<span class="lineNum">    2295 </span>            :                       &quot;ALLOW_CONNECTIONS&quot;, &quot;CONNECTION LIMIT&quot;,
<span class="lineNum">    2296 </span>            :                       &quot;LC_COLLATE&quot;, &quot;LC_CTYPE&quot;);
<span class="lineNum">    2297 </span>            : 
<span class="lineNum">    2298 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;DATABASE&quot;, MatchAny, &quot;TEMPLATE&quot;))</span>
<span class="lineNum">    2299 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_template_databases);</span>
<span class="lineNum">    2300 </span>            : 
<span class="lineNum">    2301 </span>            :     /* CREATE EXTENSION */
<span class="lineNum">    2302 </span>            :     /* Complete with available extensions rather than installed ones. */
<span class="lineNum">    2303 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EXTENSION&quot;))</span>
<span class="lineNum">    2304 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_available_extensions);</span>
<span class="lineNum">    2305 </span>            :     /* CREATE EXTENSION &lt;name&gt; */
<span class="lineNum">    2306 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EXTENSION&quot;, MatchAny))</span>
<span class="lineNum">    2307 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH SCHEMA&quot;, &quot;CASCADE&quot;, &quot;VERSION&quot;);</span>
<span class="lineNum">    2308 </span>            :     /* CREATE EXTENSION &lt;name&gt; VERSION */
<span class="lineNum">    2309 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EXTENSION&quot;, MatchAny, &quot;VERSION&quot;))</span>
<span class="lineNum">    2310 </span>            :     {
<span class="lineNum">    2311 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    2312 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_available_extension_versions);</span>
<span class="lineNum">    2313 </span>            :     }
<span class="lineNum">    2314 </span>            : 
<span class="lineNum">    2315 </span>            :     /* CREATE FOREIGN */
<span class="lineNum">    2316 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    2317 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA WRAPPER&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    2318 </span>            : 
<span class="lineNum">    2319 </span>            :     /* CREATE FOREIGN DATA WRAPPER */
<span class="lineNum">    2320 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;FOREIGN&quot;, &quot;DATA&quot;, &quot;WRAPPER&quot;, MatchAny))</span>
<span class="lineNum">    2321 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;HANDLER&quot;, &quot;VALIDATOR&quot;, &quot;OPTIONS&quot;);</span>
<span class="lineNum">    2322 </span>            : 
<span class="lineNum">    2323 </span>            :     /* CREATE INDEX --- is allowed inside CREATE SCHEMA, so use TailMatches */
<span class="lineNum">    2324 </span>            :     /* First off we complete CREATE UNIQUE with &quot;INDEX&quot; */
<span class="lineNum">    2325 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;UNIQUE&quot;))</span>
<span class="lineNum">    2326 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INDEX&quot;);</span>
<span class="lineNum">    2327 </span>            : 
<span class="lineNum">    2328 </span>            :     /*
<span class="lineNum">    2329 </span>            :      * If we have CREATE|UNIQUE INDEX, then add &quot;ON&quot;, &quot;CONCURRENTLY&quot;, and
<span class="lineNum">    2330 </span>            :      * existing indexes
<span class="lineNum">    2331 </span>            :      */
<span class="lineNum">    2332 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE|UNIQUE&quot;, &quot;INDEX&quot;))</span>
<span class="lineNum">    2333 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes,</span>
<span class="lineNum">    2334 </span>            :                                    &quot; UNION SELECT 'ON'&quot;
<span class="lineNum">    2335 </span>            :                                    &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    2336 </span>            : 
<span class="lineNum">    2337 </span>            :     /*
<span class="lineNum">    2338 </span>            :      * Complete ... INDEX|CONCURRENTLY [&lt;name&gt;] ON with a list of relations
<span class="lineNum">    2339 </span>            :      * that indexes can be created on
<span class="lineNum">    2340 </span>            :      */
<span class="lineNum">    2341 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INDEX|CONCURRENTLY&quot;, MatchAny, &quot;ON&quot;) ||</span>
<span class="lineNum">    2342 </span><span class="lineNoCov">          0 :              TailMatches(&quot;INDEX|CONCURRENTLY&quot;, &quot;ON&quot;))</span>
<span class="lineNum">    2343 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexables, NULL);</span>
<span class="lineNum">    2344 </span>            : 
<span class="lineNum">    2345 </span>            :     /*
<span class="lineNum">    2346 </span>            :      * Complete CREATE|UNIQUE INDEX CONCURRENTLY with &quot;ON&quot; and existing
<span class="lineNum">    2347 </span>            :      * indexes
<span class="lineNum">    2348 </span>            :      */
<span class="lineNum">    2349 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE|UNIQUE&quot;, &quot;INDEX&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    2350 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes,</span>
<span class="lineNum">    2351 </span>            :                                    &quot; UNION SELECT 'ON'&quot;);
<span class="lineNum">    2352 </span>            :     /* Complete CREATE|UNIQUE INDEX [CONCURRENTLY] &lt;sth&gt; with &quot;ON&quot; */
<span class="lineNum">    2353 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE|UNIQUE&quot;, &quot;INDEX&quot;, MatchAny) ||</span>
<span class="lineNum">    2354 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE|UNIQUE&quot;, &quot;INDEX&quot;, &quot;CONCURRENTLY&quot;, MatchAny))</span>
<span class="lineNum">    2355 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2356 </span>            : 
<span class="lineNum">    2357 </span>            :     /*
<span class="lineNum">    2358 </span>            :      * Complete INDEX &lt;name&gt; ON &lt;table&gt; with a list of table columns (which
<span class="lineNum">    2359 </span>            :      * should really be in parens)
<span class="lineNum">    2360 </span>            :      */
<span class="lineNum">    2361 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INDEX&quot;, MatchAny, &quot;ON&quot;, MatchAny) ||</span>
<span class="lineNum">    2362 </span><span class="lineNoCov">          0 :              TailMatches(&quot;INDEX|CONCURRENTLY&quot;, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    2363 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;USING&quot;);</span>
<span class="lineNum">    2364 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INDEX&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;(&quot;) ||</span>
<span class="lineNum">    2365 </span><span class="lineNoCov">          0 :              TailMatches(&quot;INDEX|CONCURRENTLY&quot;, &quot;ON&quot;, MatchAny, &quot;(&quot;))</span>
<span class="lineNum">    2366 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot;&quot;);</span>
<span class="lineNum">    2367 </span>            :     /* same if you put in USING */
<span class="lineNum">    2368 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;ON&quot;, MatchAny, &quot;USING&quot;, MatchAny, &quot;(&quot;))</span>
<span class="lineNum">    2369 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev4_wd, &quot;&quot;);</span>
<span class="lineNum">    2370 </span>            :     /* Complete USING with an index method */
<span class="lineNum">    2371 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INDEX&quot;, MatchAny, MatchAny, &quot;ON&quot;, MatchAny, &quot;USING&quot;) ||</span>
<span class="lineNum">    2372 </span><span class="lineNoCov">          0 :              TailMatches(&quot;INDEX&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;USING&quot;) ||</span>
<span class="lineNum">    2373 </span><span class="lineNoCov">          0 :              TailMatches(&quot;INDEX&quot;, &quot;ON&quot;, MatchAny, &quot;USING&quot;))</span>
<span class="lineNum">    2374 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_index_access_methods);</span>
<span class="lineNum">    2375 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;ON&quot;, MatchAny, &quot;USING&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    2376 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;POLICY&quot;, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny) &amp;&amp;</span>
<span class="lineNum">    2377 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;FOR&quot;, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    2378 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2379 </span>            : 
<span class="lineNum">    2380 </span>            :     /* CREATE OR REPLACE */
<span class="lineNum">    2381 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;OR&quot;))</span>
<span class="lineNum">    2382 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;REPLACE&quot;);</span>
<span class="lineNum">    2383 </span>            : 
<span class="lineNum">    2384 </span>            :     /* CREATE POLICY */
<span class="lineNum">    2385 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON&quot; */
<span class="lineNum">    2386 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny))</span>
<span class="lineNum">    2387 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2388 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt;&quot; */
<span class="lineNum">    2389 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2390 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    2391 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS|FOR|TO|USING|WITH CHECK&quot; */
<span class="lineNum">    2392 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    2393 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AS&quot;, &quot;FOR&quot;, &quot;TO&quot;, &quot;USING (&quot;, &quot;WITH CHECK (&quot;);</span>
<span class="lineNum">    2394 </span>            :     /* CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE */
<span class="lineNum">    2395 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;))</span>
<span class="lineNum">    2396 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;PERMISSIVE&quot;, &quot;RESTRICTIVE&quot;);</span>
<span class="lineNum">    2397 </span>            : 
<span class="lineNum">    2398 </span>            :     /*
<span class="lineNum">    2399 </span>            :      * CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE
<span class="lineNum">    2400 </span>            :      * FOR|TO|USING|WITH CHECK
<span class="lineNum">    2401 </span>            :      */
<span class="lineNum">    2402 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny))</span>
<span class="lineNum">    2403 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOR&quot;, &quot;TO&quot;, &quot;USING&quot;, &quot;WITH CHECK&quot;);</span>
<span class="lineNum">    2404 </span>            :     /* CREATE POLICY &lt;name&gt; ON &lt;table&gt; FOR ALL|SELECT|INSERT|UPDATE|DELETE */
<span class="lineNum">    2405 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;FOR&quot;))</span>
<span class="lineNum">    2406 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALL&quot;, &quot;SELECT&quot;, &quot;INSERT&quot;, &quot;UPDATE&quot;, &quot;DELETE&quot;);</span>
<span class="lineNum">    2407 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; FOR INSERT TO|WITH CHECK&quot; */
<span class="lineNum">    2408 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;FOR&quot;, &quot;INSERT&quot;))</span>
<span class="lineNum">    2409 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;, &quot;WITH CHECK (&quot;);</span>
<span class="lineNum">    2410 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; FOR SELECT|DELETE TO|USING&quot; */
<span class="lineNum">    2411 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;FOR&quot;, &quot;SELECT|DELETE&quot;))</span>
<span class="lineNum">    2412 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;, &quot;USING (&quot;);</span>
<span class="lineNum">    2413 </span>            :     /* CREATE POLICY &lt;name&gt; ON &lt;table&gt; FOR ALL|UPDATE TO|USING|WITH CHECK */
<span class="lineNum">    2414 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;FOR&quot;, &quot;ALL|UPDATE&quot;))</span>
<span class="lineNum">    2415 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;, &quot;USING (&quot;, &quot;WITH CHECK (&quot;);</span>
<span class="lineNum">    2416 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; TO &lt;role&gt;&quot; */
<span class="lineNum">    2417 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;TO&quot;))</span>
<span class="lineNum">    2418 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_grant_roles);</span>
<span class="lineNum">    2419 </span>            :     /* Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; USING (&quot; */
<span class="lineNum">    2420 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;USING&quot;))</span>
<span class="lineNum">    2421 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2422 </span>            : 
<span class="lineNum">    2423 </span>            :     /*
<span class="lineNum">    2424 </span>            :      * CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE FOR
<span class="lineNum">    2425 </span>            :      * ALL|SELECT|INSERT|UPDATE|DELETE
<span class="lineNum">    2426 </span>            :      */
<span class="lineNum">    2427 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny, &quot;FOR&quot;))</span>
<span class="lineNum">    2428 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALL&quot;, &quot;SELECT&quot;, &quot;INSERT&quot;, &quot;UPDATE&quot;, &quot;DELETE&quot;);</span>
<span class="lineNum">    2429 </span>            : 
<span class="lineNum">    2430 </span>            :     /*
<span class="lineNum">    2431 </span>            :      * Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE FOR
<span class="lineNum">    2432 </span>            :      * INSERT TO|WITH CHECK&quot;
<span class="lineNum">    2433 </span>            :      */
<span class="lineNum">    2434 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny, &quot;FOR&quot;, &quot;INSERT&quot;))</span>
<span class="lineNum">    2435 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;, &quot;WITH CHECK (&quot;);</span>
<span class="lineNum">    2436 </span>            : 
<span class="lineNum">    2437 </span>            :     /*
<span class="lineNum">    2438 </span>            :      * Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE FOR
<span class="lineNum">    2439 </span>            :      * SELECT|DELETE TO|USING&quot;
<span class="lineNum">    2440 </span>            :      */
<span class="lineNum">    2441 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny, &quot;FOR&quot;, &quot;SELECT|DELETE&quot;))</span>
<span class="lineNum">    2442 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;, &quot;USING (&quot;);</span>
<span class="lineNum">    2443 </span>            : 
<span class="lineNum">    2444 </span>            :     /*
<span class="lineNum">    2445 </span>            :      * CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE FOR
<span class="lineNum">    2446 </span>            :      * ALL|UPDATE TO|USING|WITH CHECK
<span class="lineNum">    2447 </span>            :      */
<span class="lineNum">    2448 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny, &quot;FOR&quot;, &quot;ALL|UPDATE&quot;))</span>
<span class="lineNum">    2449 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;, &quot;USING (&quot;, &quot;WITH CHECK (&quot;);</span>
<span class="lineNum">    2450 </span>            : 
<span class="lineNum">    2451 </span>            :     /*
<span class="lineNum">    2452 </span>            :      * Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE TO
<span class="lineNum">    2453 </span>            :      * &lt;role&gt;&quot;
<span class="lineNum">    2454 </span>            :      */
<span class="lineNum">    2455 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny, &quot;TO&quot;))</span>
<span class="lineNum">    2456 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_grant_roles);</span>
<span class="lineNum">    2457 </span>            : 
<span class="lineNum">    2458 </span>            :     /*
<span class="lineNum">    2459 </span>            :      * Complete &quot;CREATE POLICY &lt;name&gt; ON &lt;table&gt; AS PERMISSIVE|RESTRICTIVE
<span class="lineNum">    2460 </span>            :      * USING (&quot;
<span class="lineNum">    2461 </span>            :      */
<span class="lineNum">    2462 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;, MatchAny, &quot;AS&quot;, MatchAny, &quot;USING&quot;))</span>
<span class="lineNum">    2463 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2464 </span>            : 
<span class="lineNum">    2465 </span>            : 
<span class="lineNum">    2466 </span>            : /* CREATE PUBLICATION */
<span class="lineNum">    2467 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;PUBLICATION&quot;, MatchAny))</span>
<span class="lineNum">    2468 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOR TABLE&quot;, &quot;FOR ALL TABLES&quot;, &quot;WITH (&quot;);</span>
<span class="lineNum">    2469 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;PUBLICATION&quot;, MatchAny, &quot;FOR&quot;))</span>
<span class="lineNum">    2470 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TABLE&quot;, &quot;ALL TABLES&quot;);</span>
<span class="lineNum">    2471 </span>            :     /* Complete &quot;CREATE PUBLICATION &lt;name&gt; FOR TABLE &lt;table&gt;, ...&quot; */
<span class="lineNum">    2472 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;PUBLICATION&quot;, MatchAny, &quot;FOR&quot;, &quot;TABLE&quot;))</span>
<span class="lineNum">    2473 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    2474 </span>            :     /* Complete &quot;CREATE PUBLICATION &lt;name&gt; [...] WITH&quot; */
<span class="lineNum">    2475 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;PUBLICATION&quot;) &amp;&amp; TailMatches(&quot;WITH&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2476 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;publish&quot;);</span>
<span class="lineNum">    2477 </span>            : 
<span class="lineNum">    2478 </span>            : /* CREATE RULE */
<span class="lineNum">    2479 </span>            :     /* Complete &quot;CREATE [ OR REPLACE ] RULE &lt;sth&gt;&quot; with &quot;AS ON&quot; */
<span class="lineNum">    2480 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;RULE&quot;, MatchAny) ||</span>
<span class="lineNum">    2481 </span><span class="lineNoCov">          0 :              Matches(&quot;CREATE&quot;, &quot;OR&quot;, &quot;REPLACE&quot;, &quot;RULE&quot;, MatchAny))</span>
<span class="lineNum">    2482 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AS ON&quot;);</span>
<span class="lineNum">    2483 </span>            :     /* Complete &quot;CREATE [ OR REPLACE ] RULE &lt;sth&gt; AS&quot; with &quot;ON&quot; */
<span class="lineNum">    2484 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;RULE&quot;, MatchAny, &quot;AS&quot;) ||</span>
<span class="lineNum">    2485 </span><span class="lineNoCov">          0 :              Matches(&quot;CREATE&quot;, &quot;OR&quot;, &quot;REPLACE&quot;, &quot;RULE&quot;, MatchAny, &quot;AS&quot;))</span>
<span class="lineNum">    2486 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2487 </span>            :     /* Complete &quot;CREATE [ OR REPLACE ] RULE &lt;sth&gt; AS ON&quot; with SELECT|UPDATE|INSERT|DELETE */
<span class="lineNum">    2488 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;RULE&quot;, MatchAny, &quot;AS&quot;, &quot;ON&quot;) ||</span>
<span class="lineNum">    2489 </span><span class="lineNoCov">          0 :              Matches(&quot;CREATE&quot;, &quot;OR&quot;, &quot;REPLACE&quot;, &quot;RULE&quot;, MatchAny, &quot;AS&quot;, &quot;ON&quot;))</span>
<span class="lineNum">    2490 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;UPDATE&quot;, &quot;INSERT&quot;, &quot;DELETE&quot;);</span>
<span class="lineNum">    2491 </span>            :     /* Complete &quot;AS ON SELECT|UPDATE|INSERT|DELETE&quot; with a &quot;TO&quot; */
<span class="lineNum">    2492 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;AS&quot;, &quot;ON&quot;, &quot;SELECT|UPDATE|INSERT|DELETE&quot;))</span>
<span class="lineNum">    2493 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    2494 </span>            :     /* Complete &quot;AS ON &lt;sth&gt; TO&quot; with a table name */
<span class="lineNum">    2495 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;AS&quot;, &quot;ON&quot;, &quot;SELECT|UPDATE|INSERT|DELETE&quot;, &quot;TO&quot;))</span>
<span class="lineNum">    2496 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    2497 </span>            : 
<span class="lineNum">    2498 </span>            : /* CREATE SEQUENCE --- is allowed inside CREATE SCHEMA, so use TailMatches */
<span class="lineNum">    2499 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;SEQUENCE&quot;, MatchAny) ||</span>
<span class="lineNum">    2500 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY&quot;, &quot;SEQUENCE&quot;, MatchAny))</span>
<span class="lineNum">    2501 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INCREMENT BY&quot;, &quot;MINVALUE&quot;, &quot;MAXVALUE&quot;, &quot;NO&quot;, &quot;CACHE&quot;,</span>
<span class="lineNum">    2502 </span>            :                       &quot;CYCLE&quot;, &quot;OWNED BY&quot;, &quot;START WITH&quot;);
<span class="lineNum">    2503 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;SEQUENCE&quot;, MatchAny, &quot;NO&quot;) ||</span>
<span class="lineNum">    2504 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY&quot;, &quot;SEQUENCE&quot;, MatchAny, &quot;NO&quot;))</span>
<span class="lineNum">    2505 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;MINVALUE&quot;, &quot;MAXVALUE&quot;, &quot;CYCLE&quot;);</span>
<span class="lineNum">    2506 </span>            : 
<span class="lineNum">    2507 </span>            : /* CREATE SERVER &lt;name&gt; */
<span class="lineNum">    2508 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;SERVER&quot;, MatchAny))</span>
<span class="lineNum">    2509 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TYPE&quot;, &quot;VERSION&quot;, &quot;FOREIGN DATA WRAPPER&quot;);</span>
<span class="lineNum">    2510 </span>            : 
<span class="lineNum">    2511 </span>            : /* CREATE STATISTICS &lt;name&gt; */
<span class="lineNum">    2512 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;STATISTICS&quot;, MatchAny))</span>
<span class="lineNum">    2513 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;ON&quot;);</span>
<span class="lineNum">    2514 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;STATISTICS&quot;, MatchAny, &quot;(&quot;))</span>
<span class="lineNum">    2515 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ndistinct&quot;, &quot;dependencies&quot;, &quot;mcv&quot;);</span>
<span class="lineNum">    2516 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;STATISTICS&quot;, MatchAny, &quot;(*)&quot;))</span>
<span class="lineNum">    2517 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2518 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;STATISTICS&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    2519 </span><span class="lineNoCov">          0 :              TailMatches(&quot;FROM&quot;))</span>
<span class="lineNum">    2520 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    2521 </span>            : 
<span class="lineNum">    2522 </span>            : /* CREATE TABLE --- is allowed inside CREATE SCHEMA, so use TailMatches */
<span class="lineNum">    2523 </span>            :     /* Complete &quot;CREATE TEMP/TEMPORARY&quot; with the possible temp objects */
<span class="lineNum">    2524 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY&quot;))</span>
<span class="lineNum">    2525 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SEQUENCE&quot;, &quot;TABLE&quot;, &quot;VIEW&quot;);</span>
<span class="lineNum">    2526 </span>            :     /* Complete &quot;CREATE UNLOGGED&quot; with TABLE or MATVIEW */
<span class="lineNum">    2527 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;UNLOGGED&quot;))</span>
<span class="lineNum">    2528 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TABLE&quot;, &quot;MATERIALIZED VIEW&quot;, &quot;INCREMENTAL MATERIALIZED VIEW&quot;);</span>
<span class="lineNum">    2529 </span>            :     /* Complete PARTITION BY with RANGE ( or LIST ( or ... */
<span class="lineNum">    2530 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;PARTITION&quot;, &quot;BY&quot;))</span>
<span class="lineNum">    2531 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RANGE (&quot;, &quot;LIST (&quot;, &quot;HASH (&quot;);</span>
<span class="lineNum">    2532 </span>            :     /* If we have xxx PARTITION OF, provide a list of partitioned tables */
<span class="lineNum">    2533 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;PARTITION&quot;, &quot;OF&quot;))</span>
<span class="lineNum">    2534 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_partitioned_tables, &quot;&quot;);</span>
<span class="lineNum">    2535 </span>            :     /* Limited completion support for partition bound specification */
<span class="lineNum">    2536 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;PARTITION&quot;, &quot;OF&quot;, MatchAny))</span>
<span class="lineNum">    2537 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOR VALUES&quot;, &quot;DEFAULT&quot;);</span>
<span class="lineNum">    2538 </span>            :     /* Complete CREATE TABLE &lt;name&gt; with '(', OF or PARTITION OF */
<span class="lineNum">    2539 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TABLE&quot;, MatchAny) ||</span>
<span class="lineNum">    2540 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY|UNLOGGED&quot;, &quot;TABLE&quot;, MatchAny))</span>
<span class="lineNum">    2541 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;OF&quot;, &quot;PARTITION OF&quot;);</span>
<span class="lineNum">    2542 </span>            :     /* Complete CREATE TABLE &lt;name&gt; OF with list of composite types */
<span class="lineNum">    2543 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TABLE&quot;, MatchAny, &quot;OF&quot;) ||</span>
<span class="lineNum">    2544 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY|UNLOGGED&quot;, &quot;TABLE&quot;, MatchAny, &quot;OF&quot;))</span>
<span class="lineNum">    2545 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_composite_datatypes, NULL);</span>
<span class="lineNum">    2546 </span>            :     /* Complete CREATE TABLE name (...) with supported options */
<span class="lineNum">    2547 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;) ||</span>
<span class="lineNum">    2548 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;UNLOGGED&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;))</span>
<span class="lineNum">    2549 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INHERITS (&quot;, &quot;PARTITION BY&quot;, &quot;USING&quot;, &quot;TABLESPACE&quot;, &quot;WITH (&quot;);</span>
<span class="lineNum">    2550 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;))</span>
<span class="lineNum">    2551 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INHERITS (&quot;, &quot;ON COMMIT&quot;, &quot;PARTITION BY&quot;,</span>
<span class="lineNum">    2552 </span>            :                       &quot;TABLESPACE&quot;, &quot;WITH (&quot;);
<span class="lineNum">    2553 </span>            :     /* Complete CREATE TABLE (...) USING with table access methods */
<span class="lineNum">    2554 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;, &quot;USING&quot;) ||</span>
<span class="lineNum">    2555 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY|UNLOGGED&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;, &quot;USING&quot;))</span>
<span class="lineNum">    2556 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_table_access_methods);</span>
<span class="lineNum">    2557 </span>            :     /* Complete CREATE TABLE (...) WITH with storage parameters */
<span class="lineNum">    2558 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;, &quot;WITH&quot;, &quot;(&quot;) ||</span>
<span class="lineNum">    2559 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY|UNLOGGED&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;, &quot;WITH&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2560 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_LIST(table_storage_parameters);</span>
<span class="lineNum">    2561 </span>            :     /* Complete CREATE TABLE ON COMMIT with actions */
<span class="lineNum">    2562 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TEMP|TEMPORARY&quot;, &quot;TABLE&quot;, MatchAny, &quot;(*)&quot;, &quot;ON&quot;, &quot;COMMIT&quot;))</span>
<span class="lineNum">    2563 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DELETE ROWS&quot;, &quot;DROP&quot;, &quot;PRESERVE ROWS&quot;);</span>
<span class="lineNum">    2564 </span>            : 
<span class="lineNum">    2565 </span>            : /* CREATE TABLESPACE */
<span class="lineNum">    2566 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TABLESPACE&quot;, MatchAny))</span>
<span class="lineNum">    2567 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNER&quot;, &quot;LOCATION&quot;);</span>
<span class="lineNum">    2568 </span>            :     /* Complete CREATE TABLESPACE name OWNER name with &quot;LOCATION&quot; */
<span class="lineNum">    2569 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TABLESPACE&quot;, MatchAny, &quot;OWNER&quot;, MatchAny))</span>
<span class="lineNum">    2570 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;LOCATION&quot;);</span>
<span class="lineNum">    2571 </span>            : 
<span class="lineNum">    2572 </span>            : /* CREATE TEXT SEARCH */
<span class="lineNum">    2573 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;))</span>
<span class="lineNum">    2574 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONFIGURATION&quot;, &quot;DICTIONARY&quot;, &quot;PARSER&quot;, &quot;TEMPLATE&quot;);</span>
<span class="lineNum">    2575 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;, &quot;CONFIGURATION&quot;, MatchAny))</span>
<span class="lineNum">    2576 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2577 </span>            : 
<span class="lineNum">    2578 </span>            : /* CREATE SUBSCRIPTION */
<span class="lineNum">    2579 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;SUBSCRIPTION&quot;, MatchAny))</span>
<span class="lineNum">    2580 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONNECTION&quot;);</span>
<span class="lineNum">    2581 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;SUBSCRIPTION&quot;, MatchAny, &quot;CONNECTION&quot;, MatchAny))</span>
<span class="lineNum">    2582 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;PUBLICATION&quot;);</span>
<span class="lineNum">    2583 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;SUBSCRIPTION&quot;, MatchAny, &quot;CONNECTION&quot;,</span>
<span class="lineNum">    2584 </span>            :                      MatchAny, &quot;PUBLICATION&quot;))
<span class="lineNum">    2585 </span>            :     {
<span class="lineNum">    2586 </span>            :         /* complete with nothing here as this refers to remote publications */
<span class="lineNum">    2587 </span>            :     }
<span class="lineNum">    2588 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;SUBSCRIPTION&quot;) &amp;&amp; TailMatches(&quot;PUBLICATION&quot;, MatchAny))</span>
<span class="lineNum">    2589 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH (&quot;);</span>
<span class="lineNum">    2590 </span>            :     /* Complete &quot;CREATE SUBSCRIPTION &lt;name&gt; ...  WITH ( &lt;opt&gt;&quot; */
<span class="lineNum">    2591 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;SUBSCRIPTION&quot;) &amp;&amp; TailMatches(&quot;WITH&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2592 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;copy_data&quot;, &quot;connect&quot;, &quot;create_slot&quot;, &quot;enabled&quot;,</span>
<span class="lineNum">    2593 </span>            :                       &quot;slot_name&quot;, &quot;synchronous_commit&quot;);
<span class="lineNum">    2594 </span>            : 
<span class="lineNum">    2595 </span>            : /* CREATE TRIGGER --- is allowed inside CREATE SCHEMA, so use TailMatches */
<span class="lineNum">    2596 </span>            :     /* complete CREATE TRIGGER &lt;name&gt; with BEFORE,AFTER,INSTEAD OF */
<span class="lineNum">    2597 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny))</span>
<span class="lineNum">    2598 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BEFORE&quot;, &quot;AFTER&quot;, &quot;INSTEAD OF&quot;);</span>
<span class="lineNum">    2599 </span>            :     /* complete CREATE TRIGGER &lt;name&gt; BEFORE,AFTER with an event */
<span class="lineNum">    2600 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;BEFORE|AFTER&quot;))</span>
<span class="lineNum">    2601 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INSERT&quot;, &quot;DELETE&quot;, &quot;UPDATE&quot;, &quot;TRUNCATE&quot;);</span>
<span class="lineNum">    2602 </span>            :     /* complete CREATE TRIGGER &lt;name&gt; INSTEAD OF with an event */
<span class="lineNum">    2603 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;INSTEAD&quot;, &quot;OF&quot;))</span>
<span class="lineNum">    2604 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INSERT&quot;, &quot;DELETE&quot;, &quot;UPDATE&quot;);</span>
<span class="lineNum">    2605 </span>            :     /* complete CREATE TRIGGER &lt;name&gt; BEFORE,AFTER sth with OR,ON */
<span class="lineNum">    2606 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;BEFORE|AFTER&quot;, MatchAny) ||</span>
<span class="lineNum">    2607 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;INSTEAD&quot;, &quot;OF&quot;, MatchAny))</span>
<span class="lineNum">    2608 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;, &quot;OR&quot;);</span>
<span class="lineNum">    2609 </span>            : 
<span class="lineNum">    2610 </span>            :     /*
<span class="lineNum">    2611 </span>            :      * complete CREATE TRIGGER &lt;name&gt; BEFORE,AFTER event ON with a list of
<span class="lineNum">    2612 </span>            :      * tables.  EXECUTE FUNCTION is the recommended grammar instead of EXECUTE
<span class="lineNum">    2613 </span>            :      * PROCEDURE in version 11 and upwards.
<span class="lineNum">    2614 </span>            :      */
<span class="lineNum">    2615 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;BEFORE|AFTER&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2616 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    2617 </span>            :     /* complete CREATE TRIGGER ... INSTEAD OF event ON with a list of views */
<span class="lineNum">    2618 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;INSTEAD&quot;, &quot;OF&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2619 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_views, NULL);</span>
<span class="lineNum">    2620 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    2621 </span>            :     {
<span class="lineNum">    2622 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2623 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;NOT DEFERRABLE&quot;, &quot;DEFERRABLE&quot;, &quot;INITIALLY&quot;,</span>
<span class="lineNum">    2624 </span>            :                           &quot;REFERENCING&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE FUNCTION&quot;);
<span class="lineNum">    2625 </span>            :         else
<span class="lineNum">    2626 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;NOT DEFERRABLE&quot;, &quot;DEFERRABLE&quot;, &quot;INITIALLY&quot;,</span>
<span class="lineNum">    2627 </span>            :                           &quot;REFERENCING&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE PROCEDURE&quot;);
<span class="lineNum">    2628 </span>            :     }
<span class="lineNum">    2629 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2630 </span><span class="lineNoCov">          0 :              (TailMatches(&quot;DEFERRABLE&quot;) || TailMatches(&quot;INITIALLY&quot;, &quot;IMMEDIATE|DEFERRED&quot;)))</span>
<span class="lineNum">    2631 </span>            :     {
<span class="lineNum">    2632 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2633 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;REFERENCING&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2634 </span>            :         else
<span class="lineNum">    2635 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;REFERENCING&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2636 </span>            :     }
<span class="lineNum">    2637 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;REFERENCING&quot;))</span>
<span class="lineNum">    2638 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OLD TABLE&quot;, &quot;NEW TABLE&quot;);</span>
<span class="lineNum">    2639 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;OLD|NEW&quot;, &quot;TABLE&quot;))</span>
<span class="lineNum">    2640 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AS&quot;);</span>
<span class="lineNum">    2641 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2642 </span><span class="lineNoCov">          0 :              (TailMatches(&quot;REFERENCING&quot;, &quot;OLD&quot;, &quot;TABLE&quot;, &quot;AS&quot;, MatchAny) ||</span>
<span class="lineNum">    2643 </span><span class="lineNoCov">          0 :               TailMatches(&quot;REFERENCING&quot;, &quot;OLD&quot;, &quot;TABLE&quot;, MatchAny)))</span>
<span class="lineNum">    2644 </span>            :     {
<span class="lineNum">    2645 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2646 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;NEW TABLE&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2647 </span>            :         else
<span class="lineNum">    2648 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;NEW TABLE&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2649 </span>            :     }
<span class="lineNum">    2650 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2651 </span><span class="lineNoCov">          0 :              (TailMatches(&quot;REFERENCING&quot;, &quot;NEW&quot;, &quot;TABLE&quot;, &quot;AS&quot;, MatchAny) ||</span>
<span class="lineNum">    2652 </span><span class="lineNoCov">          0 :               TailMatches(&quot;REFERENCING&quot;, &quot;NEW&quot;, &quot;TABLE&quot;, MatchAny)))</span>
<span class="lineNum">    2653 </span>            :     {
<span class="lineNum">    2654 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2655 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;OLD TABLE&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2656 </span>            :         else
<span class="lineNum">    2657 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;OLD TABLE&quot;, &quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2658 </span>            :     }
<span class="lineNum">    2659 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2660 </span><span class="lineNoCov">          0 :              (TailMatches(&quot;REFERENCING&quot;, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, &quot;AS&quot;, MatchAny, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, &quot;AS&quot;, MatchAny) ||</span>
<span class="lineNum">    2661 </span><span class="lineNoCov">          0 :               TailMatches(&quot;REFERENCING&quot;, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, MatchAny, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, &quot;AS&quot;, MatchAny) ||</span>
<span class="lineNum">    2662 </span><span class="lineNoCov">          0 :               TailMatches(&quot;REFERENCING&quot;, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, &quot;AS&quot;, MatchAny, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, MatchAny) ||</span>
<span class="lineNum">    2663 </span><span class="lineNoCov">          0 :               TailMatches(&quot;REFERENCING&quot;, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, MatchAny, &quot;OLD|NEW&quot;, &quot;TABLE&quot;, MatchAny)))</span>
<span class="lineNum">    2664 </span>            :     {
<span class="lineNum">    2665 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2666 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2667 </span>            :         else
<span class="lineNum">    2668 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FOR&quot;, &quot;WHEN (&quot;, &quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2669 </span>            :     }
<span class="lineNum">    2670 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;FOR&quot;))</span>
<span class="lineNum">    2671 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;EACH&quot;, &quot;ROW&quot;, &quot;STATEMENT&quot;);</span>
<span class="lineNum">    2672 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;FOR&quot;, &quot;EACH&quot;))</span>
<span class="lineNum">    2673 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ROW&quot;, &quot;STATEMENT&quot;);</span>
<span class="lineNum">    2674 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2675 </span><span class="lineNoCov">          0 :              (TailMatches(&quot;FOR&quot;, &quot;EACH&quot;, &quot;ROW|STATEMENT&quot;) ||</span>
<span class="lineNum">    2676 </span><span class="lineNoCov">          0 :               TailMatches(&quot;FOR&quot;, &quot;ROW|STATEMENT&quot;)))</span>
<span class="lineNum">    2677 </span>            :     {
<span class="lineNum">    2678 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2679 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;WHEN (&quot;, &quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2680 </span>            :         else
<span class="lineNum">    2681 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;WHEN (&quot;, &quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2682 </span>            :     }
<span class="lineNum">    2683 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;WHEN&quot;, &quot;(*)&quot;))</span>
<span class="lineNum">    2684 </span>            :     {
<span class="lineNum">    2685 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2686 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2687 </span>            :         else
<span class="lineNum">    2688 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2689 </span>            :     }
<span class="lineNum">    2690 </span>            :     /* complete CREATE TRIGGER ... EXECUTE with PROCEDURE|FUNCTION */
<span class="lineNum">    2691 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp; TailMatches(&quot;EXECUTE&quot;))</span>
<span class="lineNum">    2692 </span>            :     {
<span class="lineNum">    2693 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2694 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FUNCTION&quot;);</span>
<span class="lineNum">    2695 </span>            :         else
<span class="lineNum">    2696 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;PROCEDURE&quot;);</span>
<span class="lineNum">    2697 </span>            :     }
<span class="lineNum">    2698 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2699 </span><span class="lineNoCov">          0 :              TailMatches(&quot;EXECUTE&quot;, &quot;FUNCTION|PROCEDURE&quot;))</span>
<span class="lineNum">    2700 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_functions, NULL);</span>
<span class="lineNum">    2701 </span>            : 
<span class="lineNum">    2702 </span>            : /* CREATE ROLE,USER,GROUP &lt;name&gt; */
<span class="lineNum">    2703 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;ROLE|GROUP|USER&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    2704 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;USER&quot;, &quot;MAPPING&quot;))</span>
<span class="lineNum">    2705 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADMIN&quot;, &quot;BYPASSRLS&quot;, &quot;CONNECTION LIMIT&quot;, &quot;CREATEDB&quot;,</span>
<span class="lineNum">    2706 </span>            :                       &quot;CREATEROLE&quot;, &quot;ENCRYPTED PASSWORD&quot;, &quot;IN&quot;, &quot;INHERIT&quot;,
<span class="lineNum">    2707 </span>            :                       &quot;LOGIN&quot;, &quot;NOBYPASSRLS&quot;,
<span class="lineNum">    2708 </span>            :                       &quot;NOCREATEDB&quot;, &quot;NOCREATEROLE&quot;, &quot;NOINHERIT&quot;,
<span class="lineNum">    2709 </span>            :                       &quot;NOLOGIN&quot;, &quot;NOREPLICATION&quot;, &quot;NOSUPERUSER&quot;, &quot;PASSWORD&quot;,
<span class="lineNum">    2710 </span>            :                       &quot;REPLICATION&quot;, &quot;ROLE&quot;, &quot;SUPERUSER&quot;, &quot;SYSID&quot;,
<span class="lineNum">    2711 </span>            :                       &quot;VALID UNTIL&quot;, &quot;WITH&quot;);
<span class="lineNum">    2712 </span>            : 
<span class="lineNum">    2713 </span>            : /* CREATE ROLE,USER,GROUP &lt;name&gt; WITH */
<span class="lineNum">    2714 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;ROLE|GROUP|USER&quot;, MatchAny, &quot;WITH&quot;))</span>
<span class="lineNum">    2715 </span>            :         /* Similar to the above, but don't complete &quot;WITH&quot; again. */
<span class="lineNum">    2716 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ADMIN&quot;, &quot;BYPASSRLS&quot;, &quot;CONNECTION LIMIT&quot;, &quot;CREATEDB&quot;,</span>
<span class="lineNum">    2717 </span>            :                       &quot;CREATEROLE&quot;, &quot;ENCRYPTED PASSWORD&quot;, &quot;IN&quot;, &quot;INHERIT&quot;,
<span class="lineNum">    2718 </span>            :                       &quot;LOGIN&quot;, &quot;NOBYPASSRLS&quot;,
<span class="lineNum">    2719 </span>            :                       &quot;NOCREATEDB&quot;, &quot;NOCREATEROLE&quot;, &quot;NOINHERIT&quot;,
<span class="lineNum">    2720 </span>            :                       &quot;NOLOGIN&quot;, &quot;NOREPLICATION&quot;, &quot;NOSUPERUSER&quot;, &quot;PASSWORD&quot;,
<span class="lineNum">    2721 </span>            :                       &quot;REPLICATION&quot;, &quot;ROLE&quot;, &quot;SUPERUSER&quot;, &quot;SYSID&quot;,
<span class="lineNum">    2722 </span>            :                       &quot;VALID UNTIL&quot;);
<span class="lineNum">    2723 </span>            : 
<span class="lineNum">    2724 </span>            :     /* complete CREATE ROLE,USER,GROUP &lt;name&gt; IN with ROLE,GROUP */
<span class="lineNum">    2725 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;ROLE|USER|GROUP&quot;, MatchAny, &quot;IN&quot;))</span>
<span class="lineNum">    2726 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;GROUP&quot;, &quot;ROLE&quot;);</span>
<span class="lineNum">    2727 </span>            : 
<span class="lineNum">    2728 </span>            : /* CREATE TYPE */
<span class="lineNum">    2729 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TYPE&quot;, MatchAny))</span>
<span class="lineNum">    2730 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;AS&quot;);</span>
<span class="lineNum">    2731 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TYPE&quot;, MatchAny, &quot;AS&quot;))</span>
<span class="lineNum">    2732 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ENUM&quot;, &quot;RANGE&quot;, &quot;(&quot;);</span>
<span class="lineNum">    2733 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TYPE&quot;, MatchAny, &quot;AS&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2734 </span>            :     {
<span class="lineNum">    2735 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;(|*,&quot;, MatchAny))</span>
<span class="lineNum">    2736 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_datatypes, NULL);</span>
<span class="lineNum">    2737 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;(|*,&quot;, MatchAny, MatchAnyExcept(&quot;*)&quot;)))</span>
<span class="lineNum">    2738 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;COLLATE&quot;, &quot;,&quot;, &quot;)&quot;);</span>
<span class="lineNum">    2739 </span>            :     }
<span class="lineNum">    2740 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;TYPE&quot;, MatchAny, &quot;AS&quot;, &quot;ENUM|RANGE&quot;))</span>
<span class="lineNum">    2741 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2742 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TYPE&quot;, MatchAny, &quot;(&quot;))</span>
<span class="lineNum">    2743 </span>            :     {
<span class="lineNum">    2744 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;(|*,&quot;))</span>
<span class="lineNum">    2745 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;INPUT&quot;, &quot;OUTPUT&quot;, &quot;RECEIVE&quot;, &quot;SEND&quot;,</span>
<span class="lineNum">    2746 </span>            :                           &quot;TYPMOD_IN&quot;, &quot;TYPMOD_OUT&quot;, &quot;ANALYZE&quot;,
<span class="lineNum">    2747 </span>            :                           &quot;INTERNALLENGTH&quot;, &quot;PASSEDBYVALUE&quot;, &quot;ALIGNMENT&quot;,
<span class="lineNum">    2748 </span>            :                           &quot;STORAGE&quot;, &quot;LIKE&quot;, &quot;CATEGORY&quot;, &quot;PREFERRED&quot;,
<span class="lineNum">    2749 </span>            :                           &quot;DEFAULT&quot;, &quot;ELEMENT&quot;, &quot;DELIMITER&quot;,
<span class="lineNum">    2750 </span>            :                           &quot;COLLATABLE&quot;);
<span class="lineNum">    2751 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;(*|*,&quot;, MatchAnyExcept(&quot;*=&quot;)))</span>
<span class="lineNum">    2752 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;=&quot;);</span>
<span class="lineNum">    2753 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;=&quot;, MatchAnyExcept(&quot;*)&quot;)))</span>
<span class="lineNum">    2754 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;,&quot;, &quot;)&quot;);</span>
<span class="lineNum">    2755 </span>            :     }
<span class="lineNum">    2756 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;TYPE&quot;, MatchAny, &quot;AS&quot;, &quot;RANGE&quot;, &quot;(&quot;))</span>
<span class="lineNum">    2757 </span>            :     {
<span class="lineNum">    2758 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;(|*,&quot;))</span>
<span class="lineNum">    2759 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;SUBTYPE&quot;, &quot;SUBTYPE_OPCLASS&quot;, &quot;COLLATION&quot;,</span>
<span class="lineNum">    2760 </span>            :                           &quot;CANONICAL&quot;, &quot;SUBTYPE_DIFF&quot;);
<span class="lineNum">    2761 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;(*|*,&quot;, MatchAnyExcept(&quot;*=&quot;)))</span>
<span class="lineNum">    2762 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;=&quot;);</span>
<span class="lineNum">    2763 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;=&quot;, MatchAnyExcept(&quot;*)&quot;)))</span>
<span class="lineNum">    2764 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;,&quot;, &quot;)&quot;);</span>
<span class="lineNum">    2765 </span>            :     }
<span class="lineNum">    2766 </span>            : 
<span class="lineNum">    2767 </span>            : /* CREATE VIEW --- is allowed inside CREATE SCHEMA, so use TailMatches */
<span class="lineNum">    2768 </span>            :     /* Complete CREATE [ OR REPLACE ] VIEW &lt;name&gt; with AS */
<span class="lineNum">    2769 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;VIEW&quot;, MatchAny) ||</span>
<span class="lineNum">    2770 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;OR&quot;, &quot;REPLACE&quot;, &quot;VIEW&quot;, MatchAny))</span>
<span class="lineNum">    2771 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AS&quot;);</span>
<span class="lineNum">    2772 </span>            :     /* Complete &quot;CREATE [ OR REPLACE ] VIEW &lt;sth&gt; AS with &quot;SELECT&quot; */
<span class="lineNum">    2773 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;CREATE&quot;, &quot;VIEW&quot;, MatchAny, &quot;AS&quot;) ||</span>
<span class="lineNum">    2774 </span><span class="lineNoCov">          0 :              TailMatches(&quot;CREATE&quot;, &quot;OR&quot;, &quot;REPLACE&quot;, &quot;VIEW&quot;, MatchAny, &quot;AS&quot;))</span>
<span class="lineNum">    2775 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;);</span>
<span class="lineNum">    2776 </span>            : 
<span class="lineNum">    2777 </span>            : /* CREATE MATERIALIZED VIEW */
<span class="lineNum">    2778 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;MATERIALIZED&quot;) ||</span>
<span class="lineNum">    2779 </span><span class="lineNoCov">          0 :              Matches(&quot;CREATE&quot;, &quot;INCREMENTAL&quot;, &quot;MATERIALIZED&quot;))</span>
<span class="lineNum">    2780 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;VIEW&quot;);</span>
<span class="lineNum">    2781 </span>            :     /* Complete CREATE MATERIALIZED VIEW &lt;name&gt; with AS  */
<span class="lineNum">    2782 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny) ||</span>
<span class="lineNum">    2783 </span><span class="lineNoCov">          0 :              Matches(&quot;CREATE&quot;, &quot;INCREMENTAL&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny))</span>
<span class="lineNum">    2784 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AS&quot;);</span>
<span class="lineNum">    2785 </span>            :     /* Complete &quot;CREATE MATERIALIZED VIEW &lt;sth&gt; AS with &quot;SELECT&quot; */
<span class="lineNum">    2786 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;AS&quot;) ||</span>
<span class="lineNum">    2787 </span><span class="lineNoCov">          0 :              Matches(&quot;CREATE&quot;, &quot;INCREMENTAL&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;AS&quot;))</span>
<span class="lineNum">    2788 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;);</span>
<span class="lineNum">    2789 </span>            : 
<span class="lineNum">    2790 </span>            : /* CREATE EVENT TRIGGER */
<span class="lineNum">    2791 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EVENT&quot;))</span>
<span class="lineNum">    2792 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TRIGGER&quot;);</span>
<span class="lineNum">    2793 </span>            :     /* Complete CREATE EVENT TRIGGER &lt;name&gt; with ON */
<span class="lineNum">    2794 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;, MatchAny))</span>
<span class="lineNum">    2795 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2796 </span>            :     /* Complete CREATE EVENT TRIGGER &lt;name&gt; ON with event_type */
<span class="lineNum">    2797 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2798 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ddl_command_start&quot;, &quot;ddl_command_end&quot;, &quot;sql_drop&quot;);</span>
<span class="lineNum">    2799 </span>            : 
<span class="lineNum">    2800 </span>            :     /*
<span class="lineNum">    2801 </span>            :      * Complete CREATE EVENT TRIGGER &lt;name&gt; ON &lt;event_type&gt;.  EXECUTE FUNCTION
<span class="lineNum">    2802 </span>            :      * is the recommended grammar instead of EXECUTE PROCEDURE in version 11
<span class="lineNum">    2803 </span>            :      * and upwards.
<span class="lineNum">    2804 </span>            :      */
<span class="lineNum">    2805 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    2806 </span>            :     {
<span class="lineNum">    2807 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2808 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;WHEN TAG IN (&quot;, &quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2809 </span>            :         else
<span class="lineNum">    2810 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;WHEN TAG IN (&quot;, &quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2811 </span>            :     }
<span class="lineNum">    2812 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2813 </span><span class="lineNoCov">          0 :              TailMatches(&quot;WHEN|AND&quot;, MatchAny, &quot;IN&quot;, &quot;(*)&quot;))</span>
<span class="lineNum">    2814 </span>            :     {
<span class="lineNum">    2815 </span><span class="lineNoCov">          0 :         if (pset.sversion &gt;= 110000)</span>
<span class="lineNum">    2816 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;EXECUTE FUNCTION&quot;);</span>
<span class="lineNum">    2817 </span>            :         else
<span class="lineNum">    2818 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;EXECUTE PROCEDURE&quot;);</span>
<span class="lineNum">    2819 </span>            :     }
<span class="lineNum">    2820 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;CREATE&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;) &amp;&amp;</span>
<span class="lineNum">    2821 </span><span class="lineNoCov">          0 :              TailMatches(&quot;EXECUTE&quot;, &quot;FUNCTION|PROCEDURE&quot;))</span>
<span class="lineNum">    2822 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_functions, NULL);</span>
<span class="lineNum">    2823 </span>            : 
<span class="lineNum">    2824 </span>            : /* DEALLOCATE */
<span class="lineNum">    2825 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DEALLOCATE&quot;))</span>
<span class="lineNum">    2826 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_prepared_statements);</span>
<span class="lineNum">    2827 </span>            : 
<span class="lineNum">    2828 </span>            : /* DECLARE */
<span class="lineNum">    2829 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DECLARE&quot;, MatchAny))</span>
<span class="lineNum">    2830 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BINARY&quot;, &quot;INSENSITIVE&quot;, &quot;SCROLL&quot;, &quot;NO SCROLL&quot;,</span>
<span class="lineNum">    2831 </span>            :                       &quot;CURSOR&quot;);
<span class="lineNum">    2832 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;DECLARE&quot;) &amp;&amp; TailMatches(&quot;CURSOR&quot;))</span>
<span class="lineNum">    2833 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH HOLD&quot;, &quot;WITHOUT HOLD&quot;, &quot;FOR&quot;);</span>
<span class="lineNum">    2834 </span>            : 
<span class="lineNum">    2835 </span>            : /* DELETE --- can be inside EXPLAIN, RULE, etc */
<span class="lineNum">    2836 </span>            :     /* ... despite which, only complete DELETE with FROM at start of line */
<span class="lineNum">    2837 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DELETE&quot;))</span>
<span class="lineNum">    2838 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    2839 </span>            :     /* Complete DELETE FROM with a list of tables */
<span class="lineNum">    2840 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;DELETE&quot;, &quot;FROM&quot;))</span>
<span class="lineNum">    2841 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_updatables, NULL);</span>
<span class="lineNum">    2842 </span>            :     /* Complete DELETE FROM &lt;table&gt; */
<span class="lineNum">    2843 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;DELETE&quot;, &quot;FROM&quot;, MatchAny))</span>
<span class="lineNum">    2844 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;USING&quot;, &quot;WHERE&quot;);</span>
<span class="lineNum">    2845 </span>            :     /* XXX: implement tab completion for DELETE ... USING */
<span class="lineNum">    2846 </span>            : 
<span class="lineNum">    2847 </span>            : /* DISCARD */
<span class="lineNum">    2848 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DISCARD&quot;))</span>
<span class="lineNum">    2849 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALL&quot;, &quot;PLANS&quot;, &quot;SEQUENCES&quot;, &quot;TEMP&quot;);</span>
<span class="lineNum">    2850 </span>            : 
<span class="lineNum">    2851 </span>            : /* DO */
<span class="lineNum">    2852 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DO&quot;))</span>
<span class="lineNum">    2853 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;LANGUAGE&quot;);</span>
<span class="lineNum">    2854 </span>            : 
<span class="lineNum">    2855 </span>            : /* DROP */
<span class="lineNum">    2856 </span>            :     /* Complete DROP object with CASCADE / RESTRICT */
<span class="lineNum">    2857 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;,</span>
<span class="lineNum">    2858 </span>            :                      &quot;COLLATION|CONVERSION|DOMAIN|EXTENSION|LANGUAGE|PUBLICATION|SCHEMA|SEQUENCE|SERVER|SUBSCRIPTION|STATISTICS|TABLE|TYPE|VIEW&quot;,
<span class="lineNum">    2859 </span><span class="lineNoCov">          0 :                      MatchAny) ||</span>
<span class="lineNum">    2860 </span><span class="lineNoCov">          0 :              Matches(&quot;DROP&quot;, &quot;ACCESS&quot;, &quot;METHOD&quot;, MatchAny) ||</span>
<span class="lineNum">    2861 </span><span class="lineNoCov">          0 :              (Matches(&quot;DROP&quot;, &quot;AGGREGATE|FUNCTION|PROCEDURE|ROUTINE&quot;, MatchAny, MatchAny) &amp;&amp;</span>
<span class="lineNum">    2862 </span><span class="lineNoCov">          0 :               ends_with(prev_wd, ')')) ||</span>
<span class="lineNum">    2863 </span><span class="lineNoCov">          0 :              Matches(&quot;DROP&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;, MatchAny) ||</span>
<span class="lineNum">    2864 </span><span class="lineNoCov">          0 :              Matches(&quot;DROP&quot;, &quot;FOREIGN&quot;, &quot;DATA&quot;, &quot;WRAPPER&quot;, MatchAny) ||</span>
<span class="lineNum">    2865 </span><span class="lineNoCov">          0 :              Matches(&quot;DROP&quot;, &quot;FOREIGN&quot;, &quot;TABLE&quot;, MatchAny) ||</span>
<span class="lineNum">    2866 </span><span class="lineNoCov">          0 :              Matches(&quot;DROP&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;, &quot;CONFIGURATION|DICTIONARY|PARSER|TEMPLATE&quot;, MatchAny))</span>
<span class="lineNum">    2867 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CASCADE&quot;, &quot;RESTRICT&quot;);</span>
<span class="lineNum">    2868 </span>            : 
<span class="lineNum">    2869 </span>            :     /* help completing some of the variants */
<span class="lineNum">    2870 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;AGGREGATE|FUNCTION|PROCEDURE|ROUTINE&quot;, MatchAny))</span>
<span class="lineNum">    2871 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    2872 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;AGGREGATE|FUNCTION|PROCEDURE|ROUTINE&quot;, MatchAny, &quot;(&quot;))</span>
<span class="lineNum">    2873 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_FUNCTION_ARG(prev2_wd);</span>
<span class="lineNum">    2874 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    2875 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA WRAPPER&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    2876 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;DATABASE&quot;, MatchAny))</span>
<span class="lineNum">    2877 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH (&quot;);</span>
<span class="lineNum">    2878 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;DROP&quot;, &quot;DATABASE&quot;) &amp;&amp; (ends_with(prev_wd, '(')))</span>
<span class="lineNum">    2879 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FORCE&quot;);</span>
<span class="lineNum">    2880 </span>            : 
<span class="lineNum">    2881 </span>            :     /* DROP INDEX */
<span class="lineNum">    2882 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;INDEX&quot;))</span>
<span class="lineNum">    2883 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes,</span>
<span class="lineNum">    2884 </span>            :                                    &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    2885 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;INDEX&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    2886 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes, NULL);</span>
<span class="lineNum">    2887 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;INDEX&quot;, MatchAny))</span>
<span class="lineNum">    2888 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CASCADE&quot;, &quot;RESTRICT&quot;);</span>
<span class="lineNum">    2889 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;INDEX&quot;, &quot;CONCURRENTLY&quot;, MatchAny))</span>
<span class="lineNum">    2890 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CASCADE&quot;, &quot;RESTRICT&quot;);</span>
<span class="lineNum">    2891 </span>            : 
<span class="lineNum">    2892 </span>            :     /* DROP MATERIALIZED VIEW */
<span class="lineNum">    2893 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;MATERIALIZED&quot;))</span>
<span class="lineNum">    2894 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;VIEW&quot;);</span>
<span class="lineNum">    2895 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;))</span>
<span class="lineNum">    2896 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_matviews, NULL);</span>
<span class="lineNum">    2897 </span>            : 
<span class="lineNum">    2898 </span>            :     /* DROP OWNED BY */
<span class="lineNum">    2899 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;OWNED&quot;))</span>
<span class="lineNum">    2900 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BY&quot;);</span>
<span class="lineNum">    2901 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;OWNED&quot;, &quot;BY&quot;))</span>
<span class="lineNum">    2902 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    2903 </span>            : 
<span class="lineNum">    2904 </span>            :     /* DROP TEXT SEARCH */
<span class="lineNum">    2905 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;))</span>
<span class="lineNum">    2906 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CONFIGURATION&quot;, &quot;DICTIONARY&quot;, &quot;PARSER&quot;, &quot;TEMPLATE&quot;);</span>
<span class="lineNum">    2907 </span>            : 
<span class="lineNum">    2908 </span>            :     /* DROP TRIGGER */
<span class="lineNum">    2909 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;TRIGGER&quot;, MatchAny))</span>
<span class="lineNum">    2910 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2911 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2912 </span>            :     {
<span class="lineNum">    2913 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    2914 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_trigger);</span>
<span class="lineNum">    2915 </span>            :     }
<span class="lineNum">    2916 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;TRIGGER&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    2917 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CASCADE&quot;, &quot;RESTRICT&quot;);</span>
<span class="lineNum">    2918 </span>            : 
<span class="lineNum">    2919 </span>            :     /* DROP ACCESS METHOD */
<span class="lineNum">    2920 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;ACCESS&quot;))</span>
<span class="lineNum">    2921 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;METHOD&quot;);</span>
<span class="lineNum">    2922 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;ACCESS&quot;, &quot;METHOD&quot;))</span>
<span class="lineNum">    2923 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_access_methods);</span>
<span class="lineNum">    2924 </span>            : 
<span class="lineNum">    2925 </span>            :     /* DROP EVENT TRIGGER */
<span class="lineNum">    2926 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;EVENT&quot;))</span>
<span class="lineNum">    2927 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TRIGGER&quot;);</span>
<span class="lineNum">    2928 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;EVENT&quot;, &quot;TRIGGER&quot;))</span>
<span class="lineNum">    2929 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_event_triggers);</span>
<span class="lineNum">    2930 </span>            : 
<span class="lineNum">    2931 </span>            :     /* DROP POLICY &lt;name&gt;  */
<span class="lineNum">    2932 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;POLICY&quot;))</span>
<span class="lineNum">    2933 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_policies);</span>
<span class="lineNum">    2934 </span>            :     /* DROP POLICY &lt;name&gt; ON */
<span class="lineNum">    2935 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;POLICY&quot;, MatchAny))</span>
<span class="lineNum">    2936 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2937 </span>            :     /* DROP POLICY &lt;name&gt; ON &lt;table&gt; */
<span class="lineNum">    2938 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;POLICY&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2939 </span>            :     {
<span class="lineNum">    2940 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    2941 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_policy);</span>
<span class="lineNum">    2942 </span>            :     }
<span class="lineNum">    2943 </span>            : 
<span class="lineNum">    2944 </span>            :     /* DROP RULE */
<span class="lineNum">    2945 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;RULE&quot;, MatchAny))</span>
<span class="lineNum">    2946 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    2947 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;RULE&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    2948 </span>            :     {
<span class="lineNum">    2949 </span><span class="lineNoCov">          0 :         completion_info_charp = prev2_wd;</span>
<span class="lineNum">    2950 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tables_for_rule);</span>
<span class="lineNum">    2951 </span>            :     }
<span class="lineNum">    2952 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;DROP&quot;, &quot;RULE&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    2953 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;CASCADE&quot;, &quot;RESTRICT&quot;);</span>
<span class="lineNum">    2954 </span>            : 
<span class="lineNum">    2955 </span>            : /* EXECUTE */
<span class="lineNum">    2956 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;EXECUTE&quot;))</span>
<span class="lineNum">    2957 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_prepared_statements);</span>
<span class="lineNum">    2958 </span>            : 
<span class="lineNum">    2959 </span>            : /*
<span class="lineNum">    2960 </span>            :  * EXPLAIN [ ( option [, ...] ) ] statement
<span class="lineNum">    2961 </span>            :  * EXPLAIN [ ANALYZE ] [ VERBOSE ] statement
<span class="lineNum">    2962 </span>            :  */
<span class="lineNum">    2963 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;EXPLAIN&quot;))</span>
<span class="lineNum">    2964 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;INSERT&quot;, &quot;DELETE&quot;, &quot;UPDATE&quot;, &quot;DECLARE&quot;,</span>
<span class="lineNum">    2965 </span>            :                       &quot;ANALYZE&quot;, &quot;VERBOSE&quot;);
<span class="lineNum">    2966 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;EXPLAIN&quot;, &quot;(*&quot;) &amp;&amp;</span>
<span class="lineNum">    2967 </span><span class="lineNoCov">          0 :              !HeadMatches(&quot;EXPLAIN&quot;, &quot;(*)&quot;))</span>
<span class="lineNum">    2968 </span>            :     {
<span class="lineNum">    2969 </span>            :         /*
<span class="lineNum">    2970 </span>            :          * This fires if we're in an unfinished parenthesized option list.
<span class="lineNum">    2971 </span>            :          * get_previous_words treats a completed parenthesized option list as
<span class="lineNum">    2972 </span>            :          * one word, so the above test is correct.
<span class="lineNum">    2973 </span>            :          */
<span class="lineNum">    2974 </span><span class="lineNoCov">          0 :         if (ends_with(prev_wd, '(') || ends_with(prev_wd, ','))</span>
<span class="lineNum">    2975 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;ANALYZE&quot;, &quot;VERBOSE&quot;, &quot;COSTS&quot;, &quot;SETTINGS&quot;,</span>
<span class="lineNum">    2976 </span>            :                           &quot;BUFFERS&quot;, &quot;TIMING&quot;, &quot;SUMMARY&quot;, &quot;FORMAT&quot;);
<span class="lineNum">    2977 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;ANALYZE|VERBOSE|COSTS|SETTINGS|BUFFERS|TIMING|SUMMARY&quot;))</span>
<span class="lineNum">    2978 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;ON&quot;, &quot;OFF&quot;);</span>
<span class="lineNum">    2979 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;FORMAT&quot;))</span>
<span class="lineNum">    2980 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TEXT&quot;, &quot;XML&quot;, &quot;JSON&quot;, &quot;YAML&quot;);</span>
<span class="lineNum">    2981 </span>            :     }
<span class="lineNum">    2982 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;EXPLAIN&quot;, &quot;ANALYZE&quot;))</span>
<span class="lineNum">    2983 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;INSERT&quot;, &quot;DELETE&quot;, &quot;UPDATE&quot;, &quot;DECLARE&quot;,</span>
<span class="lineNum">    2984 </span>            :                       &quot;VERBOSE&quot;);
<span class="lineNum">    2985 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;EXPLAIN&quot;, &quot;(*)&quot;) ||</span>
<span class="lineNum">    2986 </span><span class="lineNoCov">          0 :              Matches(&quot;EXPLAIN&quot;, &quot;VERBOSE&quot;) ||</span>
<span class="lineNum">    2987 </span><span class="lineNoCov">          0 :              Matches(&quot;EXPLAIN&quot;, &quot;ANALYZE&quot;, &quot;VERBOSE&quot;))</span>
<span class="lineNum">    2988 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;INSERT&quot;, &quot;DELETE&quot;, &quot;UPDATE&quot;, &quot;DECLARE&quot;);</span>
<span class="lineNum">    2989 </span>            : 
<span class="lineNum">    2990 </span>            : /* FETCH &amp;&amp; MOVE */
<span class="lineNum">    2991 </span>            :     /* Complete FETCH with one of FORWARD, BACKWARD, RELATIVE */
<span class="lineNum">    2992 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;FETCH|MOVE&quot;))</span>
<span class="lineNum">    2993 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ABSOLUTE&quot;, &quot;BACKWARD&quot;, &quot;FORWARD&quot;, &quot;RELATIVE&quot;);</span>
<span class="lineNum">    2994 </span>            :     /* Complete FETCH &lt;sth&gt; with one of ALL, NEXT, PRIOR */
<span class="lineNum">    2995 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;FETCH|MOVE&quot;, MatchAny))</span>
<span class="lineNum">    2996 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ALL&quot;, &quot;NEXT&quot;, &quot;PRIOR&quot;);</span>
<span class="lineNum">    2997 </span>            : 
<span class="lineNum">    2998 </span>            :     /*
<span class="lineNum">    2999 </span>            :      * Complete FETCH &lt;sth1&gt; &lt;sth2&gt; with &quot;FROM&quot; or &quot;IN&quot;. These are equivalent,
<span class="lineNum">    3000 </span>            :      * but we may as well tab-complete both: perhaps some users prefer one
<span class="lineNum">    3001 </span>            :      * variant or the other.
<span class="lineNum">    3002 </span>            :      */
<span class="lineNum">    3003 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;FETCH|MOVE&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    3004 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FROM&quot;, &quot;IN&quot;);</span>
<span class="lineNum">    3005 </span>            : 
<span class="lineNum">    3006 </span>            : /* FOREIGN DATA WRAPPER */
<span class="lineNum">    3007 </span>            :     /* applies in ALTER/DROP FDW and in CREATE SERVER */
<span class="lineNum">    3008 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FOREIGN&quot;, &quot;DATA&quot;, &quot;WRAPPER&quot;) &amp;&amp;</span>
<span class="lineNum">    3009 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;CREATE&quot;, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    3010 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_fdws);</span>
<span class="lineNum">    3011 </span>            :     /* applies in CREATE SERVER */
<span class="lineNum">    3012 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FOREIGN&quot;, &quot;DATA&quot;, &quot;WRAPPER&quot;, MatchAny) &amp;&amp;</span>
<span class="lineNum">    3013 </span><span class="lineNoCov">          0 :              HeadMatches(&quot;CREATE&quot;, &quot;SERVER&quot;))</span>
<span class="lineNum">    3014 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OPTIONS&quot;);</span>
<span class="lineNum">    3015 </span>            : 
<span class="lineNum">    3016 </span>            : /* FOREIGN TABLE */
<span class="lineNum">    3017 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FOREIGN&quot;, &quot;TABLE&quot;) &amp;&amp;</span>
<span class="lineNum">    3018 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;CREATE&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    3019 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_foreign_tables, NULL);</span>
<span class="lineNum">    3020 </span>            : 
<span class="lineNum">    3021 </span>            : /* FOREIGN SERVER */
<span class="lineNum">    3022 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FOREIGN&quot;, &quot;SERVER&quot;))</span>
<span class="lineNum">    3023 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_servers);</span>
<span class="lineNum">    3024 </span>            : 
<span class="lineNum">    3025 </span>            : /*
<span class="lineNum">    3026 </span>            :  * GRANT and REVOKE are allowed inside CREATE SCHEMA and
<span class="lineNum">    3027 </span>            :  * ALTER DEFAULT PRIVILEGES, so use TailMatches
<span class="lineNum">    3028 </span>            :  */
<span class="lineNum">    3029 </span>            :     /* Complete GRANT/REVOKE with a list of roles and privileges */
<span class="lineNum">    3030 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;))</span>
<span class="lineNum">    3031 </span>            :     {
<span class="lineNum">    3032 </span>            :         /*
<span class="lineNum">    3033 </span>            :          * With ALTER DEFAULT PRIVILEGES, restrict completion to grantable
<span class="lineNum">    3034 </span>            :          * privileges (can't grant roles)
<span class="lineNum">    3035 </span>            :          */
<span class="lineNum">    3036 </span><span class="lineNoCov">          0 :         if (HeadMatches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;))</span>
<span class="lineNum">    3037 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;SELECT&quot;, &quot;INSERT&quot;, &quot;UPDATE&quot;,</span>
<span class="lineNum">    3038 </span>            :                           &quot;DELETE&quot;, &quot;TRUNCATE&quot;, &quot;REFERENCES&quot;, &quot;TRIGGER&quot;,
<span class="lineNum">    3039 </span>            :                           &quot;EXECUTE&quot;, &quot;USAGE&quot;, &quot;ALL&quot;);
<span class="lineNum">    3040 </span>            :         else
<span class="lineNum">    3041 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_roles</span>
<span class="lineNum">    3042 </span>            :                                 &quot; UNION SELECT 'SELECT'&quot;
<span class="lineNum">    3043 </span>            :                                 &quot; UNION SELECT 'INSERT'&quot;
<span class="lineNum">    3044 </span>            :                                 &quot; UNION SELECT 'UPDATE'&quot;
<span class="lineNum">    3045 </span>            :                                 &quot; UNION SELECT 'DELETE'&quot;
<span class="lineNum">    3046 </span>            :                                 &quot; UNION SELECT 'TRUNCATE'&quot;
<span class="lineNum">    3047 </span>            :                                 &quot; UNION SELECT 'REFERENCES'&quot;
<span class="lineNum">    3048 </span>            :                                 &quot; UNION SELECT 'TRIGGER'&quot;
<span class="lineNum">    3049 </span>            :                                 &quot; UNION SELECT 'CREATE'&quot;
<span class="lineNum">    3050 </span>            :                                 &quot; UNION SELECT 'CONNECT'&quot;
<span class="lineNum">    3051 </span>            :                                 &quot; UNION SELECT 'TEMPORARY'&quot;
<span class="lineNum">    3052 </span>            :                                 &quot; UNION SELECT 'EXECUTE'&quot;
<span class="lineNum">    3053 </span>            :                                 &quot; UNION SELECT 'USAGE'&quot;
<span class="lineNum">    3054 </span>            :                                 &quot; UNION SELECT 'ALL'&quot;);
<span class="lineNum">    3055 </span>            :     }
<span class="lineNum">    3056 </span>            : 
<span class="lineNum">    3057 </span>            :     /*
<span class="lineNum">    3058 </span>            :      * Complete GRANT/REVOKE &lt;privilege&gt; with &quot;ON&quot;, GRANT/REVOKE &lt;role&gt; with
<span class="lineNum">    3059 </span>            :      * TO/FROM
<span class="lineNum">    3060 </span>            :      */
<span class="lineNum">    3061 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny))</span>
<span class="lineNum">    3062 </span>            :     {
<span class="lineNum">    3063 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;SELECT|INSERT|UPDATE|DELETE|TRUNCATE|REFERENCES|TRIGGER|CREATE|CONNECT|TEMPORARY|TEMP|EXECUTE|USAGE|ALL&quot;))</span>
<span class="lineNum">    3064 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    3065 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;GRANT&quot;, MatchAny))</span>
<span class="lineNum">    3066 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3067 </span>            :         else
<span class="lineNum">    3068 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    3069 </span>            :     }
<span class="lineNum">    3070 </span>            : 
<span class="lineNum">    3071 </span>            :     /*
<span class="lineNum">    3072 </span>            :      * Complete GRANT/REVOKE &lt;sth&gt; ON with a list of appropriate relations.
<span class="lineNum">    3073 </span>            :      *
<span class="lineNum">    3074 </span>            :      * Keywords like DATABASE, FUNCTION, LANGUAGE and SCHEMA added to query
<span class="lineNum">    3075 </span>            :      * result via UNION; seems to work intuitively.
<span class="lineNum">    3076 </span>            :      *
<span class="lineNum">    3077 </span>            :      * Note: GRANT/REVOKE can get quite complex; tab-completion as implemented
<span class="lineNum">    3078 </span>            :      * here will only work if the privilege list contains exactly one
<span class="lineNum">    3079 </span>            :      * privilege.
<span class="lineNum">    3080 </span>            :      */
<span class="lineNum">    3081 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    3082 </span>            :     {
<span class="lineNum">    3083 </span>            :         /*
<span class="lineNum">    3084 </span>            :          * With ALTER DEFAULT PRIVILEGES, restrict completion to the kinds of
<span class="lineNum">    3085 </span>            :          * objects supported.
<span class="lineNum">    3086 </span>            :          */
<span class="lineNum">    3087 </span><span class="lineNoCov">          0 :         if (HeadMatches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;))</span>
<span class="lineNum">    3088 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TABLES&quot;, &quot;SEQUENCES&quot;, &quot;FUNCTIONS&quot;, &quot;PROCEDURES&quot;, &quot;ROUTINES&quot;, &quot;TYPES&quot;, &quot;SCHEMAS&quot;);</span>
<span class="lineNum">    3089 </span>            :         else
<span class="lineNum">    3090 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_grantables,</span>
<span class="lineNum">    3091 </span>            :                                        &quot; UNION SELECT 'ALL FUNCTIONS IN SCHEMA'&quot;
<span class="lineNum">    3092 </span>            :                                        &quot; UNION SELECT 'ALL PROCEDURES IN SCHEMA'&quot;
<span class="lineNum">    3093 </span>            :                                        &quot; UNION SELECT 'ALL ROUTINES IN SCHEMA'&quot;
<span class="lineNum">    3094 </span>            :                                        &quot; UNION SELECT 'ALL SEQUENCES IN SCHEMA'&quot;
<span class="lineNum">    3095 </span>            :                                        &quot; UNION SELECT 'ALL TABLES IN SCHEMA'&quot;
<span class="lineNum">    3096 </span>            :                                        &quot; UNION SELECT 'DATABASE'&quot;
<span class="lineNum">    3097 </span>            :                                        &quot; UNION SELECT 'DOMAIN'&quot;
<span class="lineNum">    3098 </span>            :                                        &quot; UNION SELECT 'FOREIGN DATA WRAPPER'&quot;
<span class="lineNum">    3099 </span>            :                                        &quot; UNION SELECT 'FOREIGN SERVER'&quot;
<span class="lineNum">    3100 </span>            :                                        &quot; UNION SELECT 'FUNCTION'&quot;
<span class="lineNum">    3101 </span>            :                                        &quot; UNION SELECT 'LANGUAGE'&quot;
<span class="lineNum">    3102 </span>            :                                        &quot; UNION SELECT 'LARGE OBJECT'&quot;
<span class="lineNum">    3103 </span>            :                                        &quot; UNION SELECT 'PROCEDURE'&quot;
<span class="lineNum">    3104 </span>            :                                        &quot; UNION SELECT 'ROUTINE'&quot;
<span class="lineNum">    3105 </span>            :                                        &quot; UNION SELECT 'SCHEMA'&quot;
<span class="lineNum">    3106 </span>            :                                        &quot; UNION SELECT 'SEQUENCE'&quot;
<span class="lineNum">    3107 </span>            :                                        &quot; UNION SELECT 'TABLE'&quot;
<span class="lineNum">    3108 </span>            :                                        &quot; UNION SELECT 'TABLESPACE'&quot;
<span class="lineNum">    3109 </span>            :                                        &quot; UNION SELECT 'TYPE'&quot;);
<span class="lineNum">    3110 </span>            :     }
<span class="lineNum">    3111 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;, &quot;ALL&quot;))</span>
<span class="lineNum">    3112 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FUNCTIONS IN SCHEMA&quot;,</span>
<span class="lineNum">    3113 </span>            :                       &quot;PROCEDURES IN SCHEMA&quot;,
<span class="lineNum">    3114 </span>            :                       &quot;ROUTINES IN SCHEMA&quot;,
<span class="lineNum">    3115 </span>            :                       &quot;SEQUENCES IN SCHEMA&quot;,
<span class="lineNum">    3116 </span>            :                       &quot;TABLES IN SCHEMA&quot;);
<span class="lineNum">    3117 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    3118 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA WRAPPER&quot;, &quot;SERVER&quot;);</span>
<span class="lineNum">    3119 </span>            : 
<span class="lineNum">    3120 </span>            :     /*
<span class="lineNum">    3121 </span>            :      * Complete &quot;GRANT/REVOKE * ON DATABASE/DOMAIN/...&quot; with a list of
<span class="lineNum">    3122 </span>            :      * appropriate objects.
<span class="lineNum">    3123 </span>            :      *
<span class="lineNum">    3124 </span>            :      * Complete &quot;GRANT/REVOKE * ON *&quot; with &quot;TO/FROM&quot;.
<span class="lineNum">    3125 </span>            :      */
<span class="lineNum">    3126 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;, MatchAny))</span>
<span class="lineNum">    3127 </span>            :     {
<span class="lineNum">    3128 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;DATABASE&quot;))</span>
<span class="lineNum">    3129 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_databases);</span>
<span class="lineNum">    3130 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;DOMAIN&quot;))</span>
<span class="lineNum">    3131 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_domains, NULL);</span>
<span class="lineNum">    3132 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;FUNCTION&quot;))</span>
<span class="lineNum">    3133 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_functions, NULL);</span>
<span class="lineNum">    3134 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;LANGUAGE&quot;))</span>
<span class="lineNum">    3135 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_languages);</span>
<span class="lineNum">    3136 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;PROCEDURE&quot;))</span>
<span class="lineNum">    3137 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_procedures, NULL);</span>
<span class="lineNum">    3138 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;ROUTINE&quot;))</span>
<span class="lineNum">    3139 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_routines, NULL);</span>
<span class="lineNum">    3140 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;SCHEMA&quot;))</span>
<span class="lineNum">    3141 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_schemas);</span>
<span class="lineNum">    3142 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;SEQUENCE&quot;))</span>
<span class="lineNum">    3143 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_sequences, NULL);</span>
<span class="lineNum">    3144 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;TABLE&quot;))</span>
<span class="lineNum">    3145 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_grantables, NULL);</span>
<span class="lineNum">    3146 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;TABLESPACE&quot;))</span>
<span class="lineNum">    3147 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_tablespaces);</span>
<span class="lineNum">    3148 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;TYPE&quot;))</span>
<span class="lineNum">    3149 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_datatypes, NULL);</span>
<span class="lineNum">    3150 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;GRANT&quot;, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    3151 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3152 </span>            :         else
<span class="lineNum">    3153 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    3154 </span>            :     }
<span class="lineNum">    3155 </span>            : 
<span class="lineNum">    3156 </span>            :     /*
<span class="lineNum">    3157 </span>            :      * Complete &quot;GRANT/REVOKE ... TO/FROM&quot; with username, PUBLIC,
<span class="lineNum">    3158 </span>            :      * CURRENT_USER, or SESSION_USER.
<span class="lineNum">    3159 </span>            :      */
<span class="lineNum">    3160 </span><span class="lineNoCov">          0 :     else if ((HeadMatches(&quot;GRANT&quot;) &amp;&amp; TailMatches(&quot;TO&quot;)) ||</span>
<span class="lineNum">    3161 </span><span class="lineNoCov">          0 :              (HeadMatches(&quot;REVOKE&quot;) &amp;&amp; TailMatches(&quot;FROM&quot;)))</span>
<span class="lineNum">    3162 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_grant_roles);</span>
<span class="lineNum">    3163 </span>            :     /* Complete &quot;ALTER DEFAULT PRIVILEGES ... GRANT/REVOKE ... TO/FROM */
<span class="lineNum">    3164 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;DEFAULT&quot;, &quot;PRIVILEGES&quot;) &amp;&amp; TailMatches(&quot;TO|FROM&quot;))</span>
<span class="lineNum">    3165 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_grant_roles);</span>
<span class="lineNum">    3166 </span>            :     /* Complete &quot;GRANT/REVOKE ... ON * *&quot; with TO/FROM */
<span class="lineNum">    3167 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;GRANT&quot;) &amp;&amp; TailMatches(&quot;ON&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    3168 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3169 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;REVOKE&quot;) &amp;&amp; TailMatches(&quot;ON&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    3170 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    3171 </span>            : 
<span class="lineNum">    3172 </span>            :     /* Complete &quot;GRANT/REVOKE * ON ALL * IN SCHEMA *&quot; with TO/FROM */
<span class="lineNum">    3173 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;, &quot;ALL&quot;, MatchAny, &quot;IN&quot;, &quot;SCHEMA&quot;, MatchAny))</span>
<span class="lineNum">    3174 </span>            :     {
<span class="lineNum">    3175 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;GRANT&quot;, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    3176 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3177 </span>            :         else
<span class="lineNum">    3178 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    3179 </span>            :     }
<span class="lineNum">    3180 </span>            : 
<span class="lineNum">    3181 </span>            :     /* Complete &quot;GRANT/REVOKE * ON FOREIGN DATA WRAPPER *&quot; with TO/FROM */
<span class="lineNum">    3182 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;, &quot;FOREIGN&quot;, &quot;DATA&quot;, &quot;WRAPPER&quot;, MatchAny))</span>
<span class="lineNum">    3183 </span>            :     {
<span class="lineNum">    3184 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;GRANT&quot;, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    3185 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3186 </span>            :         else
<span class="lineNum">    3187 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    3188 </span>            :     }
<span class="lineNum">    3189 </span>            : 
<span class="lineNum">    3190 </span>            :     /* Complete &quot;GRANT/REVOKE * ON FOREIGN SERVER *&quot; with TO/FROM */
<span class="lineNum">    3191 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;GRANT|REVOKE&quot;, MatchAny, &quot;ON&quot;, &quot;FOREIGN&quot;, &quot;SERVER&quot;, MatchAny))</span>
<span class="lineNum">    3192 </span>            :     {
<span class="lineNum">    3193 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;GRANT&quot;, MatchAny, MatchAny, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    3194 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3195 </span>            :         else
<span class="lineNum">    3196 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FROM&quot;);</span>
<span class="lineNum">    3197 </span>            :     }
<span class="lineNum">    3198 </span>            : 
<span class="lineNum">    3199 </span>            : /* GROUP BY */
<span class="lineNum">    3200 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FROM&quot;, MatchAny, &quot;GROUP&quot;))</span>
<span class="lineNum">    3201 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BY&quot;);</span>
<span class="lineNum">    3202 </span>            : 
<span class="lineNum">    3203 </span>            : /* IMPORT FOREIGN SCHEMA */
<span class="lineNum">    3204 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;IMPORT&quot;))</span>
<span class="lineNum">    3205 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOREIGN SCHEMA&quot;);</span>
<span class="lineNum">    3206 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;IMPORT&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    3207 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SCHEMA&quot;);</span>
<span class="lineNum">    3208 </span>            : 
<span class="lineNum">    3209 </span>            : /* INSERT --- can be inside EXPLAIN, RULE, etc */
<span class="lineNum">    3210 </span>            :     /* Complete INSERT with &quot;INTO&quot; */
<span class="lineNum">    3211 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INSERT&quot;))</span>
<span class="lineNum">    3212 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;INTO&quot;);</span>
<span class="lineNum">    3213 </span>            :     /* Complete INSERT INTO with table names */
<span class="lineNum">    3214 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INSERT&quot;, &quot;INTO&quot;))</span>
<span class="lineNum">    3215 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_updatables, NULL);</span>
<span class="lineNum">    3216 </span>            :     /* Complete &quot;INSERT INTO &lt;table&gt; (&quot; with attribute names */
<span class="lineNum">    3217 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INSERT&quot;, &quot;INTO&quot;, MatchAny, &quot;(&quot;))</span>
<span class="lineNum">    3218 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot;&quot;);</span>
<span class="lineNum">    3219 </span>            : 
<span class="lineNum">    3220 </span>            :     /*
<span class="lineNum">    3221 </span>            :      * Complete INSERT INTO &lt;table&gt; with &quot;(&quot; or &quot;VALUES&quot; or &quot;SELECT&quot; or
<span class="lineNum">    3222 </span>            :      * &quot;TABLE&quot; or &quot;DEFAULT VALUES&quot; or &quot;OVERRIDING&quot;
<span class="lineNum">    3223 </span>            :      */
<span class="lineNum">    3224 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INSERT&quot;, &quot;INTO&quot;, MatchAny))</span>
<span class="lineNum">    3225 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;, &quot;DEFAULT VALUES&quot;, &quot;SELECT&quot;, &quot;TABLE&quot;, &quot;VALUES&quot;, &quot;OVERRIDING&quot;);</span>
<span class="lineNum">    3226 </span>            : 
<span class="lineNum">    3227 </span>            :     /*
<span class="lineNum">    3228 </span>            :      * Complete INSERT INTO &lt;table&gt; (attribs) with &quot;VALUES&quot; or &quot;SELECT&quot; or
<span class="lineNum">    3229 </span>            :      * &quot;TABLE&quot; or &quot;OVERRIDING&quot;
<span class="lineNum">    3230 </span>            :      */
<span class="lineNum">    3231 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;INSERT&quot;, &quot;INTO&quot;, MatchAny, MatchAny) &amp;&amp;</span>
<span class="lineNum">    3232 </span><span class="lineNoCov">          0 :              ends_with(prev_wd, ')'))</span>
<span class="lineNum">    3233 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;TABLE&quot;, &quot;VALUES&quot;, &quot;OVERRIDING&quot;);</span>
<span class="lineNum">    3234 </span>            : 
<span class="lineNum">    3235 </span>            :     /* Complete OVERRIDING */
<span class="lineNum">    3236 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;OVERRIDING&quot;))</span>
<span class="lineNum">    3237 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SYSTEM VALUE&quot;, &quot;USER VALUE&quot;);</span>
<span class="lineNum">    3238 </span>            : 
<span class="lineNum">    3239 </span>            :     /* Complete after OVERRIDING clause */
<span class="lineNum">    3240 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;OVERRIDING&quot;, MatchAny, &quot;VALUE&quot;))</span>
<span class="lineNum">    3241 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;TABLE&quot;, &quot;VALUES&quot;);</span>
<span class="lineNum">    3242 </span>            : 
<span class="lineNum">    3243 </span>            :     /* Insert an open parenthesis after &quot;VALUES&quot; */
<span class="lineNum">    3244 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;VALUES&quot;) &amp;&amp; !TailMatches(&quot;DEFAULT&quot;, &quot;VALUES&quot;))</span>
<span class="lineNum">    3245 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    3246 </span>            : 
<span class="lineNum">    3247 </span>            : /* LOCK */
<span class="lineNum">    3248 </span>            :     /* Complete LOCK [TABLE] with a list of tables */
<span class="lineNum">    3249 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;LOCK&quot;))</span>
<span class="lineNum">    3250 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables,</span>
<span class="lineNum">    3251 </span>            :                                    &quot; UNION SELECT 'TABLE'&quot;);
<span class="lineNum">    3252 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;LOCK&quot;, &quot;TABLE&quot;))</span>
<span class="lineNum">    3253 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, &quot;&quot;);</span>
<span class="lineNum">    3254 </span>            : 
<span class="lineNum">    3255 </span>            :     /* For the following, handle the case of a single table only for now */
<span class="lineNum">    3256 </span>            : 
<span class="lineNum">    3257 </span>            :     /* Complete LOCK [TABLE] &lt;table&gt; with &quot;IN&quot; */
<span class="lineNum">    3258 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;LOCK&quot;, MatchAnyExcept(&quot;TABLE&quot;)) ||</span>
<span class="lineNum">    3259 </span><span class="lineNoCov">          0 :              Matches(&quot;LOCK&quot;, &quot;TABLE&quot;, MatchAny))</span>
<span class="lineNum">    3260 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;IN&quot;);</span>
<span class="lineNum">    3261 </span>            : 
<span class="lineNum">    3262 </span>            :     /* Complete LOCK [TABLE] &lt;table&gt; IN with a lock mode */
<span class="lineNum">    3263 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;LOCK&quot;, MatchAny, &quot;IN&quot;) ||</span>
<span class="lineNum">    3264 </span><span class="lineNoCov">          0 :              Matches(&quot;LOCK&quot;, &quot;TABLE&quot;, MatchAny, &quot;IN&quot;))</span>
<span class="lineNum">    3265 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ACCESS SHARE MODE&quot;,</span>
<span class="lineNum">    3266 </span>            :                       &quot;ROW SHARE MODE&quot;, &quot;ROW EXCLUSIVE MODE&quot;,
<span class="lineNum">    3267 </span>            :                       &quot;SHARE UPDATE EXCLUSIVE MODE&quot;, &quot;SHARE MODE&quot;,
<span class="lineNum">    3268 </span>            :                       &quot;SHARE ROW EXCLUSIVE MODE&quot;,
<span class="lineNum">    3269 </span>            :                       &quot;EXCLUSIVE MODE&quot;, &quot;ACCESS EXCLUSIVE MODE&quot;);
<span class="lineNum">    3270 </span>            : 
<span class="lineNum">    3271 </span>            :     /* Complete LOCK [TABLE] &lt;table&gt; IN ACCESS|ROW with rest of lock mode */
<span class="lineNum">    3272 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;LOCK&quot;, MatchAny, &quot;IN&quot;, &quot;ACCESS|ROW&quot;) ||</span>
<span class="lineNum">    3273 </span><span class="lineNoCov">          0 :              Matches(&quot;LOCK&quot;, &quot;TABLE&quot;, MatchAny, &quot;IN&quot;, &quot;ACCESS|ROW&quot;))</span>
<span class="lineNum">    3274 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;EXCLUSIVE MODE&quot;, &quot;SHARE MODE&quot;);</span>
<span class="lineNum">    3275 </span>            : 
<span class="lineNum">    3276 </span>            :     /* Complete LOCK [TABLE] &lt;table&gt; IN SHARE with rest of lock mode */
<span class="lineNum">    3277 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;LOCK&quot;, MatchAny, &quot;IN&quot;, &quot;SHARE&quot;) ||</span>
<span class="lineNum">    3278 </span><span class="lineNoCov">          0 :              Matches(&quot;LOCK&quot;, &quot;TABLE&quot;, MatchAny, &quot;IN&quot;, &quot;SHARE&quot;))</span>
<span class="lineNum">    3279 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;MODE&quot;, &quot;ROW EXCLUSIVE MODE&quot;,</span>
<span class="lineNum">    3280 </span>            :                       &quot;UPDATE EXCLUSIVE MODE&quot;);
<span class="lineNum">    3281 </span>            : 
<span class="lineNum">    3282 </span>            : /* NOTIFY --- can be inside EXPLAIN, RULE, etc */
<span class="lineNum">    3283 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;NOTIFY&quot;))</span>
<span class="lineNum">    3284 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(&quot;SELECT pg_catalog.quote_ident(channel) FROM pg_catalog.pg_listening_channels() AS channel WHERE substring(pg_catalog.quote_ident(channel),1,%d)='%s'&quot;);</span>
<span class="lineNum">    3285 </span>            : 
<span class="lineNum">    3286 </span>            : /* OPTIONS */
<span class="lineNum">    3287 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;OPTIONS&quot;))</span>
<span class="lineNum">    3288 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    3289 </span>            : 
<span class="lineNum">    3290 </span>            : /* OWNER TO  - complete with available roles */
<span class="lineNum">    3291 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;OWNER&quot;, &quot;TO&quot;))</span>
<span class="lineNum">    3292 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3293 </span>            : 
<span class="lineNum">    3294 </span>            : /* ORDER BY */
<span class="lineNum">    3295 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FROM&quot;, MatchAny, &quot;ORDER&quot;))</span>
<span class="lineNum">    3296 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BY&quot;);</span>
<span class="lineNum">    3297 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FROM&quot;, MatchAny, &quot;ORDER&quot;, &quot;BY&quot;))</span>
<span class="lineNum">    3298 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev3_wd, &quot;&quot;);</span>
<span class="lineNum">    3299 </span>            : 
<span class="lineNum">    3300 </span>            : /* PREPARE xx AS */
<span class="lineNum">    3301 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;PREPARE&quot;, MatchAny, &quot;AS&quot;))</span>
<span class="lineNum">    3302 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SELECT&quot;, &quot;UPDATE&quot;, &quot;INSERT&quot;, &quot;DELETE FROM&quot;);</span>
<span class="lineNum">    3303 </span>            : 
<span class="lineNum">    3304 </span>            : /*
<span class="lineNum">    3305 </span>            :  * PREPARE TRANSACTION is missing on purpose. It's intended for transaction
<span class="lineNum">    3306 </span>            :  * managers, not for manual use in interactive sessions.
<span class="lineNum">    3307 </span>            :  */
<span class="lineNum">    3308 </span>            : 
<span class="lineNum">    3309 </span>            : /* REASSIGN OWNED BY xxx TO yyy */
<span class="lineNum">    3310 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REASSIGN&quot;))</span>
<span class="lineNum">    3311 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OWNED BY&quot;);</span>
<span class="lineNum">    3312 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REASSIGN&quot;, &quot;OWNED&quot;))</span>
<span class="lineNum">    3313 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;BY&quot;);</span>
<span class="lineNum">    3314 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REASSIGN&quot;, &quot;OWNED&quot;, &quot;BY&quot;))</span>
<span class="lineNum">    3315 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3316 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REASSIGN&quot;, &quot;OWNED&quot;, &quot;BY&quot;, MatchAny))</span>
<span class="lineNum">    3317 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3318 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REASSIGN&quot;, &quot;OWNED&quot;, &quot;BY&quot;, MatchAny, &quot;TO&quot;))</span>
<span class="lineNum">    3319 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3320 </span>            : 
<span class="lineNum">    3321 </span>            : /* REFRESH MATERIALIZED VIEW */
<span class="lineNum">    3322 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;))</span>
<span class="lineNum">    3323 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;MATERIALIZED VIEW&quot;);</span>
<span class="lineNum">    3324 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;))</span>
<span class="lineNum">    3325 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;VIEW&quot;);</span>
<span class="lineNum">    3326 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;))</span>
<span class="lineNum">    3327 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_matviews,</span>
<span class="lineNum">    3328 </span>            :                                    &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    3329 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    3330 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_matviews, NULL);</span>
<span class="lineNum">    3331 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny))</span>
<span class="lineNum">    3332 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH&quot;);</span>
<span class="lineNum">    3333 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, &quot;CONCURRENTLY&quot;, MatchAny))</span>
<span class="lineNum">    3334 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;WITH&quot;);</span>
<span class="lineNum">    3335 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;WITH&quot;))</span>
<span class="lineNum">    3336 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;NO DATA&quot;, &quot;DATA&quot;);</span>
<span class="lineNum">    3337 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, &quot;CONCURRENTLY&quot;, MatchAny, &quot;WITH&quot;))</span>
<span class="lineNum">    3338 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;NO DATA&quot;, &quot;DATA&quot;);</span>
<span class="lineNum">    3339 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, MatchAny, &quot;WITH&quot;, &quot;NO&quot;))</span>
<span class="lineNum">    3340 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA&quot;);</span>
<span class="lineNum">    3341 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REFRESH&quot;, &quot;MATERIALIZED&quot;, &quot;VIEW&quot;, &quot;CONCURRENTLY&quot;, MatchAny, &quot;WITH&quot;, &quot;NO&quot;))</span>
<span class="lineNum">    3342 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DATA&quot;);</span>
<span class="lineNum">    3343 </span>            : 
<span class="lineNum">    3344 </span>            : /* REINDEX */
<span class="lineNum">    3345 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;))</span>
<span class="lineNum">    3346 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TABLE&quot;, &quot;INDEX&quot;, &quot;SYSTEM&quot;, &quot;SCHEMA&quot;, &quot;DATABASE&quot;);</span>
<span class="lineNum">    3347 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;TABLE&quot;))</span>
<span class="lineNum">    3348 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexables,</span>
<span class="lineNum">    3349 </span>            :                                    &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    3350 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;INDEX&quot;))</span>
<span class="lineNum">    3351 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes,</span>
<span class="lineNum">    3352 </span>            :                                    &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    3353 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;SCHEMA&quot;))</span>
<span class="lineNum">    3354 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_schemas</span>
<span class="lineNum">    3355 </span>            :                             &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    3356 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;SYSTEM|DATABASE&quot;))</span>
<span class="lineNum">    3357 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_databases</span>
<span class="lineNum">    3358 </span>            :                             &quot; UNION SELECT 'CONCURRENTLY'&quot;);
<span class="lineNum">    3359 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;TABLE&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    3360 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexables, NULL);</span>
<span class="lineNum">    3361 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;INDEX&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    3362 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes, NULL);</span>
<span class="lineNum">    3363 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;SCHEMA&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    3364 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_schemas);</span>
<span class="lineNum">    3365 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;REINDEX&quot;, &quot;SYSTEM|DATABASE&quot;, &quot;CONCURRENTLY&quot;))</span>
<span class="lineNum">    3366 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_databases);</span>
<span class="lineNum">    3367 </span>            : 
<span class="lineNum">    3368 </span>            : /* SECURITY LABEL */
<span class="lineNum">    3369 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SECURITY&quot;))</span>
<span class="lineNum">    3370 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;LABEL&quot;);</span>
<span class="lineNum">    3371 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SECURITY&quot;, &quot;LABEL&quot;))</span>
<span class="lineNum">    3372 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;, &quot;FOR&quot;);</span>
<span class="lineNum">    3373 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SECURITY&quot;, &quot;LABEL&quot;, &quot;FOR&quot;, MatchAny))</span>
<span class="lineNum">    3374 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ON&quot;);</span>
<span class="lineNum">    3375 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SECURITY&quot;, &quot;LABEL&quot;, &quot;ON&quot;) ||</span>
<span class="lineNum">    3376 </span><span class="lineNoCov">          0 :              Matches(&quot;SECURITY&quot;, &quot;LABEL&quot;, &quot;FOR&quot;, MatchAny, &quot;ON&quot;))</span>
<span class="lineNum">    3377 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TABLE&quot;, &quot;COLUMN&quot;, &quot;AGGREGATE&quot;, &quot;DATABASE&quot;, &quot;DOMAIN&quot;,</span>
<span class="lineNum">    3378 </span>            :                       &quot;EVENT TRIGGER&quot;, &quot;FOREIGN TABLE&quot;, &quot;FUNCTION&quot;,
<span class="lineNum">    3379 </span>            :                       &quot;LARGE OBJECT&quot;, &quot;MATERIALIZED VIEW&quot;, &quot;LANGUAGE&quot;,
<span class="lineNum">    3380 </span>            :                       &quot;PUBLICATION&quot;, &quot;PROCEDURE&quot;, &quot;ROLE&quot;, &quot;ROUTINE&quot;, &quot;SCHEMA&quot;,
<span class="lineNum">    3381 </span>            :                       &quot;SEQUENCE&quot;, &quot;SUBSCRIPTION&quot;, &quot;TABLESPACE&quot;, &quot;TYPE&quot;, &quot;VIEW&quot;);
<span class="lineNum">    3382 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SECURITY&quot;, &quot;LABEL&quot;, &quot;ON&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    3383 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;IS&quot;);</span>
<span class="lineNum">    3384 </span>            : 
<span class="lineNum">    3385 </span>            : /* SELECT */
<span class="lineNum">    3386 </span>            :     /* naah . . . */
<span class="lineNum">    3387 </span>            : 
<span class="lineNum">    3388 </span>            : /* SET, RESET, SHOW */
<span class="lineNum">    3389 </span>            :     /* Complete with a variable name */
<span class="lineNum">    3390 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;SET|RESET&quot;) &amp;&amp; !TailMatches(&quot;UPDATE&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    3391 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_set_vars);</span>
<span class="lineNum">    3392 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SHOW&quot;))</span>
<span class="lineNum">    3393 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_show_vars);</span>
<span class="lineNum">    3394 </span>            :     /* Complete &quot;SET TRANSACTION&quot; */
<span class="lineNum">    3395 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, &quot;TRANSACTION&quot;))</span>
<span class="lineNum">    3396 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SNAPSHOT&quot;, &quot;ISOLATION LEVEL&quot;, &quot;READ&quot;, &quot;DEFERRABLE&quot;, &quot;NOT DEFERRABLE&quot;);</span>
<span class="lineNum">    3397 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;BEGIN|START&quot;, &quot;TRANSACTION&quot;) ||</span>
<span class="lineNum">    3398 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;WORK&quot;) ||</span>
<span class="lineNum">    3399 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;) ||</span>
<span class="lineNum">    3400 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;))</span>
<span class="lineNum">    3401 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ISOLATION LEVEL&quot;, &quot;READ&quot;, &quot;DEFERRABLE&quot;, &quot;NOT DEFERRABLE&quot;);</span>
<span class="lineNum">    3402 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET|BEGIN|START&quot;, &quot;TRANSACTION|WORK&quot;, &quot;NOT&quot;) ||</span>
<span class="lineNum">    3403 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;NOT&quot;) ||</span>
<span class="lineNum">    3404 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;, &quot;NOT&quot;))</span>
<span class="lineNum">    3405 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DEFERRABLE&quot;);</span>
<span class="lineNum">    3406 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET|BEGIN|START&quot;, &quot;TRANSACTION|WORK&quot;, &quot;ISOLATION&quot;) ||</span>
<span class="lineNum">    3407 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;ISOLATION&quot;) ||</span>
<span class="lineNum">    3408 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;, &quot;ISOLATION&quot;))</span>
<span class="lineNum">    3409 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;LEVEL&quot;);</span>
<span class="lineNum">    3410 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET|BEGIN|START&quot;, &quot;TRANSACTION|WORK&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;) ||</span>
<span class="lineNum">    3411 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;) ||</span>
<span class="lineNum">    3412 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;))</span>
<span class="lineNum">    3413 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;READ&quot;, &quot;REPEATABLE READ&quot;, &quot;SERIALIZABLE&quot;);</span>
<span class="lineNum">    3414 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET|BEGIN|START&quot;, &quot;TRANSACTION|WORK&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;, &quot;READ&quot;) ||</span>
<span class="lineNum">    3415 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;, &quot;READ&quot;) ||</span>
<span class="lineNum">    3416 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;, &quot;READ&quot;))</span>
<span class="lineNum">    3417 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;UNCOMMITTED&quot;, &quot;COMMITTED&quot;);</span>
<span class="lineNum">    3418 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET|BEGIN|START&quot;, &quot;TRANSACTION|WORK&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;, &quot;REPEATABLE&quot;) ||</span>
<span class="lineNum">    3419 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;, &quot;REPEATABLE&quot;) ||</span>
<span class="lineNum">    3420 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;, &quot;ISOLATION&quot;, &quot;LEVEL&quot;, &quot;REPEATABLE&quot;))</span>
<span class="lineNum">    3421 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;READ&quot;);</span>
<span class="lineNum">    3422 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET|BEGIN|START&quot;, &quot;TRANSACTION|WORK&quot;, &quot;READ&quot;) ||</span>
<span class="lineNum">    3423 </span><span class="lineNoCov">          0 :              Matches(&quot;BEGIN&quot;, &quot;READ&quot;) ||</span>
<span class="lineNum">    3424 </span><span class="lineNoCov">          0 :              Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;CHARACTERISTICS&quot;, &quot;AS&quot;, &quot;TRANSACTION&quot;, &quot;READ&quot;))</span>
<span class="lineNum">    3425 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;ONLY&quot;, &quot;WRITE&quot;);</span>
<span class="lineNum">    3426 </span>            :     /* SET CONSTRAINTS */
<span class="lineNum">    3427 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, &quot;CONSTRAINTS&quot;))</span>
<span class="lineNum">    3428 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_constraints_with_schema, &quot;UNION SELECT 'ALL'&quot;);</span>
<span class="lineNum">    3429 </span>            :     /* Complete SET CONSTRAINTS &lt;foo&gt; with DEFERRED|IMMEDIATE */
<span class="lineNum">    3430 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, &quot;CONSTRAINTS&quot;, MatchAny))</span>
<span class="lineNum">    3431 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;DEFERRED&quot;, &quot;IMMEDIATE&quot;);</span>
<span class="lineNum">    3432 </span>            :     /* Complete SET ROLE */
<span class="lineNum">    3433 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, &quot;ROLE&quot;))</span>
<span class="lineNum">    3434 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3435 </span>            :     /* Complete SET SESSION with AUTHORIZATION or CHARACTERISTICS... */
<span class="lineNum">    3436 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, &quot;SESSION&quot;))</span>
<span class="lineNum">    3437 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AUTHORIZATION&quot;, &quot;CHARACTERISTICS AS TRANSACTION&quot;);</span>
<span class="lineNum">    3438 </span>            :     /* Complete SET SESSION AUTHORIZATION with username */
<span class="lineNum">    3439 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, &quot;SESSION&quot;, &quot;AUTHORIZATION&quot;))</span>
<span class="lineNum">    3440 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles &quot; UNION SELECT 'DEFAULT'&quot;);</span>
<span class="lineNum">    3441 </span>            :     /* Complete RESET SESSION with AUTHORIZATION */
<span class="lineNum">    3442 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;RESET&quot;, &quot;SESSION&quot;))</span>
<span class="lineNum">    3443 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;AUTHORIZATION&quot;);</span>
<span class="lineNum">    3444 </span>            :     /* Complete SET &lt;var&gt; with &quot;TO&quot; */
<span class="lineNum">    3445 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;SET&quot;, MatchAny))</span>
<span class="lineNum">    3446 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TO&quot;);</span>
<span class="lineNum">    3447 </span>            : 
<span class="lineNum">    3448 </span>            :     /*
<span class="lineNum">    3449 </span>            :      * Complete ALTER DATABASE|FUNCTION||PROCEDURE|ROLE|ROUTINE|USER ... SET
<span class="lineNum">    3450 </span>            :      * &lt;name&gt;
<span class="lineNum">    3451 </span>            :      */
<span class="lineNum">    3452 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;ALTER&quot;, &quot;DATABASE|FUNCTION|PROCEDURE|ROLE|ROUTINE|USER&quot;) &amp;&amp;</span>
<span class="lineNum">    3453 </span><span class="lineNoCov">          0 :              TailMatches(&quot;SET&quot;, MatchAny))</span>
<span class="lineNum">    3454 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FROM CURRENT&quot;, &quot;TO&quot;);</span>
<span class="lineNum">    3455 </span>            : 
<span class="lineNum">    3456 </span>            :     /*
<span class="lineNum">    3457 </span>            :      * Suggest possible variable values in SET variable TO|=, along with the
<span class="lineNum">    3458 </span>            :      * preceding ALTER syntaxes.
<span class="lineNum">    3459 </span>            :      */
<span class="lineNum">    3460 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;SET&quot;, MatchAny, &quot;TO|=&quot;) &amp;&amp;</span>
<span class="lineNum">    3461 </span><span class="lineNoCov">          0 :              !TailMatches(&quot;UPDATE&quot;, MatchAny, &quot;SET&quot;, MatchAny, &quot;TO|=&quot;))</span>
<span class="lineNum">    3462 </span>            :     {
<span class="lineNum">    3463 </span>            :         /* special cased code for individual GUCs */
<span class="lineNum">    3464 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;DateStyle&quot;, &quot;TO|=&quot;))</span>
<span class="lineNum">    3465 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;ISO&quot;, &quot;SQL&quot;, &quot;Postgres&quot;, &quot;German&quot;,</span>
<span class="lineNum">    3466 </span>            :                           &quot;YMD&quot;, &quot;DMY&quot;, &quot;MDY&quot;,
<span class="lineNum">    3467 </span>            :                           &quot;US&quot;, &quot;European&quot;, &quot;NonEuropean&quot;,
<span class="lineNum">    3468 </span>            :                           &quot;DEFAULT&quot;);
<span class="lineNum">    3469 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;search_path&quot;, &quot;TO|=&quot;))</span>
<span class="lineNum">    3470 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_schemas</span>
<span class="lineNum">    3471 </span>            :                                 &quot; AND nspname not like 'pg\\_toast%%' &quot;
<span class="lineNum">    3472 </span>            :                                 &quot; AND nspname not like 'pg\\_temp%%' &quot;
<span class="lineNum">    3473 </span>            :                                 &quot; UNION SELECT 'DEFAULT' &quot;);
<span class="lineNum">    3474 </span>            :         else
<span class="lineNum">    3475 </span>            :         {
<span class="lineNum">    3476 </span>            :             /* generic, type based, GUC support */
<span class="lineNum">    3477 </span><span class="lineNoCov">          0 :             char       *guctype = get_guctype(prev2_wd);</span>
<span class="lineNum">    3478 </span>            : 
<span class="lineNum">    3479 </span>            :             /*
<span class="lineNum">    3480 </span>            :              * Note: if we don't recognize the GUC name, it's important to not
<span class="lineNum">    3481 </span>            :              * offer any completions, as most likely we've misinterpreted the
<span class="lineNum">    3482 </span>            :              * context and this isn't a GUC-setting command at all.
<span class="lineNum">    3483 </span>            :              */
<span class="lineNum">    3484 </span><span class="lineNoCov">          0 :             if (guctype)</span>
<span class="lineNum">    3485 </span>            :             {
<span class="lineNum">    3486 </span><span class="lineNoCov">          0 :                 if (strcmp(guctype, &quot;enum&quot;) == 0)</span>
<span class="lineNum">    3487 </span>            :                 {
<span class="lineNum">    3488 </span>            :                     char        querybuf[1024];
<span class="lineNum">    3489 </span>            : 
<span class="lineNum">    3490 </span><span class="lineNoCov">          0 :                     snprintf(querybuf, sizeof(querybuf),</span>
<span class="lineNum">    3491 </span><span class="lineNoCov">          0 :                              Query_for_enum, prev2_wd);</span>
<span class="lineNum">    3492 </span><span class="lineNoCov">          0 :                     COMPLETE_WITH_QUERY(querybuf);</span>
<span class="lineNum">    3493 </span>            :                 }
<span class="lineNum">    3494 </span><span class="lineNoCov">          0 :                 else if (strcmp(guctype, &quot;bool&quot;) == 0)</span>
<span class="lineNum">    3495 </span><span class="lineNoCov">          0 :                     COMPLETE_WITH(&quot;on&quot;, &quot;off&quot;, &quot;true&quot;, &quot;false&quot;, &quot;yes&quot;, &quot;no&quot;,</span>
<span class="lineNum">    3496 </span>            :                                   &quot;1&quot;, &quot;0&quot;, &quot;DEFAULT&quot;);
<span class="lineNum">    3497 </span>            :                 else
<span class="lineNum">    3498 </span><span class="lineNoCov">          0 :                     COMPLETE_WITH(&quot;DEFAULT&quot;);</span>
<span class="lineNum">    3499 </span>            : 
<span class="lineNum">    3500 </span><span class="lineNoCov">          0 :                 free(guctype);</span>
<span class="lineNum">    3501 </span>            :             }
<span class="lineNum">    3502 </span>            :         }
<span class="lineNum">    3503 </span>            :     }
<span class="lineNum">    3504 </span>            : 
<span class="lineNum">    3505 </span>            : /* START TRANSACTION */
<span class="lineNum">    3506 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;START&quot;))</span>
<span class="lineNum">    3507 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;TRANSACTION&quot;);</span>
<span class="lineNum">    3508 </span>            : 
<span class="lineNum">    3509 </span>            : /* TABLE, but not TABLE embedded in other commands */
<span class="lineNum">    3510 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;TABLE&quot;))</span>
<span class="lineNum">    3511 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_selectables, NULL);</span>
<span class="lineNum">    3512 </span>            : 
<span class="lineNum">    3513 </span>            : /* TABLESAMPLE */
<span class="lineNum">    3514 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;TABLESAMPLE&quot;))</span>
<span class="lineNum">    3515 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tablesample_methods);</span>
<span class="lineNum">    3516 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;TABLESAMPLE&quot;, MatchAny))</span>
<span class="lineNum">    3517 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;(&quot;);</span>
<span class="lineNum">    3518 </span>            : 
<span class="lineNum">    3519 </span>            : /* TRUNCATE */
<span class="lineNum">    3520 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;TRUNCATE&quot;))</span>
<span class="lineNum">    3521 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    3522 </span>            : 
<span class="lineNum">    3523 </span>            : /* UNLISTEN */
<span class="lineNum">    3524 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;UNLISTEN&quot;))</span>
<span class="lineNum">    3525 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(&quot;SELECT pg_catalog.quote_ident(channel) FROM pg_catalog.pg_listening_channels() AS channel WHERE substring(pg_catalog.quote_ident(channel),1,%d)='%s' UNION SELECT '*'&quot;);</span>
<span class="lineNum">    3526 </span>            : 
<span class="lineNum">    3527 </span>            : /* UPDATE --- can be inside EXPLAIN, RULE, etc */
<span class="lineNum">    3528 </span>            :     /* If prev. word is UPDATE suggest a list of tables */
<span class="lineNum">    3529 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;UPDATE&quot;))</span>
<span class="lineNum">    3530 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_updatables, NULL);</span>
<span class="lineNum">    3531 </span>            :     /* Complete UPDATE &lt;table&gt; with &quot;SET&quot; */
<span class="lineNum">    3532 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;UPDATE&quot;, MatchAny))</span>
<span class="lineNum">    3533 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SET&quot;);</span>
<span class="lineNum">    3534 </span>            :     /* Complete UPDATE &lt;table&gt; SET with list of attributes */
<span class="lineNum">    3535 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;UPDATE&quot;, MatchAny, &quot;SET&quot;))</span>
<span class="lineNum">    3536 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot;&quot;);</span>
<span class="lineNum">    3537 </span>            :     /* UPDATE &lt;table&gt; SET &lt;attr&gt; = */
<span class="lineNum">    3538 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;UPDATE&quot;, MatchAny, &quot;SET&quot;, MatchAnyExcept(&quot;*=&quot;)))</span>
<span class="lineNum">    3539 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;=&quot;);</span>
<span class="lineNum">    3540 </span>            : 
<span class="lineNum">    3541 </span>            : /* USER MAPPING */
<span class="lineNum">    3542 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER|CREATE|DROP&quot;, &quot;USER&quot;, &quot;MAPPING&quot;))</span>
<span class="lineNum">    3543 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;FOR&quot;);</span>
<span class="lineNum">    3544 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE&quot;, &quot;USER&quot;, &quot;MAPPING&quot;, &quot;FOR&quot;))</span>
<span class="lineNum">    3545 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles</span>
<span class="lineNum">    3546 </span>            :                             &quot; UNION SELECT 'CURRENT_USER'&quot;
<span class="lineNum">    3547 </span>            :                             &quot; UNION SELECT 'PUBLIC'&quot;
<span class="lineNum">    3548 </span>            :                             &quot; UNION SELECT 'USER'&quot;);
<span class="lineNum">    3549 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;ALTER|DROP&quot;, &quot;USER&quot;, &quot;MAPPING&quot;, &quot;FOR&quot;))</span>
<span class="lineNum">    3550 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_user_mappings);</span>
<span class="lineNum">    3551 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE|ALTER|DROP&quot;, &quot;USER&quot;, &quot;MAPPING&quot;, &quot;FOR&quot;, MatchAny))</span>
<span class="lineNum">    3552 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;SERVER&quot;);</span>
<span class="lineNum">    3553 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;CREATE|ALTER&quot;, &quot;USER&quot;, &quot;MAPPING&quot;, &quot;FOR&quot;, MatchAny, &quot;SERVER&quot;, MatchAny))</span>
<span class="lineNum">    3554 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;OPTIONS&quot;);</span>
<span class="lineNum">    3555 </span>            : 
<span class="lineNum">    3556 </span>            : /*
<span class="lineNum">    3557 </span>            :  * VACUUM [ ( option [, ...] ) ] [ table_and_columns [, ...] ]
<span class="lineNum">    3558 </span>            :  * VACUUM [ FULL ] [ FREEZE ] [ VERBOSE ] [ ANALYZE ] [ table_and_columns [, ...] ]
<span class="lineNum">    3559 </span>            :  */
<span class="lineNum">    3560 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;VACUUM&quot;))</span>
<span class="lineNum">    3561 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_vacuumables,</span>
<span class="lineNum">    3562 </span>            :                                    &quot; UNION SELECT 'FULL'&quot;
<span class="lineNum">    3563 </span>            :                                    &quot; UNION SELECT 'FREEZE'&quot;
<span class="lineNum">    3564 </span>            :                                    &quot; UNION SELECT 'ANALYZE'&quot;
<span class="lineNum">    3565 </span>            :                                    &quot; UNION SELECT 'VERBOSE'&quot;);
<span class="lineNum">    3566 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;VACUUM&quot;, &quot;FULL&quot;))</span>
<span class="lineNum">    3567 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_vacuumables,</span>
<span class="lineNum">    3568 </span>            :                                    &quot; UNION SELECT 'FREEZE'&quot;
<span class="lineNum">    3569 </span>            :                                    &quot; UNION SELECT 'ANALYZE'&quot;
<span class="lineNum">    3570 </span>            :                                    &quot; UNION SELECT 'VERBOSE'&quot;);
<span class="lineNum">    3571 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;VACUUM&quot;, &quot;FREEZE&quot;) ||</span>
<span class="lineNum">    3572 </span><span class="lineNoCov">          0 :              Matches(&quot;VACUUM&quot;, &quot;FULL&quot;, &quot;FREEZE&quot;))</span>
<span class="lineNum">    3573 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_vacuumables,</span>
<span class="lineNum">    3574 </span>            :                                    &quot; UNION SELECT 'VERBOSE'&quot;
<span class="lineNum">    3575 </span>            :                                    &quot; UNION SELECT 'ANALYZE'&quot;);
<span class="lineNum">    3576 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;VACUUM&quot;, &quot;VERBOSE&quot;) ||</span>
<span class="lineNum">    3577 </span><span class="lineNoCov">          0 :              Matches(&quot;VACUUM&quot;, &quot;FULL|FREEZE&quot;, &quot;VERBOSE&quot;) ||</span>
<span class="lineNum">    3578 </span><span class="lineNoCov">          0 :              Matches(&quot;VACUUM&quot;, &quot;FULL&quot;, &quot;FREEZE&quot;, &quot;VERBOSE&quot;))</span>
<span class="lineNum">    3579 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_vacuumables,</span>
<span class="lineNum">    3580 </span>            :                                    &quot; UNION SELECT 'ANALYZE'&quot;);
<span class="lineNum">    3581 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;VACUUM&quot;, &quot;(*&quot;) &amp;&amp;</span>
<span class="lineNum">    3582 </span><span class="lineNoCov">          0 :              !HeadMatches(&quot;VACUUM&quot;, &quot;(*)&quot;))</span>
<span class="lineNum">    3583 </span>            :     {
<span class="lineNum">    3584 </span>            :         /*
<span class="lineNum">    3585 </span>            :          * This fires if we're in an unfinished parenthesized option list.
<span class="lineNum">    3586 </span>            :          * get_previous_words treats a completed parenthesized option list as
<span class="lineNum">    3587 </span>            :          * one word, so the above test is correct.
<span class="lineNum">    3588 </span>            :          */
<span class="lineNum">    3589 </span><span class="lineNoCov">          0 :         if (ends_with(prev_wd, '(') || ends_with(prev_wd, ','))</span>
<span class="lineNum">    3590 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FULL&quot;, &quot;FREEZE&quot;, &quot;ANALYZE&quot;, &quot;VERBOSE&quot;,</span>
<span class="lineNum">    3591 </span>            :                           &quot;DISABLE_PAGE_SKIPPING&quot;, &quot;SKIP_LOCKED&quot;,
<span class="lineNum">    3592 </span>            :                           &quot;INDEX_CLEANUP&quot;, &quot;TRUNCATE&quot;);
<span class="lineNum">    3593 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;FULL|FREEZE|ANALYZE|VERBOSE|DISABLE_PAGE_SKIPPING|SKIP_LOCKED|INDEX_CLEANUP|TRUNCATE&quot;))</span>
<span class="lineNum">    3594 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;ON&quot;, &quot;OFF&quot;);</span>
<span class="lineNum">    3595 </span>            :     }
<span class="lineNum">    3596 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;VACUUM&quot;) &amp;&amp; TailMatches(&quot;(&quot;))</span>
<span class="lineNum">    3597 </span>            :         /* &quot;VACUUM (&quot; should be caught above, so assume we want columns */
<span class="lineNum">    3598 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot;&quot;);</span>
<span class="lineNum">    3599 </span><span class="lineNoCov">          0 :     else if (HeadMatches(&quot;VACUUM&quot;))</span>
<span class="lineNum">    3600 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_vacuumables, NULL);</span>
<span class="lineNum">    3601 </span>            : 
<span class="lineNum">    3602 </span>            : /* WITH [RECURSIVE] */
<span class="lineNum">    3603 </span>            : 
<span class="lineNum">    3604 </span>            :     /*
<span class="lineNum">    3605 </span>            :      * Only match when WITH is the first word, as WITH may appear in many
<span class="lineNum">    3606 </span>            :      * other contexts.
<span class="lineNum">    3607 </span>            :      */
<span class="lineNum">    3608 </span><span class="lineNoCov">          0 :     else if (Matches(&quot;WITH&quot;))</span>
<span class="lineNum">    3609 </span><span class="lineNoCov">          0 :         COMPLETE_WITH(&quot;RECURSIVE&quot;);</span>
<span class="lineNum">    3610 </span>            : 
<span class="lineNum">    3611 </span>            : /* WHERE */
<span class="lineNum">    3612 </span>            :     /* Simple case of the word before the where being the table name */
<span class="lineNum">    3613 </span><span class="lineNoCov">          0 :     else if (TailMatches(MatchAny, &quot;WHERE&quot;))</span>
<span class="lineNum">    3614 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_ATTR(prev2_wd, &quot;&quot;);</span>
<span class="lineNum">    3615 </span>            : 
<span class="lineNum">    3616 </span>            : /* ... FROM ... */
<span class="lineNum">    3617 </span>            : /* TODO: also include SRF ? */
<span class="lineNum">    3618 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;FROM&quot;) &amp;&amp; !Matches(&quot;COPY|\\copy&quot;, MatchAny, &quot;FROM&quot;))</span>
<span class="lineNum">    3619 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_selectables, NULL);</span>
<span class="lineNum">    3620 </span>            : 
<span class="lineNum">    3621 </span>            : /* ... JOIN ... */
<span class="lineNum">    3622 </span><span class="lineNoCov">          0 :     else if (TailMatches(&quot;JOIN&quot;))</span>
<span class="lineNum">    3623 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_selectables, NULL);</span>
<span class="lineNum">    3624 </span>            : 
<span class="lineNum">    3625 </span>            : /* Backslash commands */
<span class="lineNum">    3626 </span>            : /* TODO:  \dc \dd \dl */
<span class="lineNum">    3627 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\?&quot;))</span>
<span class="lineNum">    3628 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_CS(&quot;commands&quot;, &quot;options&quot;, &quot;variables&quot;);</span>
<span class="lineNum">    3629 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\connect|\\c&quot;))</span>
<span class="lineNum">    3630 </span>            :     {
<span class="lineNum">    3631 </span><span class="lineNoCov">          0 :         if (!recognized_connection_string(text))</span>
<span class="lineNum">    3632 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_databases);</span>
<span class="lineNum">    3633 </span>            :     }
<span class="lineNum">    3634 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\connect|\\c&quot;, MatchAny))</span>
<span class="lineNum">    3635 </span>            :     {
<span class="lineNum">    3636 </span><span class="lineNoCov">          0 :         if (!recognized_connection_string(prev_wd))</span>
<span class="lineNum">    3637 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3638 </span>            :     }
<span class="lineNum">    3639 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\da*&quot;))</span>
<span class="lineNum">    3640 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_aggregates, NULL);</span>
<span class="lineNum">    3641 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dA*&quot;))</span>
<span class="lineNum">    3642 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_access_methods);</span>
<span class="lineNum">    3643 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\db*&quot;))</span>
<span class="lineNum">    3644 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_tablespaces);</span>
<span class="lineNum">    3645 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dD*&quot;))</span>
<span class="lineNum">    3646 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_domains, NULL);</span>
<span class="lineNum">    3647 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\des*&quot;))</span>
<span class="lineNum">    3648 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_servers);</span>
<span class="lineNum">    3649 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\deu*&quot;))</span>
<span class="lineNum">    3650 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_user_mappings);</span>
<span class="lineNum">    3651 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dew*&quot;))</span>
<span class="lineNum">    3652 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_fdws);</span>
<span class="lineNum">    3653 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\df*&quot;))</span>
<span class="lineNum">    3654 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(Query_for_list_of_functions, NULL);</span>
<span class="lineNum">    3655 </span>            : 
<span class="lineNum">    3656 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dFd*&quot;))</span>
<span class="lineNum">    3657 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_ts_dictionaries);</span>
<span class="lineNum">    3658 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dFp*&quot;))</span>
<span class="lineNum">    3659 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_ts_parsers);</span>
<span class="lineNum">    3660 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dFt*&quot;))</span>
<span class="lineNum">    3661 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_ts_templates);</span>
<span class="lineNum">    3662 </span>            :     /* must be at end of \dF alternatives: */
<span class="lineNum">    3663 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dF*&quot;))</span>
<span class="lineNum">    3664 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_ts_configurations);</span>
<span class="lineNum">    3665 </span>            : 
<span class="lineNum">    3666 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\di*&quot;))</span>
<span class="lineNum">    3667 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_indexes, NULL);</span>
<span class="lineNum">    3668 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dL*&quot;))</span>
<span class="lineNum">    3669 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_languages);</span>
<span class="lineNum">    3670 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dn*&quot;))</span>
<span class="lineNum">    3671 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_schemas);</span>
<span class="lineNum">    3672 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dp&quot;) || TailMatchesCS(&quot;\\z&quot;))</span>
<span class="lineNum">    3673 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_grantables, NULL);</span>
<span class="lineNum">    3674 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dPi*&quot;))</span>
<span class="lineNum">    3675 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_partitioned_indexes, NULL);</span>
<span class="lineNum">    3676 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dPt*&quot;))</span>
<span class="lineNum">    3677 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_partitioned_tables, NULL);</span>
<span class="lineNum">    3678 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dP*&quot;))</span>
<span class="lineNum">    3679 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_partitioned_relations, NULL);</span>
<span class="lineNum">    3680 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\ds*&quot;))</span>
<span class="lineNum">    3681 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_sequences, NULL);</span>
<span class="lineNum">    3682 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dt*&quot;))</span>
<span class="lineNum">    3683 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_tables, NULL);</span>
<span class="lineNum">    3684 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dT*&quot;))</span>
<span class="lineNum">    3685 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_datatypes, NULL);</span>
<span class="lineNum">    3686 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\du*&quot;) || TailMatchesCS(&quot;\\dg*&quot;))</span>
<span class="lineNum">    3687 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3688 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dv*&quot;))</span>
<span class="lineNum">    3689 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_views, NULL);</span>
<span class="lineNum">    3690 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dx*&quot;))</span>
<span class="lineNum">    3691 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_extensions);</span>
<span class="lineNum">    3692 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dm*&quot;))</span>
<span class="lineNum">    3693 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_matviews, NULL);</span>
<span class="lineNum">    3694 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dE*&quot;))</span>
<span class="lineNum">    3695 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_foreign_tables, NULL);</span>
<span class="lineNum">    3696 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\dy*&quot;))</span>
<span class="lineNum">    3697 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_event_triggers);</span>
<span class="lineNum">    3698 </span>            : 
<span class="lineNum">    3699 </span>            :     /* must be at end of \d alternatives: */
<span class="lineNum">    3700 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\d*&quot;))</span>
<span class="lineNum">    3701 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_relations, NULL);</span>
<span class="lineNum">    3702 </span>            : 
<span class="lineNum">    3703 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\ef&quot;))</span>
<span class="lineNum">    3704 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_routines, NULL);</span>
<span class="lineNum">    3705 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\ev&quot;))</span>
<span class="lineNum">    3706 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_views, NULL);</span>
<span class="lineNum">    3707 </span>            : 
<span class="lineNum">    3708 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\encoding&quot;))</span>
<span class="lineNum">    3709 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_encodings);</span>
<span class="lineNum">    3710 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\h|\\help&quot;))</span>
<span class="lineNum">    3711 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_LIST(sql_commands);</span>
<span class="lineNum">    3712 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\h|\\help&quot;, MatchAny))</span>
<span class="lineNum">    3713 </span>            :     {
<span class="lineNum">    3714 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;DROP&quot;))</span>
<span class="lineNum">    3715 </span><span class="lineNoCov">          0 :             matches = completion_matches(text, drop_command_generator);</span>
<span class="lineNum">    3716 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;ALTER&quot;))</span>
<span class="lineNum">    3717 </span><span class="lineNoCov">          0 :             matches = completion_matches(text, alter_command_generator);</span>
<span class="lineNum">    3718 </span>            : 
<span class="lineNum">    3719 </span>            :         /*
<span class="lineNum">    3720 </span>            :          * CREATE is recognized by tail match elsewhere, so doesn't need to be
<span class="lineNum">    3721 </span>            :          * repeated here
<span class="lineNum">    3722 </span>            :          */
<span class="lineNum">    3723 </span>            :     }
<span class="lineNum">    3724 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\h|\\help&quot;, MatchAny, MatchAny))</span>
<span class="lineNum">    3725 </span>            :     {
<span class="lineNum">    3726 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;CREATE|DROP&quot;, &quot;ACCESS&quot;))</span>
<span class="lineNum">    3727 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;METHOD&quot;);</span>
<span class="lineNum">    3728 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;ALTER&quot;, &quot;DEFAULT&quot;))</span>
<span class="lineNum">    3729 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;PRIVILEGES&quot;);</span>
<span class="lineNum">    3730 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;EVENT&quot;))</span>
<span class="lineNum">    3731 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;TRIGGER&quot;);</span>
<span class="lineNum">    3732 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;FOREIGN&quot;))</span>
<span class="lineNum">    3733 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;DATA WRAPPER&quot;, &quot;TABLE&quot;);</span>
<span class="lineNum">    3734 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;ALTER&quot;, &quot;LARGE&quot;))</span>
<span class="lineNum">    3735 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;OBJECT&quot;);</span>
<span class="lineNum">    3736 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;MATERIALIZED&quot;))</span>
<span class="lineNum">    3737 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;VIEW&quot;);</span>
<span class="lineNum">    3738 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;TEXT&quot;))</span>
<span class="lineNum">    3739 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;SEARCH&quot;);</span>
<span class="lineNum">    3740 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;USER&quot;))</span>
<span class="lineNum">    3741 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;MAPPING FOR&quot;);</span>
<span class="lineNum">    3742 </span>            :     }
<span class="lineNum">    3743 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\h|\\help&quot;, MatchAny, MatchAny, MatchAny))</span>
<span class="lineNum">    3744 </span>            :     {
<span class="lineNum">    3745 </span><span class="lineNoCov">          0 :         if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;FOREIGN&quot;, &quot;DATA&quot;))</span>
<span class="lineNum">    3746 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;WRAPPER&quot;);</span>
<span class="lineNum">    3747 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;TEXT&quot;, &quot;SEARCH&quot;))</span>
<span class="lineNum">    3748 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;CONFIGURATION&quot;, &quot;DICTIONARY&quot;, &quot;PARSER&quot;, &quot;TEMPLATE&quot;);</span>
<span class="lineNum">    3749 </span><span class="lineNoCov">          0 :         else if (TailMatches(&quot;CREATE|ALTER|DROP&quot;, &quot;USER&quot;, &quot;MAPPING&quot;))</span>
<span class="lineNum">    3750 </span><span class="lineNoCov">          0 :             COMPLETE_WITH(&quot;FOR&quot;);</span>
<span class="lineNum">    3751 </span>            :     }
<span class="lineNum">    3752 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\l*&quot;) &amp;&amp; !TailMatchesCS(&quot;\\lo*&quot;))</span>
<span class="lineNum">    3753 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_databases);</span>
<span class="lineNum">    3754 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\password&quot;))</span>
<span class="lineNum">    3755 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_QUERY(Query_for_list_of_roles);</span>
<span class="lineNum">    3756 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\pset&quot;))</span>
<span class="lineNum">    3757 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_CS(&quot;border&quot;, &quot;columns&quot;, &quot;csv_fieldsep&quot;, &quot;expanded&quot;,</span>
<span class="lineNum">    3758 </span>            :                          &quot;fieldsep&quot;, &quot;fieldsep_zero&quot;, &quot;footer&quot;, &quot;format&quot;,
<span class="lineNum">    3759 </span>            :                          &quot;linestyle&quot;, &quot;null&quot;, &quot;numericlocale&quot;,
<span class="lineNum">    3760 </span>            :                          &quot;pager&quot;, &quot;pager_min_lines&quot;,
<span class="lineNum">    3761 </span>            :                          &quot;recordsep&quot;, &quot;recordsep_zero&quot;,
<span class="lineNum">    3762 </span>            :                          &quot;tableattr&quot;, &quot;title&quot;, &quot;tuples_only&quot;,
<span class="lineNum">    3763 </span>            :                          &quot;unicode_border_linestyle&quot;,
<span class="lineNum">    3764 </span>            :                          &quot;unicode_column_linestyle&quot;,
<span class="lineNum">    3765 </span>            :                          &quot;unicode_header_linestyle&quot;);
<span class="lineNum">    3766 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\pset&quot;, MatchAny))</span>
<span class="lineNum">    3767 </span>            :     {
<span class="lineNum">    3768 </span><span class="lineNoCov">          0 :         if (TailMatchesCS(&quot;format&quot;))</span>
<span class="lineNum">    3769 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;aligned&quot;, &quot;asciidoc&quot;, &quot;csv&quot;, &quot;html&quot;, &quot;latex&quot;,</span>
<span class="lineNum">    3770 </span>            :                              &quot;latex-longtable&quot;, &quot;troff-ms&quot;, &quot;unaligned&quot;,
<span class="lineNum">    3771 </span>            :                              &quot;wrapped&quot;);
<span class="lineNum">    3772 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;linestyle&quot;))</span>
<span class="lineNum">    3773 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;ascii&quot;, &quot;old-ascii&quot;, &quot;unicode&quot;);</span>
<span class="lineNum">    3774 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;pager&quot;))</span>
<span class="lineNum">    3775 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;on&quot;, &quot;off&quot;, &quot;always&quot;);</span>
<span class="lineNum">    3776 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;unicode_border_linestyle|&quot;</span>
<span class="lineNum">    3777 </span>            :                                &quot;unicode_column_linestyle|&quot;
<span class="lineNum">    3778 </span>            :                                &quot;unicode_header_linestyle&quot;))
<span class="lineNum">    3779 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;single&quot;, &quot;double&quot;);</span>
<span class="lineNum">    3780 </span>            :     }
<span class="lineNum">    3781 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\unset&quot;))</span>
<span class="lineNum">    3782 </span><span class="lineNoCov">          0 :         matches = complete_from_variables(text, &quot;&quot;, &quot;&quot;, true);</span>
<span class="lineNum">    3783 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\set&quot;))</span>
<span class="lineNum">    3784 </span><span class="lineNoCov">          0 :         matches = complete_from_variables(text, &quot;&quot;, &quot;&quot;, false);</span>
<span class="lineNum">    3785 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\set&quot;, MatchAny))</span>
<span class="lineNum">    3786 </span>            :     {
<span class="lineNum">    3787 </span><span class="lineNoCov">          0 :         if (TailMatchesCS(&quot;AUTOCOMMIT|ON_ERROR_STOP|QUIET|&quot;</span>
<span class="lineNum">    3788 </span>            :                           &quot;SINGLELINE|SINGLESTEP&quot;))
<span class="lineNum">    3789 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;on&quot;, &quot;off&quot;);</span>
<span class="lineNum">    3790 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;COMP_KEYWORD_CASE&quot;))</span>
<span class="lineNum">    3791 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;lower&quot;, &quot;upper&quot;,</span>
<span class="lineNum">    3792 </span>            :                              &quot;preserve-lower&quot;, &quot;preserve-upper&quot;);
<span class="lineNum">    3793 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;ECHO&quot;))</span>
<span class="lineNum">    3794 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;errors&quot;, &quot;queries&quot;, &quot;all&quot;, &quot;none&quot;);</span>
<span class="lineNum">    3795 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;ECHO_HIDDEN&quot;))</span>
<span class="lineNum">    3796 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;noexec&quot;, &quot;off&quot;, &quot;on&quot;);</span>
<span class="lineNum">    3797 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;HISTCONTROL&quot;))</span>
<span class="lineNum">    3798 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;ignorespace&quot;, &quot;ignoredups&quot;,</span>
<span class="lineNum">    3799 </span>            :                              &quot;ignoreboth&quot;, &quot;none&quot;);
<span class="lineNum">    3800 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;ON_ERROR_ROLLBACK&quot;))</span>
<span class="lineNum">    3801 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;on&quot;, &quot;off&quot;, &quot;interactive&quot;);</span>
<span class="lineNum">    3802 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;SHOW_CONTEXT&quot;))</span>
<span class="lineNum">    3803 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;never&quot;, &quot;errors&quot;, &quot;always&quot;);</span>
<span class="lineNum">    3804 </span><span class="lineNoCov">          0 :         else if (TailMatchesCS(&quot;VERBOSITY&quot;))</span>
<span class="lineNum">    3805 </span><span class="lineNoCov">          0 :             COMPLETE_WITH_CS(&quot;default&quot;, &quot;verbose&quot;, &quot;terse&quot;, &quot;sqlstate&quot;);</span>
<span class="lineNum">    3806 </span>            :     }
<span class="lineNum">    3807 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\sf*&quot;))</span>
<span class="lineNum">    3808 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_routines, NULL);</span>
<span class="lineNum">    3809 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\sv*&quot;))</span>
<span class="lineNum">    3810 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_SCHEMA_QUERY(Query_for_list_of_views, NULL);</span>
<span class="lineNum">    3811 </span><span class="lineNoCov">          0 :     else if (TailMatchesCS(&quot;\\cd|\\e|\\edit|\\g|\\i|\\include|&quot;</span>
<span class="lineNum">    3812 </span>            :                            &quot;\\ir|\\include_relative|\\o|\\out|&quot;
<span class="lineNum">    3813 </span>            :                            &quot;\\s|\\w|\\write|\\lo_import&quot;))
<span class="lineNum">    3814 </span>            :     {
<span class="lineNum">    3815 </span><span class="lineNoCov">          0 :         completion_charp = &quot;\\&quot;;</span>
<span class="lineNum">    3816 </span><span class="lineNoCov">          0 :         matches = completion_matches(text, complete_from_files);</span>
<span class="lineNum">    3817 </span>            :     }
<span class="lineNum">    3818 </span>            : 
<span class="lineNum">    3819 </span>            :     /*
<span class="lineNum">    3820 </span>            :      * Finally, we look through the list of &quot;things&quot;, such as TABLE, INDEX and
<span class="lineNum">    3821 </span>            :      * check if that was the previous word. If so, execute the query to get a
<span class="lineNum">    3822 </span>            :      * list of them.
<span class="lineNum">    3823 </span>            :      */
<span class="lineNum">    3824 </span>            :     else
<span class="lineNum">    3825 </span>            :     {
<span class="lineNum">    3826 </span>            :         int         i;
<span class="lineNum">    3827 </span>            : 
<span class="lineNum">    3828 </span><span class="lineNoCov">          0 :         for (i = 0; words_after_create[i].name; i++)</span>
<span class="lineNum">    3829 </span>            :         {
<span class="lineNum">    3830 </span><span class="lineNoCov">          0 :             if (pg_strcasecmp(prev_wd, words_after_create[i].name) == 0)</span>
<span class="lineNum">    3831 </span>            :             {
<span class="lineNum">    3832 </span><span class="lineNoCov">          0 :                 if (words_after_create[i].query)</span>
<span class="lineNum">    3833 </span><span class="lineNoCov">          0 :                     COMPLETE_WITH_QUERY(words_after_create[i].query);</span>
<span class="lineNum">    3834 </span><span class="lineNoCov">          0 :                 else if (words_after_create[i].vquery)</span>
<span class="lineNum">    3835 </span><span class="lineNoCov">          0 :                     COMPLETE_WITH_VERSIONED_QUERY(words_after_create[i].vquery);</span>
<span class="lineNum">    3836 </span><span class="lineNoCov">          0 :                 else if (words_after_create[i].squery)</span>
<span class="lineNum">    3837 </span><span class="lineNoCov">          0 :                     COMPLETE_WITH_VERSIONED_SCHEMA_QUERY(words_after_create[i].squery,</span>
<span class="lineNum">    3838 </span>            :                                                          NULL);
<span class="lineNum">    3839 </span><span class="lineNoCov">          0 :                 break;</span>
<span class="lineNum">    3840 </span>            :             }
<span class="lineNum">    3841 </span>            :         }
<span class="lineNum">    3842 </span>            :     }
<span class="lineNum">    3843 </span>            : 
<span class="lineNum">    3844 </span>            :     /*
<span class="lineNum">    3845 </span>            :      * If we still don't have anything to match we have to fabricate some sort
<span class="lineNum">    3846 </span>            :      * of default list. If we were to just return NULL, readline automatically
<span class="lineNum">    3847 </span>            :      * attempts filename completion, and that's usually no good.
<span class="lineNum">    3848 </span>            :      */
<span class="lineNum">    3849 </span><span class="lineNoCov">          0 :     if (matches == NULL)</span>
<span class="lineNum">    3850 </span>            :     {
<span class="lineNum">    3851 </span><span class="lineNoCov">          0 :         COMPLETE_WITH_CONST(true, &quot;&quot;);</span>
<span class="lineNum">    3852 </span>            : #ifdef HAVE_RL_COMPLETION_APPEND_CHARACTER
<span class="lineNum">    3853 </span><span class="lineNoCov">          0 :         rl_completion_append_character = '\0';</span>
<span class="lineNum">    3854 </span>            : #endif
<span class="lineNum">    3855 </span>            :     }
<span class="lineNum">    3856 </span>            : 
<span class="lineNum">    3857 </span>            :     /* free storage */
<span class="lineNum">    3858 </span><span class="lineNoCov">          0 :     free(previous_words);</span>
<span class="lineNum">    3859 </span><span class="lineNoCov">          0 :     free(words_buffer);</span>
<span class="lineNum">    3860 </span>            : 
<span class="lineNum">    3861 </span>            :     /* Return our Grand List O' Matches */
<span class="lineNum">    3862 </span><span class="lineNoCov">          0 :     return matches;</span>
<span class="lineNum">    3863 </span>            : }
<span class="lineNum">    3864 </span>            : 
<span class="lineNum">    3865 </span>            : 
<span class="lineNum">    3866 </span>            : /*
<span class="lineNum">    3867 </span>            :  * GENERATOR FUNCTIONS
<span class="lineNum">    3868 </span>            :  *
<span class="lineNum">    3869 </span>            :  * These functions do all the actual work of completing the input. They get
<span class="lineNum">    3870 </span>            :  * passed the text so far and the count how many times they have been called
<span class="lineNum">    3871 </span>            :  * so far with the same text.
<span class="lineNum">    3872 </span>            :  * If you read the above carefully, you'll see that these don't get called
<span class="lineNum">    3873 </span>            :  * directly but through the readline interface.
<span class="lineNum">    3874 </span>            :  * The return value is expected to be the full completion of the text, going
<span class="lineNum">    3875 </span>            :  * through a list each time, or NULL if there are no more matches. The string
<span class="lineNum">    3876 </span>            :  * will be free()'d by readline, so you must run it through strdup() or
<span class="lineNum">    3877 </span>            :  * something of that sort.
<span class="lineNum">    3878 </span>            :  */
<span class="lineNum">    3879 </span>            : 
<span class="lineNum">    3880 </span>            : /*
<span class="lineNum">    3881 </span>            :  * Common routine for create_command_generator and drop_command_generator.
<span class="lineNum">    3882 </span>            :  * Entries that have 'excluded' flags are not returned.
<a name="3883"><span class="lineNum">    3883 </span>            :  */</a>
<span class="lineNum">    3884 </span>            : static char *
<span class="lineNum">    3885 </span><span class="lineNoCov">          0 : create_or_drop_command_generator(const char *text, int state, bits32 excluded)</span>
<span class="lineNum">    3886 </span>            : {
<span class="lineNum">    3887 </span>            :     static int  list_index,
<span class="lineNum">    3888 </span>            :                 string_length;
<span class="lineNum">    3889 </span>            :     const char *name;
<span class="lineNum">    3890 </span>            : 
<span class="lineNum">    3891 </span>            :     /* If this is the first time for this completion, init some values */
<span class="lineNum">    3892 </span><span class="lineNoCov">          0 :     if (state == 0)</span>
<span class="lineNum">    3893 </span>            :     {
<span class="lineNum">    3894 </span><span class="lineNoCov">          0 :         list_index = 0;</span>
<span class="lineNum">    3895 </span><span class="lineNoCov">          0 :         string_length = strlen(text);</span>
<span class="lineNum">    3896 </span>            :     }
<span class="lineNum">    3897 </span>            : 
<span class="lineNum">    3898 </span>            :     /* find something that matches */
<span class="lineNum">    3899 </span><span class="lineNoCov">          0 :     while ((name = words_after_create[list_index++].name))</span>
<span class="lineNum">    3900 </span>            :     {
<span class="lineNum">    3901 </span><span class="lineNoCov">          0 :         if ((pg_strncasecmp(name, text, string_length) == 0) &amp;&amp;</span>
<span class="lineNum">    3902 </span><span class="lineNoCov">          0 :             !(words_after_create[list_index - 1].flags &amp; excluded))</span>
<span class="lineNum">    3903 </span><span class="lineNoCov">          0 :             return pg_strdup_keyword_case(name, text);</span>
<span class="lineNum">    3904 </span>            :     }
<span class="lineNum">    3905 </span>            :     /* if nothing matches, return NULL */
<span class="lineNum">    3906 </span><span class="lineNoCov">          0 :     return NULL;</span>
<span class="lineNum">    3907 </span>            : }
<span class="lineNum">    3908 </span>            : 
<span class="lineNum">    3909 </span>            : /*
<span class="lineNum">    3910 </span>            :  * This one gives you one from a list of things you can put after CREATE
<span class="lineNum">    3911 </span>            :  * as defined above.
<a name="3912"><span class="lineNum">    3912 </span>            :  */</a>
<span class="lineNum">    3913 </span>            : static char *
<span class="lineNum">    3914 </span><span class="lineNoCov">          0 : create_command_generator(const char *text, int state)</span>
<span class="lineNum">    3915 </span>            : {
<span class="lineNum">    3916 </span><span class="lineNoCov">          0 :     return create_or_drop_command_generator(text, state, THING_NO_CREATE);</span>
<span class="lineNum">    3917 </span>            : }
<span class="lineNum">    3918 </span>            : 
<span class="lineNum">    3919 </span>            : /*
<span class="lineNum">    3920 </span>            :  * This function gives you a list of things you can put after a DROP command.
<a name="3921"><span class="lineNum">    3921 </span>            :  */</a>
<span class="lineNum">    3922 </span>            : static char *
<span class="lineNum">    3923 </span><span class="lineNoCov">          0 : drop_command_generator(const char *text, int state)</span>
<span class="lineNum">    3924 </span>            : {
<span class="lineNum">    3925 </span><span class="lineNoCov">          0 :     return create_or_drop_command_generator(text, state, THING_NO_DROP);</span>
<span class="lineNum">    3926 </span>            : }
<span class="lineNum">    3927 </span>            : 
<span class="lineNum">    3928 </span>            : /*
<span class="lineNum">    3929 </span>            :  * This function gives you a list of things you can put after an ALTER command.
<a name="3930"><span class="lineNum">    3930 </span>            :  */</a>
<span class="lineNum">    3931 </span>            : static char *
<span class="lineNum">    3932 </span><span class="lineNoCov">          0 : alter_command_generator(const char *text, int state)</span>
<span class="lineNum">    3933 </span>            : {
<span class="lineNum">    3934 </span><span class="lineNoCov">          0 :     return create_or_drop_command_generator(text, state, THING_NO_ALTER);</span>
<span class="lineNum">    3935 </span>            : }
<span class="lineNum">    3936 </span>            : 
<span class="lineNum">    3937 </span>            : /*
<span class="lineNum">    3938 </span>            :  * These functions generate lists using server queries.
<span class="lineNum">    3939 </span>            :  * They are all wrappers for _complete_from_query.
<span class="lineNum">    3940 </span>            :  */
<a name="3941"><span class="lineNum">    3941 </span>            : </a>
<span class="lineNum">    3942 </span>            : static char *
<span class="lineNum">    3943 </span><span class="lineNoCov">          0 : complete_from_query(const char *text, int state)</span>
<span class="lineNum">    3944 </span>            : {
<span class="lineNum">    3945 </span>            :     /* query is assumed to work for any server version */
<span class="lineNum">    3946 </span><span class="lineNoCov">          0 :     return _complete_from_query(completion_charp, NULL, text, state);</span>
<span class="lineNum">    3947 </span>            : }
<a name="3948"><span class="lineNum">    3948 </span>            : </a>
<span class="lineNum">    3949 </span>            : static char *
<span class="lineNum">    3950 </span><span class="lineNoCov">          0 : complete_from_versioned_query(const char *text, int state)</span>
<span class="lineNum">    3951 </span>            : {
<span class="lineNum">    3952 </span><span class="lineNoCov">          0 :     const VersionedQuery *vquery = completion_vquery;</span>
<span class="lineNum">    3953 </span>            : 
<span class="lineNum">    3954 </span>            :     /* Find appropriate array element */
<span class="lineNum">    3955 </span><span class="lineNoCov">          0 :     while (pset.sversion &lt; vquery-&gt;min_server_version)</span>
<span class="lineNum">    3956 </span><span class="lineNoCov">          0 :         vquery++;</span>
<span class="lineNum">    3957 </span>            :     /* Fail completion if server is too old */
<span class="lineNum">    3958 </span><span class="lineNoCov">          0 :     if (vquery-&gt;query == NULL)</span>
<span class="lineNum">    3959 </span><span class="lineNoCov">          0 :         return NULL;</span>
<span class="lineNum">    3960 </span>            : 
<span class="lineNum">    3961 </span><span class="lineNoCov">          0 :     return _complete_from_query(vquery-&gt;query, NULL, text, state);</span>
<span class="lineNum">    3962 </span>            : }
<a name="3963"><span class="lineNum">    3963 </span>            : </a>
<span class="lineNum">    3964 </span>            : static char *
<span class="lineNum">    3965 </span><span class="lineNoCov">          0 : complete_from_schema_query(const char *text, int state)</span>
<span class="lineNum">    3966 </span>            : {
<span class="lineNum">    3967 </span>            :     /* query is assumed to work for any server version */
<span class="lineNum">    3968 </span><span class="lineNoCov">          0 :     return _complete_from_query(completion_charp, completion_squery,</span>
<span class="lineNum">    3969 </span>            :                                 text, state);
<span class="lineNum">    3970 </span>            : }
<a name="3971"><span class="lineNum">    3971 </span>            : </a>
<span class="lineNum">    3972 </span>            : static char *
<span class="lineNum">    3973 </span><span class="lineNoCov">          0 : complete_from_versioned_schema_query(const char *text, int state)</span>
<span class="lineNum">    3974 </span>            : {
<span class="lineNum">    3975 </span><span class="lineNoCov">          0 :     const SchemaQuery *squery = completion_squery;</span>
<span class="lineNum">    3976 </span><span class="lineNoCov">          0 :     const VersionedQuery *vquery = completion_vquery;</span>
<span class="lineNum">    3977 </span>            : 
<span class="lineNum">    3978 </span>            :     /* Find appropriate array element */
<span class="lineNum">    3979 </span><span class="lineNoCov">          0 :     while (pset.sversion &lt; squery-&gt;min_server_version)</span>
<span class="lineNum">    3980 </span><span class="lineNoCov">          0 :         squery++;</span>
<span class="lineNum">    3981 </span>            :     /* Fail completion if server is too old */
<span class="lineNum">    3982 </span><span class="lineNoCov">          0 :     if (squery-&gt;catname == NULL)</span>
<span class="lineNum">    3983 </span><span class="lineNoCov">          0 :         return NULL;</span>
<span class="lineNum">    3984 </span>            : 
<span class="lineNum">    3985 </span>            :     /* Likewise for the add-on text, if any */
<span class="lineNum">    3986 </span><span class="lineNoCov">          0 :     if (vquery)</span>
<span class="lineNum">    3987 </span>            :     {
<span class="lineNum">    3988 </span><span class="lineNoCov">          0 :         while (pset.sversion &lt; vquery-&gt;min_server_version)</span>
<span class="lineNum">    3989 </span><span class="lineNoCov">          0 :             vquery++;</span>
<span class="lineNum">    3990 </span><span class="lineNoCov">          0 :         if (vquery-&gt;query == NULL)</span>
<span class="lineNum">    3991 </span><span class="lineNoCov">          0 :             return NULL;</span>
<span class="lineNum">    3992 </span>            :     }
<span class="lineNum">    3993 </span>            : 
<span class="lineNum">    3994 </span><span class="lineNoCov">          0 :     return _complete_from_query(vquery ? vquery-&gt;query : NULL,</span>
<span class="lineNum">    3995 </span>            :                                 squery, text, state);
<span class="lineNum">    3996 </span>            : }
<span class="lineNum">    3997 </span>            : 
<span class="lineNum">    3998 </span>            : 
<span class="lineNum">    3999 </span>            : /*
<span class="lineNum">    4000 </span>            :  * This creates a list of matching things, according to a query described by
<span class="lineNum">    4001 </span>            :  * the initial arguments.  The caller has already done any work needed to
<span class="lineNum">    4002 </span>            :  * select the appropriate query for the server's version.
<span class="lineNum">    4003 </span>            :  *
<span class="lineNum">    4004 </span>            :  * The query can be one of two kinds:
<span class="lineNum">    4005 </span>            :  *
<span class="lineNum">    4006 </span>            :  * 1. A simple query which must contain a %d and a %s, which will be replaced
<span class="lineNum">    4007 </span>            :  * by the string length of the text and the text itself. The query may also
<span class="lineNum">    4008 </span>            :  * have up to four more %s in it; the first two such will be replaced by the
<span class="lineNum">    4009 </span>            :  * value of completion_info_charp, the next two by the value of
<span class="lineNum">    4010 </span>            :  * completion_info_charp2.
<span class="lineNum">    4011 </span>            :  *
<span class="lineNum">    4012 </span>            :  * 2. A schema query used for completion of both schema and relation names.
<span class="lineNum">    4013 </span>            :  * These are more complex and must contain in the following order:
<span class="lineNum">    4014 </span>            :  * %d %s %d %s %d %s %s %d %s
<span class="lineNum">    4015 </span>            :  * where %d is the string length of the text and %s the text itself.
<span class="lineNum">    4016 </span>            :  *
<span class="lineNum">    4017 </span>            :  * If both simple_query and schema_query are non-NULL, then we construct
<span class="lineNum">    4018 </span>            :  * a schema query and append the (uninterpreted) string simple_query to it.
<span class="lineNum">    4019 </span>            :  *
<span class="lineNum">    4020 </span>            :  * It is assumed that strings should be escaped to become SQL literals
<span class="lineNum">    4021 </span>            :  * (that is, what is in the query is actually ... '%s' ...)
<span class="lineNum">    4022 </span>            :  *
<span class="lineNum">    4023 </span>            :  * See top of file for examples of both kinds of query.
<span class="lineNum">    4024 </span>            :  *
<span class="lineNum">    4025 </span>            :  * &quot;text&quot; and &quot;state&quot; are supplied by readline.
<a name="4026"><span class="lineNum">    4026 </span>            :  */</a>
<span class="lineNum">    4027 </span>            : static char *
<span class="lineNum">    4028 </span><span class="lineNoCov">          0 : _complete_from_query(const char *simple_query,</span>
<span class="lineNum">    4029 </span>            :                      const SchemaQuery *schema_query,
<span class="lineNum">    4030 </span>            :                      const char *text, int state)
<span class="lineNum">    4031 </span>            : {
<span class="lineNum">    4032 </span>            :     static int  list_index,
<span class="lineNum">    4033 </span>            :                 byte_length;
<span class="lineNum">    4034 </span>            :     static PGresult *result = NULL;
<span class="lineNum">    4035 </span>            : 
<span class="lineNum">    4036 </span>            :     /*
<span class="lineNum">    4037 </span>            :      * If this is the first time for this completion, we fetch a list of our
<span class="lineNum">    4038 </span>            :      * &quot;things&quot; from the backend.
<span class="lineNum">    4039 </span>            :      */
<span class="lineNum">    4040 </span><span class="lineNoCov">          0 :     if (state == 0)</span>
<span class="lineNum">    4041 </span>            :     {
<span class="lineNum">    4042 </span>            :         PQExpBufferData query_buffer;
<span class="lineNum">    4043 </span>            :         char       *e_text;
<span class="lineNum">    4044 </span>            :         char       *e_info_charp;
<span class="lineNum">    4045 </span>            :         char       *e_info_charp2;
<span class="lineNum">    4046 </span><span class="lineNoCov">          0 :         const char *pstr = text;</span>
<span class="lineNum">    4047 </span><span class="lineNoCov">          0 :         int         char_length = 0;</span>
<span class="lineNum">    4048 </span>            : 
<span class="lineNum">    4049 </span><span class="lineNoCov">          0 :         list_index = 0;</span>
<span class="lineNum">    4050 </span><span class="lineNoCov">          0 :         byte_length = strlen(text);</span>
<span class="lineNum">    4051 </span>            : 
<span class="lineNum">    4052 </span>            :         /*
<span class="lineNum">    4053 </span>            :          * Count length as number of characters (not bytes), for passing to
<span class="lineNum">    4054 </span>            :          * substring
<span class="lineNum">    4055 </span>            :          */
<span class="lineNum">    4056 </span><span class="lineNoCov">          0 :         while (*pstr)</span>
<span class="lineNum">    4057 </span>            :         {
<span class="lineNum">    4058 </span><span class="lineNoCov">          0 :             char_length++;</span>
<span class="lineNum">    4059 </span><span class="lineNoCov">          0 :             pstr += PQmblen(pstr, pset.encoding);</span>
<span class="lineNum">    4060 </span>            :         }
<span class="lineNum">    4061 </span>            : 
<span class="lineNum">    4062 </span>            :         /* Free any prior result */
<span class="lineNum">    4063 </span><span class="lineNoCov">          0 :         PQclear(result);</span>
<span class="lineNum">    4064 </span><span class="lineNoCov">          0 :         result = NULL;</span>
<span class="lineNum">    4065 </span>            : 
<span class="lineNum">    4066 </span>            :         /* Set up suitably-escaped copies of textual inputs */
<span class="lineNum">    4067 </span><span class="lineNoCov">          0 :         e_text = escape_string(text);</span>
<span class="lineNum">    4068 </span>            : 
<span class="lineNum">    4069 </span><span class="lineNoCov">          0 :         if (completion_info_charp)</span>
<span class="lineNum">    4070 </span><span class="lineNoCov">          0 :             e_info_charp = escape_string(completion_info_charp);</span>
<span class="lineNum">    4071 </span>            :         else
<span class="lineNum">    4072 </span><span class="lineNoCov">          0 :             e_info_charp = NULL;</span>
<span class="lineNum">    4073 </span>            : 
<span class="lineNum">    4074 </span><span class="lineNoCov">          0 :         if (completion_info_charp2)</span>
<span class="lineNum">    4075 </span><span class="lineNoCov">          0 :             e_info_charp2 = escape_string(completion_info_charp2);</span>
<span class="lineNum">    4076 </span>            :         else
<span class="lineNum">    4077 </span><span class="lineNoCov">          0 :             e_info_charp2 = NULL;</span>
<span class="lineNum">    4078 </span>            : 
<span class="lineNum">    4079 </span><span class="lineNoCov">          0 :         initPQExpBuffer(&amp;query_buffer);</span>
<span class="lineNum">    4080 </span>            : 
<span class="lineNum">    4081 </span><span class="lineNoCov">          0 :         if (schema_query)</span>
<span class="lineNum">    4082 </span>            :         {
<span class="lineNum">    4083 </span>            :             /* schema_query gives us the pieces to assemble */
<span class="lineNum">    4084 </span><span class="lineNoCov">          0 :             const char *qualresult = schema_query-&gt;qualresult;</span>
<span class="lineNum">    4085 </span>            : 
<span class="lineNum">    4086 </span><span class="lineNoCov">          0 :             if (qualresult == NULL)</span>
<span class="lineNum">    4087 </span><span class="lineNoCov">          0 :                 qualresult = schema_query-&gt;result;</span>
<span class="lineNum">    4088 </span>            : 
<span class="lineNum">    4089 </span>            :             /* Get unqualified names matching the input-so-far */
<span class="lineNum">    4090 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, &quot;SELECT %s FROM %s WHERE &quot;,</span>
<span class="lineNum">    4091 </span>            :                               schema_query-&gt;result,
<span class="lineNum">    4092 </span>            :                               schema_query-&gt;catname);
<span class="lineNum">    4093 </span><span class="lineNoCov">          0 :             if (schema_query-&gt;selcondition)</span>
<span class="lineNum">    4094 </span><span class="lineNoCov">          0 :                 appendPQExpBuffer(&amp;query_buffer, &quot;%s AND &quot;,</span>
<span class="lineNum">    4095 </span>            :                                   schema_query-&gt;selcondition);
<span class="lineNum">    4096 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, &quot;substring(%s,1,%d)='%s'&quot;,</span>
<span class="lineNum">    4097 </span>            :                               schema_query-&gt;result,
<span class="lineNum">    4098 </span>            :                               char_length, e_text);
<span class="lineNum">    4099 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, &quot; AND %s&quot;,</span>
<span class="lineNum">    4100 </span>            :                               schema_query-&gt;viscondition);
<span class="lineNum">    4101 </span>            : 
<span class="lineNum">    4102 </span>            :             /*
<span class="lineNum">    4103 </span>            :              * When fetching relation names, suppress system catalogs unless
<span class="lineNum">    4104 </span>            :              * the input-so-far begins with &quot;pg_&quot;.  This is a compromise
<span class="lineNum">    4105 </span>            :              * between not offering system catalogs for completion at all, and
<span class="lineNum">    4106 </span>            :              * having them swamp the result when the input is just &quot;p&quot;.
<span class="lineNum">    4107 </span>            :              */
<span class="lineNum">    4108 </span><span class="lineNoCov">          0 :             if (strcmp(schema_query-&gt;catname,</span>
<span class="lineNum">    4109 </span><span class="lineNoCov">          0 :                        &quot;pg_catalog.pg_class c&quot;) == 0 &amp;&amp;</span>
<span class="lineNum">    4110 </span><span class="lineNoCov">          0 :                 strncmp(text, &quot;pg_&quot;, 3) !=0)</span>
<span class="lineNum">    4111 </span>            :             {
<span class="lineNum">    4112 </span><span class="lineNoCov">          0 :                 appendPQExpBufferStr(&amp;query_buffer,</span>
<span class="lineNum">    4113 </span>            :                                      &quot; AND c.relnamespace &lt;&gt; (SELECT oid FROM&quot;
<span class="lineNum">    4114 </span>            :                                      &quot; pg_catalog.pg_namespace WHERE nspname = 'pg_catalog')&quot;);
<span class="lineNum">    4115 </span>            :             }
<span class="lineNum">    4116 </span>            : 
<span class="lineNum">    4117 </span>            :             /*
<span class="lineNum">    4118 </span>            :              * Add in matching schema names, but only if there is more than
<span class="lineNum">    4119 </span>            :              * one potential match among schema names.
<span class="lineNum">    4120 </span>            :              */
<span class="lineNum">    4121 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, &quot;\nUNION\n&quot;</span>
<span class="lineNum">    4122 </span>            :                               &quot;SELECT pg_catalog.quote_ident(n.nspname) || '.' &quot;
<span class="lineNum">    4123 </span>            :                               &quot;FROM pg_catalog.pg_namespace n &quot;
<span class="lineNum">    4124 </span>            :                               &quot;WHERE substring(pg_catalog.quote_ident(n.nspname) || '.',1,%d)='%s'&quot;,
<span class="lineNum">    4125 </span>            :                               char_length, e_text);
<span class="lineNum">    4126 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer,</span>
<span class="lineNum">    4127 </span>            :                               &quot; AND (SELECT pg_catalog.count(*)&quot;
<span class="lineNum">    4128 </span>            :                               &quot; FROM pg_catalog.pg_namespace&quot;
<span class="lineNum">    4129 </span>            :                               &quot; WHERE substring(pg_catalog.quote_ident(nspname) || '.',1,%d) =&quot;
<span class="lineNum">    4130 </span>            :                               &quot; substring('%s',1,pg_catalog.length(pg_catalog.quote_ident(nspname))+1)) &gt; 1&quot;,
<span class="lineNum">    4131 </span>            :                               char_length, e_text);
<span class="lineNum">    4132 </span>            : 
<span class="lineNum">    4133 </span>            :             /*
<span class="lineNum">    4134 </span>            :              * Add in matching qualified names, but only if there is exactly
<span class="lineNum">    4135 </span>            :              * one schema matching the input-so-far.
<span class="lineNum">    4136 </span>            :              */
<span class="lineNum">    4137 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, &quot;\nUNION\n&quot;</span>
<span class="lineNum">    4138 </span>            :                               &quot;SELECT pg_catalog.quote_ident(n.nspname) || '.' || %s &quot;
<span class="lineNum">    4139 </span>            :                               &quot;FROM %s, pg_catalog.pg_namespace n &quot;
<span class="lineNum">    4140 </span>            :                               &quot;WHERE %s = n.oid AND &quot;,
<span class="lineNum">    4141 </span>            :                               qualresult,
<span class="lineNum">    4142 </span>            :                               schema_query-&gt;catname,
<span class="lineNum">    4143 </span>            :                               schema_query-&gt;namespace);
<span class="lineNum">    4144 </span><span class="lineNoCov">          0 :             if (schema_query-&gt;selcondition)</span>
<span class="lineNum">    4145 </span><span class="lineNoCov">          0 :                 appendPQExpBuffer(&amp;query_buffer, &quot;%s AND &quot;,</span>
<span class="lineNum">    4146 </span>            :                                   schema_query-&gt;selcondition);
<span class="lineNum">    4147 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, &quot;substring(pg_catalog.quote_ident(n.nspname) || '.' || %s,1,%d)='%s'&quot;,</span>
<span class="lineNum">    4148 </span>            :                               qualresult,
<span class="lineNum">    4149 </span>            :                               char_length, e_text);
<span class="lineNum">    4150 </span>            : 
<span class="lineNum">    4151 </span>            :             /*
<span class="lineNum">    4152 </span>            :              * This condition exploits the single-matching-schema rule to
<span class="lineNum">    4153 </span>            :              * speed up the query
<span class="lineNum">    4154 </span>            :              */
<span class="lineNum">    4155 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer,</span>
<span class="lineNum">    4156 </span>            :                               &quot; AND substring(pg_catalog.quote_ident(n.nspname) || '.',1,%d) =&quot;
<span class="lineNum">    4157 </span>            :                               &quot; substring('%s',1,pg_catalog.length(pg_catalog.quote_ident(n.nspname))+1)&quot;,
<span class="lineNum">    4158 </span>            :                               char_length, e_text);
<span class="lineNum">    4159 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer,</span>
<span class="lineNum">    4160 </span>            :                               &quot; AND (SELECT pg_catalog.count(*)&quot;
<span class="lineNum">    4161 </span>            :                               &quot; FROM pg_catalog.pg_namespace&quot;
<span class="lineNum">    4162 </span>            :                               &quot; WHERE substring(pg_catalog.quote_ident(nspname) || '.',1,%d) =&quot;
<span class="lineNum">    4163 </span>            :                               &quot; substring('%s',1,pg_catalog.length(pg_catalog.quote_ident(nspname))+1)) = 1&quot;,
<span class="lineNum">    4164 </span>            :                               char_length, e_text);
<span class="lineNum">    4165 </span>            : 
<span class="lineNum">    4166 </span>            :             /* If an addon query was provided, use it */
<span class="lineNum">    4167 </span><span class="lineNoCov">          0 :             if (simple_query)</span>
<span class="lineNum">    4168 </span><span class="lineNoCov">          0 :                 appendPQExpBuffer(&amp;query_buffer, &quot;\n%s&quot;, simple_query);</span>
<span class="lineNum">    4169 </span>            :         }
<span class="lineNum">    4170 </span>            :         else
<span class="lineNum">    4171 </span>            :         {
<span class="lineNum">    4172 </span><span class="lineNoCov">          0 :             Assert(simple_query);</span>
<span class="lineNum">    4173 </span>            :             /* simple_query is an sprintf-style format string */
<span class="lineNum">    4174 </span><span class="lineNoCov">          0 :             appendPQExpBuffer(&amp;query_buffer, simple_query,</span>
<span class="lineNum">    4175 </span>            :                               char_length, e_text,
<span class="lineNum">    4176 </span>            :                               e_info_charp, e_info_charp,
<span class="lineNum">    4177 </span>            :                               e_info_charp2, e_info_charp2);
<span class="lineNum">    4178 </span>            :         }
<span class="lineNum">    4179 </span>            : 
<span class="lineNum">    4180 </span>            :         /* Limit the number of records in the result */
<span class="lineNum">    4181 </span><span class="lineNoCov">          0 :         appendPQExpBuffer(&amp;query_buffer, &quot;\nLIMIT %d&quot;,</span>
<span class="lineNum">    4182 </span>            :                           completion_max_records);
<span class="lineNum">    4183 </span>            : 
<span class="lineNum">    4184 </span><span class="lineNoCov">          0 :         result = exec_query(query_buffer.data);</span>
<span class="lineNum">    4185 </span>            : 
<span class="lineNum">    4186 </span><span class="lineNoCov">          0 :         termPQExpBuffer(&amp;query_buffer);</span>
<span class="lineNum">    4187 </span><span class="lineNoCov">          0 :         free(e_text);</span>
<span class="lineNum">    4188 </span><span class="lineNoCov">          0 :         if (e_info_charp)</span>
<span class="lineNum">    4189 </span><span class="lineNoCov">          0 :             free(e_info_charp);</span>
<span class="lineNum">    4190 </span><span class="lineNoCov">          0 :         if (e_info_charp2)</span>
<span class="lineNum">    4191 </span><span class="lineNoCov">          0 :             free(e_info_charp2);</span>
<span class="lineNum">    4192 </span>            :     }
<span class="lineNum">    4193 </span>            : 
<span class="lineNum">    4194 </span>            :     /* Find something that matches */
<span class="lineNum">    4195 </span><span class="lineNoCov">          0 :     if (result &amp;&amp; PQresultStatus(result) == PGRES_TUPLES_OK)</span>
<span class="lineNum">    4196 </span>            :     {
<span class="lineNum">    4197 </span>            :         const char *item;
<span class="lineNum">    4198 </span>            : 
<span class="lineNum">    4199 </span><span class="lineNoCov">          0 :         while (list_index &lt; PQntuples(result) &amp;&amp;</span>
<span class="lineNum">    4200 </span><span class="lineNoCov">          0 :                (item = PQgetvalue(result, list_index++, 0)))</span>
<span class="lineNum">    4201 </span><span class="lineNoCov">          0 :             if (pg_strncasecmp(text, item, byte_length) == 0)</span>
<span class="lineNum">    4202 </span><span class="lineNoCov">          0 :                 return pg_strdup(item);</span>
<span class="lineNum">    4203 </span>            :     }
<span class="lineNum">    4204 </span>            : 
<span class="lineNum">    4205 </span>            :     /* If nothing matches, free the db structure and return null */
<span class="lineNum">    4206 </span><span class="lineNoCov">          0 :     PQclear(result);</span>
<span class="lineNum">    4207 </span><span class="lineNoCov">          0 :     result = NULL;</span>
<span class="lineNum">    4208 </span><span class="lineNoCov">          0 :     return NULL;</span>
<span class="lineNum">    4209 </span>            : }
<span class="lineNum">    4210 </span>            : 
<span class="lineNum">    4211 </span>            : 
<span class="lineNum">    4212 </span>            : /*
<span class="lineNum">    4213 </span>            :  * This function returns in order one of a fixed, NULL pointer terminated list
<span class="lineNum">    4214 </span>            :  * of strings (if matching). This can be used if there are only a fixed number
<span class="lineNum">    4215 </span>            :  * SQL words that can appear at certain spot.
<a name="4216"><span class="lineNum">    4216 </span>            :  */</a>
<span class="lineNum">    4217 </span>            : static char *
<span class="lineNum">    4218 </span><span class="lineNoCov">          0 : complete_from_list(const char *text, int state)</span>
<span class="lineNum">    4219 </span>            : {
<span class="lineNum">    4220 </span>            :     static int  string_length,
<span class="lineNum">    4221 </span>            :                 list_index,
<span class="lineNum">    4222 </span>            :                 matches;
<span class="lineNum">    4223 </span>            :     static bool casesensitive;
<span class="lineNum">    4224 </span>            :     const char *item;
<span class="lineNum">    4225 </span>            : 
<span class="lineNum">    4226 </span>            :     /* need to have a list */
<span class="lineNum">    4227 </span><span class="lineNoCov">          0 :     Assert(completion_charpp != NULL);</span>
<span class="lineNum">    4228 </span>            : 
<span class="lineNum">    4229 </span>            :     /* Initialization */
<span class="lineNum">    4230 </span><span class="lineNoCov">          0 :     if (state == 0)</span>
<span class="lineNum">    4231 </span>            :     {
<span class="lineNum">    4232 </span><span class="lineNoCov">          0 :         list_index = 0;</span>
<span class="lineNum">    4233 </span><span class="lineNoCov">          0 :         string_length = strlen(text);</span>
<span class="lineNum">    4234 </span><span class="lineNoCov">          0 :         casesensitive = completion_case_sensitive;</span>
<span class="lineNum">    4235 </span><span class="lineNoCov">          0 :         matches = 0;</span>
<span class="lineNum">    4236 </span>            :     }
<span class="lineNum">    4237 </span>            : 
<span class="lineNum">    4238 </span><span class="lineNoCov">          0 :     while ((item = completion_charpp[list_index++]))</span>
<span class="lineNum">    4239 </span>            :     {
<span class="lineNum">    4240 </span>            :         /* First pass is case sensitive */
<span class="lineNum">    4241 </span><span class="lineNoCov">          0 :         if (casesensitive &amp;&amp; strncmp(text, item, string_length) == 0)</span>
<span class="lineNum">    4242 </span>            :         {
<span class="lineNum">    4243 </span><span class="lineNoCov">          0 :             matches++;</span>
<span class="lineNum">    4244 </span><span class="lineNoCov">          0 :             return pg_strdup(item);</span>
<span class="lineNum">    4245 </span>            :         }
<span class="lineNum">    4246 </span>            : 
<span class="lineNum">    4247 </span>            :         /* Second pass is case insensitive, don't bother counting matches */
<span class="lineNum">    4248 </span><span class="lineNoCov">          0 :         if (!casesensitive &amp;&amp; pg_strncasecmp(text, item, string_length) == 0)</span>
<span class="lineNum">    4249 </span>            :         {
<span class="lineNum">    4250 </span><span class="lineNoCov">          0 :             if (completion_case_sensitive)</span>
<span class="lineNum">    4251 </span><span class="lineNoCov">          0 :                 return pg_strdup(item);</span>
<span class="lineNum">    4252 </span>            :             else
<span class="lineNum">    4253 </span>            : 
<span class="lineNum">    4254 </span>            :                 /*
<span class="lineNum">    4255 </span>            :                  * If case insensitive matching was requested initially,
<span class="lineNum">    4256 </span>            :                  * adjust the case according to setting.
<span class="lineNum">    4257 </span>            :                  */
<span class="lineNum">    4258 </span><span class="lineNoCov">          0 :                 return pg_strdup_keyword_case(item, text);</span>
<span class="lineNum">    4259 </span>            :         }
<span class="lineNum">    4260 </span>            :     }
<span class="lineNum">    4261 </span>            : 
<span class="lineNum">    4262 </span>            :     /*
<span class="lineNum">    4263 </span>            :      * No matches found. If we're not case insensitive already, lets switch to
<span class="lineNum">    4264 </span>            :      * being case insensitive and try again
<span class="lineNum">    4265 </span>            :      */
<span class="lineNum">    4266 </span><span class="lineNoCov">          0 :     if (casesensitive &amp;&amp; matches == 0)</span>
<span class="lineNum">    4267 </span>            :     {
<span class="lineNum">    4268 </span><span class="lineNoCov">          0 :         casesensitive = false;</span>
<span class="lineNum">    4269 </span><span class="lineNoCov">          0 :         list_index = 0;</span>
<span class="lineNum">    4270 </span><span class="lineNoCov">          0 :         state++;</span>
<span class="lineNum">    4271 </span><span class="lineNoCov">          0 :         return complete_from_list(text, state);</span>
<span class="lineNum">    4272 </span>            :     }
<span class="lineNum">    4273 </span>            : 
<span class="lineNum">    4274 </span>            :     /* If no more matches, return null. */
<span class="lineNum">    4275 </span><span class="lineNoCov">          0 :     return NULL;</span>
<span class="lineNum">    4276 </span>            : }
<span class="lineNum">    4277 </span>            : 
<span class="lineNum">    4278 </span>            : 
<span class="lineNum">    4279 </span>            : /*
<span class="lineNum">    4280 </span>            :  * This function returns one fixed string the first time even if it doesn't
<span class="lineNum">    4281 </span>            :  * match what's there, and nothing the second time.  The string
<span class="lineNum">    4282 </span>            :  * to be used must be in completion_charp.
<span class="lineNum">    4283 </span>            :  *
<span class="lineNum">    4284 </span>            :  * If the given string is &quot;&quot;, this has the effect of preventing readline
<span class="lineNum">    4285 </span>            :  * from doing any completion.  (Without this, readline tries to do filename
<span class="lineNum">    4286 </span>            :  * completion which is seldom the right thing.)
<span class="lineNum">    4287 </span>            :  *
<span class="lineNum">    4288 </span>            :  * If the given string is not empty, readline will replace whatever the
<span class="lineNum">    4289 </span>            :  * user typed with that string.  This behavior might be useful if it's
<span class="lineNum">    4290 </span>            :  * completely certain that we know what must appear at a certain spot,
<span class="lineNum">    4291 </span>            :  * so that it's okay to overwrite misspellings.  In practice, given the
<span class="lineNum">    4292 </span>            :  * relatively lame parsing technology used in this file, the level of
<span class="lineNum">    4293 </span>            :  * certainty is seldom that high, so that you probably don't want to
<span class="lineNum">    4294 </span>            :  * use this.  Use complete_from_list with a one-element list instead;
<span class="lineNum">    4295 </span>            :  * that won't try to auto-correct &quot;misspellings&quot;.
<a name="4296"><span class="lineNum">    4296 </span>            :  */</a>
<span class="lineNum">    4297 </span>            : static char *
<span class="lineNum">    4298 </span><span class="lineNoCov">          0 : complete_from_const(const char *text, int state)</span>
<span class="lineNum">    4299 </span>            : {
<span class="lineNum">    4300 </span><span class="lineNoCov">          0 :     Assert(completion_charp != NULL);</span>
<span class="lineNum">    4301 </span><span class="lineNoCov">          0 :     if (state == 0)</span>
<span class="lineNum">    4302 </span>            :     {
<span class="lineNum">    4303 </span><span class="lineNoCov">          0 :         if (completion_case_sensitive)</span>
<span class="lineNum">    4304 </span><span class="lineNoCov">          0 :             return pg_strdup(completion_charp);</span>
<span class="lineNum">    4305 </span>            :         else
<span class="lineNum">    4306 </span>            : 
<span class="lineNum">    4307 </span>            :             /*
<span class="lineNum">    4308 </span>            :              * If case insensitive matching was requested initially, adjust
<span class="lineNum">    4309 </span>            :              * the case according to setting.
<span class="lineNum">    4310 </span>            :              */
<span class="lineNum">    4311 </span><span class="lineNoCov">          0 :             return pg_strdup_keyword_case(completion_charp, text);</span>
<span class="lineNum">    4312 </span>            :     }
<span class="lineNum">    4313 </span>            :     else
<span class="lineNum">    4314 </span><span class="lineNoCov">          0 :         return NULL;</span>
<span class="lineNum">    4315 </span>            : }
<span class="lineNum">    4316 </span>            : 
<span class="lineNum">    4317 </span>            : 
<span class="lineNum">    4318 </span>            : /*
<span class="lineNum">    4319 </span>            :  * This function appends the variable name with prefix and suffix to
<span class="lineNum">    4320 </span>            :  * the variable names array.
<a name="4321"><span class="lineNum">    4321 </span>            :  */</a>
<span class="lineNum">    4322 </span>            : static void
<span class="lineNum">    4323 </span><span class="lineNoCov">          0 : append_variable_names(char ***varnames, int *nvars,</span>
<span class="lineNum">    4324 </span>            :                       int *maxvars, const char *varname,
<span class="lineNum">    4325 </span>            :                       const char *prefix, const char *suffix)
<span class="lineNum">    4326 </span>            : {
<span class="lineNum">    4327 </span><span class="lineNoCov">          0 :     if (*nvars &gt;= *maxvars)</span>
<span class="lineNum">    4328 </span>            :     {
<span class="lineNum">    4329 </span><span class="lineNoCov">          0 :         *maxvars *= 2;</span>
<span class="lineNum">    4330 </span><span class="lineNoCov">          0 :         *varnames = (char **) pg_realloc(*varnames,</span>
<span class="lineNum">    4331 </span><span class="lineNoCov">          0 :                                          ((*maxvars) + 1) * sizeof(char *));</span>
<span class="lineNum">    4332 </span>            :     }
<span class="lineNum">    4333 </span>            : 
<span class="lineNum">    4334 </span><span class="lineNoCov">          0 :     (*varnames)[(*nvars)++] = psprintf(&quot;%s%s%s&quot;, prefix, varname, suffix);</span>
<span class="lineNum">    4335 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">    4336 </span>            : 
<span class="lineNum">    4337 </span>            : 
<span class="lineNum">    4338 </span>            : /*
<span class="lineNum">    4339 </span>            :  * This function supports completion with the name of a psql variable.
<span class="lineNum">    4340 </span>            :  * The variable names can be prefixed and suffixed with additional text
<span class="lineNum">    4341 </span>            :  * to support quoting usages. If need_value is true, only variables
<span class="lineNum">    4342 </span>            :  * that are currently set are included; otherwise, special variables
<span class="lineNum">    4343 </span>            :  * (those that have hooks) are included even if currently unset.
<a name="4344"><span class="lineNum">    4344 </span>            :  */</a>
<span class="lineNum">    4345 </span>            : static char **
<span class="lineNum">    4346 </span><span class="lineNoCov">          0 : complete_from_variables(const char *text, const char *prefix, const char *suffix,</span>
<span class="lineNum">    4347 </span>            :                         bool need_value)
<span class="lineNum">    4348 </span>            : {
<span class="lineNum">    4349 </span>            :     char      **matches;
<span class="lineNum">    4350 </span>            :     char      **varnames;
<span class="lineNum">    4351 </span><span class="lineNoCov">          0 :     int         nvars = 0;</span>
<span class="lineNum">    4352 </span><span class="lineNoCov">          0 :     int         maxvars = 100;</span>
<span class="lineNum">    4353 </span>            :     int         i;
<span class="lineNum">    4354 </span>            :     struct _variable *ptr;
<span class="lineNum">    4355 </span>            : 
<span class="lineNum">    4356 </span><span class="lineNoCov">          0 :     varnames = (char **) pg_malloc((maxvars + 1) * sizeof(char *));</span>
<span class="lineNum">    4357 </span>            : 
<span class="lineNum">    4358 </span><span class="lineNoCov">          0 :     for (ptr = pset.vars-&gt;next; ptr; ptr = ptr-&gt;next)</span>
<span class="lineNum">    4359 </span>            :     {
<span class="lineNum">    4360 </span><span class="lineNoCov">          0 :         if (need_value &amp;&amp; !(ptr-&gt;value))</span>
<span class="lineNum">    4361 </span><span class="lineNoCov">          0 :             continue;</span>
<span class="lineNum">    4362 </span><span class="lineNoCov">          0 :         append_variable_names(&amp;varnames, &amp;nvars, &amp;maxvars, ptr-&gt;name,</span>
<span class="lineNum">    4363 </span>            :                               prefix, suffix);
<span class="lineNum">    4364 </span>            :     }
<span class="lineNum">    4365 </span>            : 
<span class="lineNum">    4366 </span><span class="lineNoCov">          0 :     varnames[nvars] = NULL;</span>
<span class="lineNum">    4367 </span><span class="lineNoCov">          0 :     COMPLETE_WITH_LIST_CS((const char *const *) varnames);</span>
<span class="lineNum">    4368 </span>            : 
<span class="lineNum">    4369 </span><span class="lineNoCov">          0 :     for (i = 0; i &lt; nvars; i++)</span>
<span class="lineNum">    4370 </span><span class="lineNoCov">          0 :         free(varnames[i]);</span>
<span class="lineNum">    4371 </span><span class="lineNoCov">          0 :     free(varnames);</span>
<span class="lineNum">    4372 </span>            : 
<span class="lineNum">    4373 </span><span class="lineNoCov">          0 :     return matches;</span>
<span class="lineNum">    4374 </span>            : }
<span class="lineNum">    4375 </span>            : 
<span class="lineNum">    4376 </span>            : 
<span class="lineNum">    4377 </span>            : /*
<span class="lineNum">    4378 </span>            :  * This function wraps rl_filename_completion_function() to strip quotes from
<span class="lineNum">    4379 </span>            :  * the input before searching for matches and to quote any matches for which
<span class="lineNum">    4380 </span>            :  * the consuming command will require it.
<a name="4381"><span class="lineNum">    4381 </span>            :  */</a>
<span class="lineNum">    4382 </span>            : static char *
<span class="lineNum">    4383 </span><span class="lineNoCov">          0 : complete_from_files(const char *text, int state)</span>
<span class="lineNum">    4384 </span>            : {
<span class="lineNum">    4385 </span>            :     static const char *unquoted_text;
<span class="lineNum">    4386 </span>            :     char       *unquoted_match;
<span class="lineNum">    4387 </span><span class="lineNoCov">          0 :     char       *ret = NULL;</span>
<span class="lineNum">    4388 </span>            : 
<span class="lineNum">    4389 </span><span class="lineNoCov">          0 :     if (state == 0)</span>
<span class="lineNum">    4390 </span>            :     {
<span class="lineNum">    4391 </span>            :         /* Initialization: stash the unquoted input. */
<span class="lineNum">    4392 </span><span class="lineNoCov">          0 :         unquoted_text = strtokx(text, &quot;&quot;, NULL, &quot;'&quot;, *completion_charp,</span>
<span class="lineNum">    4393 </span>            :                                 false, true, pset.encoding);
<span class="lineNum">    4394 </span>            :         /* expect a NULL return for the empty string only */
<span class="lineNum">    4395 </span><span class="lineNoCov">          0 :         if (!unquoted_text)</span>
<span class="lineNum">    4396 </span>            :         {
<span class="lineNum">    4397 </span><span class="lineNoCov">          0 :             Assert(*text == '\0');</span>
<span class="lineNum">    4398 </span><span class="lineNoCov">          0 :             unquoted_text = text;</span>
<span class="lineNum">    4399 </span>            :         }
<span class="lineNum">    4400 </span>            :     }
<span class="lineNum">    4401 </span>            : 
<span class="lineNum">    4402 </span><span class="lineNoCov">          0 :     unquoted_match = filename_completion_function(unquoted_text, state);</span>
<span class="lineNum">    4403 </span><span class="lineNoCov">          0 :     if (unquoted_match)</span>
<span class="lineNum">    4404 </span>            :     {
<span class="lineNum">    4405 </span>            :         /*
<span class="lineNum">    4406 </span>            :          * Caller sets completion_charp to a zero- or one-character string
<span class="lineNum">    4407 </span>            :          * containing the escape character.  This is necessary since \copy has
<span class="lineNum">    4408 </span>            :          * no escape character, but every other backslash command recognizes
<span class="lineNum">    4409 </span>            :          * &quot;\&quot; as an escape character.  Since we have only two callers, don't
<span class="lineNum">    4410 </span>            :          * bother providing a macro to simplify this.
<span class="lineNum">    4411 </span>            :          */
<span class="lineNum">    4412 </span><span class="lineNoCov">          0 :         ret = quote_if_needed(unquoted_match, &quot; \t\r\n\&quot;`&quot;,</span>
<span class="lineNum">    4413 </span><span class="lineNoCov">          0 :                               '\'', *completion_charp, pset.encoding);</span>
<span class="lineNum">    4414 </span><span class="lineNoCov">          0 :         if (ret)</span>
<span class="lineNum">    4415 </span><span class="lineNoCov">          0 :             free(unquoted_match);</span>
<span class="lineNum">    4416 </span>            :         else
<span class="lineNum">    4417 </span><span class="lineNoCov">          0 :             ret = unquoted_match;</span>
<span class="lineNum">    4418 </span>            :     }
<span class="lineNum">    4419 </span>            : 
<span class="lineNum">    4420 </span><span class="lineNoCov">          0 :     return ret;</span>
<span class="lineNum">    4421 </span>            : }
<span class="lineNum">    4422 </span>            : 
<span class="lineNum">    4423 </span>            : 
<span class="lineNum">    4424 </span>            : /* HELPER FUNCTIONS */
<span class="lineNum">    4425 </span>            : 
<span class="lineNum">    4426 </span>            : 
<span class="lineNum">    4427 </span>            : /*
<span class="lineNum">    4428 </span>            :  * Make a pg_strdup copy of s and convert the case according to
<span class="lineNum">    4429 </span>            :  * COMP_KEYWORD_CASE setting, using ref as the text that was already entered.
<a name="4430"><span class="lineNum">    4430 </span>            :  */</a>
<span class="lineNum">    4431 </span>            : static char *
<span class="lineNum">    4432 </span><span class="lineNoCov">          0 : pg_strdup_keyword_case(const char *s, const char *ref)</span>
<span class="lineNum">    4433 </span>            : {
<span class="lineNum">    4434 </span>            :     char       *ret,
<span class="lineNum">    4435 </span>            :                *p;
<span class="lineNum">    4436 </span><span class="lineNoCov">          0 :     unsigned char first = ref[0];</span>
<span class="lineNum">    4437 </span>            : 
<span class="lineNum">    4438 </span><span class="lineNoCov">          0 :     ret = pg_strdup(s);</span>
<span class="lineNum">    4439 </span>            : 
<span class="lineNum">    4440 </span><span class="lineNoCov">          0 :     if (pset.comp_case == PSQL_COMP_CASE_LOWER ||</span>
<span class="lineNum">    4441 </span><span class="lineNoCov">          0 :         ((pset.comp_case == PSQL_COMP_CASE_PRESERVE_LOWER ||</span>
<span class="lineNum">    4442 </span><span class="lineNoCov">          0 :           pset.comp_case == PSQL_COMP_CASE_PRESERVE_UPPER) &amp;&amp; islower(first)) ||</span>
<span class="lineNum">    4443 </span><span class="lineNoCov">          0 :         (pset.comp_case == PSQL_COMP_CASE_PRESERVE_LOWER &amp;&amp; !isalpha(first)))</span>
<span class="lineNum">    4444 </span>            :     {
<span class="lineNum">    4445 </span><span class="lineNoCov">          0 :         for (p = ret; *p; p++)</span>
<span class="lineNum">    4446 </span><span class="lineNoCov">          0 :             *p = pg_tolower((unsigned char) *p);</span>
<span class="lineNum">    4447 </span>            :     }
<span class="lineNum">    4448 </span>            :     else
<span class="lineNum">    4449 </span>            :     {
<span class="lineNum">    4450 </span><span class="lineNoCov">          0 :         for (p = ret; *p; p++)</span>
<span class="lineNum">    4451 </span><span class="lineNoCov">          0 :             *p = pg_toupper((unsigned char) *p);</span>
<span class="lineNum">    4452 </span>            :     }
<span class="lineNum">    4453 </span>            : 
<span class="lineNum">    4454 </span><span class="lineNoCov">          0 :     return ret;</span>
<span class="lineNum">    4455 </span>            : }
<span class="lineNum">    4456 </span>            : 
<span class="lineNum">    4457 </span>            : 
<span class="lineNum">    4458 </span>            : /*
<span class="lineNum">    4459 </span>            :  * escape_string - Escape argument for use as string literal.
<span class="lineNum">    4460 </span>            :  *
<span class="lineNum">    4461 </span>            :  * The returned value has to be freed.
<a name="4462"><span class="lineNum">    4462 </span>            :  */</a>
<span class="lineNum">    4463 </span>            : static char *
<span class="lineNum">    4464 </span><span class="lineNoCov">          0 : escape_string(const char *text)</span>
<span class="lineNum">    4465 </span>            : {
<span class="lineNum">    4466 </span>            :     size_t      text_length;
<span class="lineNum">    4467 </span>            :     char       *result;
<span class="lineNum">    4468 </span>            : 
<span class="lineNum">    4469 </span><span class="lineNoCov">          0 :     text_length = strlen(text);</span>
<span class="lineNum">    4470 </span>            : 
<span class="lineNum">    4471 </span><span class="lineNoCov">          0 :     result = pg_malloc(text_length * 2 + 1);</span>
<span class="lineNum">    4472 </span><span class="lineNoCov">          0 :     PQescapeStringConn(pset.db, result, text, text_length, NULL);</span>
<span class="lineNum">    4473 </span>            : 
<span class="lineNum">    4474 </span><span class="lineNoCov">          0 :     return result;</span>
<span class="lineNum">    4475 </span>            : }
<span class="lineNum">    4476 </span>            : 
<span class="lineNum">    4477 </span>            : 
<span class="lineNum">    4478 </span>            : /*
<span class="lineNum">    4479 </span>            :  * Execute a query and report any errors. This should be the preferred way of
<span class="lineNum">    4480 </span>            :  * talking to the database in this file.
<a name="4481"><span class="lineNum">    4481 </span>            :  */</a>
<span class="lineNum">    4482 </span>            : static PGresult *
<span class="lineNum">    4483 </span><span class="lineNoCov">          0 : exec_query(const char *query)</span>
<span class="lineNum">    4484 </span>            : {
<span class="lineNum">    4485 </span>            :     PGresult   *result;
<span class="lineNum">    4486 </span>            : 
<span class="lineNum">    4487 </span><span class="lineNoCov">          0 :     if (query == NULL || !pset.db || PQstatus(pset.db) != CONNECTION_OK)</span>
<span class="lineNum">    4488 </span><span class="lineNoCov">          0 :         return NULL;</span>
<span class="lineNum">    4489 </span>            : 
<span class="lineNum">    4490 </span><span class="lineNoCov">          0 :     result = PQexec(pset.db, query);</span>
<span class="lineNum">    4491 </span>            : 
<span class="lineNum">    4492 </span><span class="lineNoCov">          0 :     if (PQresultStatus(result) != PGRES_TUPLES_OK)</span>
<span class="lineNum">    4493 </span>            :     {
<span class="lineNum">    4494 </span>            : #ifdef NOT_USED
<span class="lineNum">    4495 </span>            :         pg_log_error(&quot;tab completion query failed: %s\nQuery was:\n%s&quot;,
<span class="lineNum">    4496 </span>            :                      PQerrorMessage(pset.db), query);
<span class="lineNum">    4497 </span>            : #endif
<span class="lineNum">    4498 </span><span class="lineNoCov">          0 :         PQclear(result);</span>
<span class="lineNum">    4499 </span><span class="lineNoCov">          0 :         result = NULL;</span>
<span class="lineNum">    4500 </span>            :     }
<span class="lineNum">    4501 </span>            : 
<span class="lineNum">    4502 </span><span class="lineNoCov">          0 :     return result;</span>
<span class="lineNum">    4503 </span>            : }
<span class="lineNum">    4504 </span>            : 
<span class="lineNum">    4505 </span>            : 
<span class="lineNum">    4506 </span>            : /*
<span class="lineNum">    4507 </span>            :  * Parse all the word(s) before point.
<span class="lineNum">    4508 </span>            :  *
<span class="lineNum">    4509 </span>            :  * Returns a malloc'd array of character pointers that point into the malloc'd
<span class="lineNum">    4510 </span>            :  * data array returned to *buffer; caller must free() both of these when done.
<span class="lineNum">    4511 </span>            :  * *nwords receives the number of words found, ie, the valid length of the
<span class="lineNum">    4512 </span>            :  * return array.
<span class="lineNum">    4513 </span>            :  *
<span class="lineNum">    4514 </span>            :  * Words are returned right to left, that is, previous_words[0] gets the last
<span class="lineNum">    4515 </span>            :  * word before point, previous_words[1] the next-to-last, etc.
<a name="4516"><span class="lineNum">    4516 </span>            :  */</a>
<span class="lineNum">    4517 </span>            : static char **
<span class="lineNum">    4518 </span><span class="lineNoCov">          0 : get_previous_words(int point, char **buffer, int *nwords)</span>
<span class="lineNum">    4519 </span>            : {
<span class="lineNum">    4520 </span>            :     char      **previous_words;
<span class="lineNum">    4521 </span>            :     char       *buf;
<span class="lineNum">    4522 </span>            :     char       *outptr;
<span class="lineNum">    4523 </span><span class="lineNoCov">          0 :     int         words_found = 0;</span>
<span class="lineNum">    4524 </span>            :     int         i;
<span class="lineNum">    4525 </span>            : 
<span class="lineNum">    4526 </span>            :     /*
<span class="lineNum">    4527 </span>            :      * If we have anything in tab_completion_query_buf, paste it together with
<span class="lineNum">    4528 </span>            :      * rl_line_buffer to construct the full query.  Otherwise we can just use
<span class="lineNum">    4529 </span>            :      * rl_line_buffer as the input string.
<span class="lineNum">    4530 </span>            :      */
<span class="lineNum">    4531 </span><span class="lineNoCov">          0 :     if (tab_completion_query_buf &amp;&amp; tab_completion_query_buf-&gt;len &gt; 0)</span>
<span class="lineNum">    4532 </span>            :     {
<span class="lineNum">    4533 </span><span class="lineNoCov">          0 :         i = tab_completion_query_buf-&gt;len;</span>
<span class="lineNum">    4534 </span><span class="lineNoCov">          0 :         buf = pg_malloc(point + i + 2);</span>
<span class="lineNum">    4535 </span><span class="lineNoCov">          0 :         memcpy(buf, tab_completion_query_buf-&gt;data, i);</span>
<span class="lineNum">    4536 </span><span class="lineNoCov">          0 :         buf[i++] = '\n';</span>
<span class="lineNum">    4537 </span><span class="lineNoCov">          0 :         memcpy(buf + i, rl_line_buffer, point);</span>
<span class="lineNum">    4538 </span><span class="lineNoCov">          0 :         i += point;</span>
<span class="lineNum">    4539 </span><span class="lineNoCov">          0 :         buf[i] = '\0';</span>
<span class="lineNum">    4540 </span>            :         /* Readjust point to reference appropriate offset in buf */
<span class="lineNum">    4541 </span><span class="lineNoCov">          0 :         point = i;</span>
<span class="lineNum">    4542 </span>            :     }
<span class="lineNum">    4543 </span>            :     else
<span class="lineNum">    4544 </span><span class="lineNoCov">          0 :         buf = rl_line_buffer;</span>
<span class="lineNum">    4545 </span>            : 
<span class="lineNum">    4546 </span>            :     /*
<span class="lineNum">    4547 </span>            :      * Allocate an array of string pointers and a buffer to hold the strings
<span class="lineNum">    4548 </span>            :      * themselves.  The worst case is that the line contains only
<span class="lineNum">    4549 </span>            :      * non-whitespace WORD_BREAKS characters, making each one a separate word.
<span class="lineNum">    4550 </span>            :      * This is usually much more space than we need, but it's cheaper than
<span class="lineNum">    4551 </span>            :      * doing a separate malloc() for each word.
<span class="lineNum">    4552 </span>            :      */
<span class="lineNum">    4553 </span><span class="lineNoCov">          0 :     previous_words = (char **) pg_malloc(point * sizeof(char *));</span>
<span class="lineNum">    4554 </span><span class="lineNoCov">          0 :     *buffer = outptr = (char *) pg_malloc(point * 2);</span>
<span class="lineNum">    4555 </span>            : 
<span class="lineNum">    4556 </span>            :     /*
<span class="lineNum">    4557 </span>            :      * First we look for a non-word char before the current point.  (This is
<span class="lineNum">    4558 </span>            :      * probably useless, if readline is on the same page as we are about what
<span class="lineNum">    4559 </span>            :      * is a word, but if so it's cheap.)
<span class="lineNum">    4560 </span>            :      */
<span class="lineNum">    4561 </span><span class="lineNoCov">          0 :     for (i = point - 1; i &gt;= 0; i--)</span>
<span class="lineNum">    4562 </span>            :     {
<span class="lineNum">    4563 </span><span class="lineNoCov">          0 :         if (strchr(WORD_BREAKS, buf[i]))</span>
<span class="lineNum">    4564 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    4565 </span>            :     }
<span class="lineNum">    4566 </span><span class="lineNoCov">          0 :     point = i;</span>
<span class="lineNum">    4567 </span>            : 
<span class="lineNum">    4568 </span>            :     /*
<span class="lineNum">    4569 </span>            :      * Now parse words, working backwards, until we hit start of line.  The
<span class="lineNum">    4570 </span>            :      * backwards scan has some interesting but intentional properties
<span class="lineNum">    4571 </span>            :      * concerning parenthesis handling.
<span class="lineNum">    4572 </span>            :      */
<span class="lineNum">    4573 </span><span class="lineNoCov">          0 :     while (point &gt;= 0)</span>
<span class="lineNum">    4574 </span>            :     {
<span class="lineNum">    4575 </span>            :         int         start,
<span class="lineNum">    4576 </span>            :                     end;
<span class="lineNum">    4577 </span><span class="lineNoCov">          0 :         bool        inquotes = false;</span>
<span class="lineNum">    4578 </span><span class="lineNoCov">          0 :         int         parentheses = 0;</span>
<span class="lineNum">    4579 </span>            : 
<span class="lineNum">    4580 </span>            :         /* now find the first non-space which then constitutes the end */
<span class="lineNum">    4581 </span><span class="lineNoCov">          0 :         end = -1;</span>
<span class="lineNum">    4582 </span><span class="lineNoCov">          0 :         for (i = point; i &gt;= 0; i--)</span>
<span class="lineNum">    4583 </span>            :         {
<span class="lineNum">    4584 </span><span class="lineNoCov">          0 :             if (!isspace((unsigned char) buf[i]))</span>
<span class="lineNum">    4585 </span>            :             {
<span class="lineNum">    4586 </span><span class="lineNoCov">          0 :                 end = i;</span>
<span class="lineNum">    4587 </span><span class="lineNoCov">          0 :                 break;</span>
<span class="lineNum">    4588 </span>            :             }
<span class="lineNum">    4589 </span>            :         }
<span class="lineNum">    4590 </span>            :         /* if no end found, we're done */
<span class="lineNum">    4591 </span><span class="lineNoCov">          0 :         if (end &lt; 0)</span>
<span class="lineNum">    4592 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">    4593 </span>            : 
<span class="lineNum">    4594 </span>            :         /*
<span class="lineNum">    4595 </span>            :          * Otherwise we now look for the start.  The start is either the last
<span class="lineNum">    4596 </span>            :          * character before any word-break character going backwards from the
<span class="lineNum">    4597 </span>            :          * end, or it's simply character 0.  We also handle open quotes and
<span class="lineNum">    4598 </span>            :          * parentheses.
<span class="lineNum">    4599 </span>            :          */
<span class="lineNum">    4600 </span><span class="lineNoCov">          0 :         for (start = end; start &gt; 0; start--)</span>
<span class="lineNum">    4601 </span>            :         {
<span class="lineNum">    4602 </span><span class="lineNoCov">          0 :             if (buf[start] == '&quot;')</span>
<span class="lineNum">    4603 </span><span class="lineNoCov">          0 :                 inquotes = !inquotes;</span>
<span class="lineNum">    4604 </span><span class="lineNoCov">          0 :             if (!inquotes)</span>
<span class="lineNum">    4605 </span>            :             {
<span class="lineNum">    4606 </span><span class="lineNoCov">          0 :                 if (buf[start] == ')')</span>
<span class="lineNum">    4607 </span><span class="lineNoCov">          0 :                     parentheses++;</span>
<span class="lineNum">    4608 </span><span class="lineNoCov">          0 :                 else if (buf[start] == '(')</span>
<span class="lineNum">    4609 </span>            :                 {
<span class="lineNum">    4610 </span><span class="lineNoCov">          0 :                     if (--parentheses &lt;= 0)</span>
<span class="lineNum">    4611 </span><span class="lineNoCov">          0 :                         break;</span>
<span class="lineNum">    4612 </span>            :                 }
<span class="lineNum">    4613 </span><span class="lineNoCov">          0 :                 else if (parentheses == 0 &amp;&amp;</span>
<span class="lineNum">    4614 </span><span class="lineNoCov">          0 :                          strchr(WORD_BREAKS, buf[start - 1]))</span>
<span class="lineNum">    4615 </span><span class="lineNoCov">          0 :                     break;</span>
<span class="lineNum">    4616 </span>            :             }
<span class="lineNum">    4617 </span>            :         }
<span class="lineNum">    4618 </span>            : 
<span class="lineNum">    4619 </span>            :         /* Return the word located at start to end inclusive */
<span class="lineNum">    4620 </span><span class="lineNoCov">          0 :         previous_words[words_found++] = outptr;</span>
<span class="lineNum">    4621 </span><span class="lineNoCov">          0 :         i = end - start + 1;</span>
<span class="lineNum">    4622 </span><span class="lineNoCov">          0 :         memcpy(outptr, &amp;buf[start], i);</span>
<span class="lineNum">    4623 </span><span class="lineNoCov">          0 :         outptr += i;</span>
<span class="lineNum">    4624 </span><span class="lineNoCov">          0 :         *outptr++ = '\0';</span>
<span class="lineNum">    4625 </span>            : 
<span class="lineNum">    4626 </span>            :         /* Continue searching */
<span class="lineNum">    4627 </span><span class="lineNoCov">          0 :         point = start - 1;</span>
<span class="lineNum">    4628 </span>            :     }
<span class="lineNum">    4629 </span>            : 
<span class="lineNum">    4630 </span>            :     /* Release parsing input workspace, if we made one above */
<span class="lineNum">    4631 </span><span class="lineNoCov">          0 :     if (buf != rl_line_buffer)</span>
<span class="lineNum">    4632 </span><span class="lineNoCov">          0 :         free(buf);</span>
<span class="lineNum">    4633 </span>            : 
<span class="lineNum">    4634 </span><span class="lineNoCov">          0 :     *nwords = words_found;</span>
<span class="lineNum">    4635 </span><span class="lineNoCov">          0 :     return previous_words;</span>
<span class="lineNum">    4636 </span>            : }
<span class="lineNum">    4637 </span>            : 
<span class="lineNum">    4638 </span>            : /*
<span class="lineNum">    4639 </span>            :  * Look up the type for the GUC variable with the passed name.
<span class="lineNum">    4640 </span>            :  *
<span class="lineNum">    4641 </span>            :  * Returns NULL if the variable is unknown. Otherwise the returned string,
<span class="lineNum">    4642 </span>            :  * containing the type, has to be freed.
<a name="4643"><span class="lineNum">    4643 </span>            :  */</a>
<span class="lineNum">    4644 </span>            : static char *
<span class="lineNum">    4645 </span><span class="lineNoCov">          0 : get_guctype(const char *varname)</span>
<span class="lineNum">    4646 </span>            : {
<span class="lineNum">    4647 </span>            :     PQExpBufferData query_buffer;
<span class="lineNum">    4648 </span>            :     char       *e_varname;
<span class="lineNum">    4649 </span>            :     PGresult   *result;
<span class="lineNum">    4650 </span><span class="lineNoCov">          0 :     char       *guctype = NULL;</span>
<span class="lineNum">    4651 </span>            : 
<span class="lineNum">    4652 </span><span class="lineNoCov">          0 :     e_varname = escape_string(varname);</span>
<span class="lineNum">    4653 </span>            : 
<span class="lineNum">    4654 </span><span class="lineNoCov">          0 :     initPQExpBuffer(&amp;query_buffer);</span>
<span class="lineNum">    4655 </span><span class="lineNoCov">          0 :     appendPQExpBuffer(&amp;query_buffer,</span>
<span class="lineNum">    4656 </span>            :                       &quot;SELECT vartype FROM pg_catalog.pg_settings &quot;
<span class="lineNum">    4657 </span>            :                       &quot;WHERE pg_catalog.lower(name) = pg_catalog.lower('%s')&quot;,
<span class="lineNum">    4658 </span>            :                       e_varname);
<span class="lineNum">    4659 </span>            : 
<span class="lineNum">    4660 </span><span class="lineNoCov">          0 :     result = exec_query(query_buffer.data);</span>
<span class="lineNum">    4661 </span><span class="lineNoCov">          0 :     termPQExpBuffer(&amp;query_buffer);</span>
<span class="lineNum">    4662 </span><span class="lineNoCov">          0 :     free(e_varname);</span>
<span class="lineNum">    4663 </span>            : 
<span class="lineNum">    4664 </span><span class="lineNoCov">          0 :     if (PQresultStatus(result) == PGRES_TUPLES_OK &amp;&amp; PQntuples(result) &gt; 0)</span>
<span class="lineNum">    4665 </span><span class="lineNoCov">          0 :         guctype = pg_strdup(PQgetvalue(result, 0, 0));</span>
<span class="lineNum">    4666 </span>            : 
<span class="lineNum">    4667 </span><span class="lineNoCov">          0 :     PQclear(result);</span>
<span class="lineNum">    4668 </span>            : 
<span class="lineNum">    4669 </span><span class="lineNoCov">          0 :     return guctype;</span>
<span class="lineNum">    4670 </span>            : }
<span class="lineNum">    4671 </span>            : 
<span class="lineNum">    4672 </span>            : #ifdef NOT_USED
<span class="lineNum">    4673 </span>            : 
<span class="lineNum">    4674 </span>            : /*
<span class="lineNum">    4675 </span>            :  * Surround a string with single quotes. This works for both SQL and
<span class="lineNum">    4676 </span>            :  * psql internal. Currently disabled because it is reported not to
<span class="lineNum">    4677 </span>            :  * cooperate with certain versions of readline.
<span class="lineNum">    4678 </span>            :  */
<span class="lineNum">    4679 </span>            : static char *
<span class="lineNum">    4680 </span>            : quote_file_name(char *text, int match_type, char *quote_pointer)
<span class="lineNum">    4681 </span>            : {
<span class="lineNum">    4682 </span>            :     char       *s;
<span class="lineNum">    4683 </span>            :     size_t      length;
<span class="lineNum">    4684 </span>            : 
<span class="lineNum">    4685 </span>            :     (void) quote_pointer;       /* not used */
<span class="lineNum">    4686 </span>            : 
<span class="lineNum">    4687 </span>            :     length = strlen(text) +(match_type == SINGLE_MATCH ? 3 : 2);
<span class="lineNum">    4688 </span>            :     s = pg_malloc(length);
<span class="lineNum">    4689 </span>            :     s[0] = '\'';
<span class="lineNum">    4690 </span>            :     strcpy(s + 1, text);
<span class="lineNum">    4691 </span>            :     if (match_type == SINGLE_MATCH)
<span class="lineNum">    4692 </span>            :         s[length - 2] = '\'';
<span class="lineNum">    4693 </span>            :     s[length - 1] = '\0';
<span class="lineNum">    4694 </span>            :     return s;
<span class="lineNum">    4695 </span>            : }
<span class="lineNum">    4696 </span>            : 
<span class="lineNum">    4697 </span>            : static char *
<span class="lineNum">    4698 </span>            : dequote_file_name(char *text, char quote_char)
<span class="lineNum">    4699 </span>            : {
<span class="lineNum">    4700 </span>            :     char       *s;
<span class="lineNum">    4701 </span>            :     size_t      length;
<span class="lineNum">    4702 </span>            : 
<span class="lineNum">    4703 </span>            :     if (!quote_char)
<span class="lineNum">    4704 </span>            :         return pg_strdup(text);
<span class="lineNum">    4705 </span>            : 
<span class="lineNum">    4706 </span>            :     length = strlen(text);
<span class="lineNum">    4707 </span>            :     s = pg_malloc(length - 2 + 1);
<span class="lineNum">    4708 </span>            :     strlcpy(s, text +1, length - 2 + 1);
<span class="lineNum">    4709 </span>            : 
<span class="lineNum">    4710 </span>            :     return s;
<span class="lineNum">    4711 </span>            : }
<span class="lineNum">    4712 </span>            : #endif                          /* NOT_USED */
<span class="lineNum">    4713 </span>            : 
<span class="lineNum">    4714 </span>            : #endif                          /* USE_READLINE */
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.13</a></td></tr>
  </table>
  <br>

</body>
</html>
